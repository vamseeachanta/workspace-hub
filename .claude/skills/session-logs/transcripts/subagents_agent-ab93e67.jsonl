{"ts":"2026-02-03T20:13:36.689Z","role":"ai","text":"\n\nI'll read all the specified files to conduct a thorough review.","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:13:38.426Z","role":"ai","text":"[tool:Read]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:13:38.683Z","role":"ai","text":"[tool:Read]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:13:38.907Z","role":"ai","text":"[tool:Read]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:13:39.079Z","role":"ai","text":"[tool:Read]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:13:39.280Z","role":"ai","text":"[tool:Read]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:13:46.102Z","role":"ai","text":"[tool:Read]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:13:46.292Z","role":"ai","text":"[tool:Read]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:13:46.491Z","role":"ai","text":"[tool:Read]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:13:46.689Z","role":"ai","text":"[tool:Read]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:13:42.739Z","role":"human","text":"[result]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:13:46.082Z","role":"human","text":"[result]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:13:50.266Z","role":"human","text":"[result]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:13:53.763Z","role":"human","text":"[result]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:14:04.326Z","role":"human","text":"[result]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:14:00.617Z","role":"human","text":"[result]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:14:07.896Z","role":"human","text":"[result]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:13:57.236Z","role":"human","text":"[result]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:14:11.720Z","role":"human","text":"[result]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:14:21.216Z","role":"ai","text":"Now let me check for additional context -- the existing builder registry, buoys builder, and enum files to understand integration points better.","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:14:21.217Z","role":"ai","text":"[tool:Glob]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:14:21.242Z","role":"ai","text":"[tool:Glob]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:15:01.446Z","role":"human","text":"[result]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:15:01.421Z","role":"human","text":"[result]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:15:07.476Z","role":"ai","text":"[tool:Read]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:15:07.828Z","role":"ai","text":"[tool:Read]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:15:12.337Z","role":"ai","text":"[tool:Read]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:15:12.552Z","role":"ai","text":"[tool:Read]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:15:12.735Z","role":"ai","text":"[tool:Read]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:15:12.914Z","role":"ai","text":"[tool:Read]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:15:13.116Z","role":"ai","text":"[tool:Read]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:15:12.297Z","role":"human","text":"[result]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:15:20.199Z","role":"human","text":"[result]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:15:27.096Z","role":"human","text":"[result]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:15:23.717Z","role":"human","text":"[result]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:15:16.758Z","role":"human","text":"[result]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:15:30.770Z","role":"human","text":"[result]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:15:38.708Z","role":"human","text":"[result]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:15:55.540Z","role":"ai","text":"Let me also check the WRK-032 spec and the existing OrcInstallation module to understand what legacy is being absorbed.","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:16:02.987Z","role":"ai","text":"[tool:Glob]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:16:03.015Z","role":"ai","text":"[tool:Glob]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:16:03.038Z","role":"ai","text":"[tool:Glob]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:16:27.051Z","role":"human","text":"[result]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:16:27.018Z","role":"human","text":"[result]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:16:29.311Z","role":"human","text":"[result]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:16:31.524Z","role":"ai","text":"[tool:Glob]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:16:35.886Z","role":"ai","text":"[tool:Grep]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:16:35.922Z","role":"ai","text":"[tool:Glob]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:16:36.009Z","role":"human","text":"[result]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:17:02.434Z","role":"human","text":"[result]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:17:02.492Z","role":"human","text":"[result]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:17:05.002Z","role":"ai","text":"[tool:Read]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:17:05.312Z","role":"ai","text":"[tool:Read]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:17:10.015Z","role":"human","text":"[result]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:17:14.786Z","role":"human","text":"[result]","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
{"ts":"2026-02-03T20:19:27.707Z","role":"ai","text":"Now I have a thorough understanding of the plan, all contracts, the existing codebase, and the legacy system. Here is my structured review.\n\n---\n\n## Code Review: WRK-032 Implementation Plan\n\n### Review Summary\n\nPlan: \"Modular OrcaFlex Pipeline Installation Input with Parametric Campaign Support\"\nArtifacts reviewed: `plan.md`, `data-model.md`, `tasks.md`, 3 contracts, `quickstart.md`, plus existing source in `equipment.py`, `root.py`, `_enums.py`, `buoys_builder.py`, `registry.py`, `base.py`, `context.py`, `environment.py`, `schema/__init__.py`, and legacy `orcaflex_installation.py`.\n\n---\n\n### A. Completeness\n\nThe plan addresses the majority of WRK-032's acceptance criteria. Specific findings:\n\n**Covered adequately:**\n- RollerArrangement Pydantic model with all required geometric parameters\n- InstallationSection model\n- CampaignMatrix with the five parameter axes (depth, length, environment, soil, tension)\n- Section registry and composition engine\n- Variable substitution\n- Campaign generation with cartesian product\n- Backward compatibility with single-run mode\n- Both S-lay and floating tow methods\n- Legacy OrcInstallation absorption\n\n**Gaps identified:**\n\n1. **Structural completeness validation for composed models is missing from the contracts.** WRK-032 acceptance criterion states: \"Validation that composed models are structurally complete for OrcaFlex.\" The `CampaignGenerator.validate()` method only checks parameter ranges and name uniqueness. There is no validation that the assembled include-file set forms a structurally valid OrcaFlex model (e.g., that a model with a stinger also has a vessel, that a floating model has tugs, that required sections like `general` and `environment` are present). The existing `ProjectInputSpec.validate_consistency()` covers some of this, but only for the schema layer, not for the composed section output.\n\n2. **S-lay campaign parameter application is underspecified.** The plan says tension is overridden per-run, but the `CampaignGenerator` contract (step 2b) only mentions `water_depth -> environment.water.depth`. It does not specify where tension is applied in the spec. Looking at the existing `Tensioner` model, it has a `tension_value` field. The override path (`spec.equipment.tensioner.tension_value`) is never explicitly documented.\n\n3. **Route length adjustment logic is vague.** The contract says \"resolves route_length by adjusting pipeline segment lengths proportionally\" (step 2c). With multiple segments of different lengths, proportional adjustment is ambiguous. If a pipeline has segments of [3000, 2000], adjusting total from 5000 to 3000 proportionally gives [1800, 1200]. But this may not be physically meaningful -- the user might intend that only the main pipeline segment changes. The plan does not address this.\n\n4. **Soil variation application is not mapped.** The data model defines `SoilVariation` with `stiffness` and `friction_coefficient`, but neither the data model nor the campaign generator contract specifies how these map back into `ProjectInputSpec`. The target would be `spec.environment.seabed.stiffness` and `spec.environment.seabed.friction_coefficient`, but this mapping is never stated.\n\n5. **Environment variation is partially mapped.** `EnvironmentVariation` has `waves`, `current`, `wind` -- but the existing `Environment` model also has `water` and `seabed` fields. The campaign matrix already varies `water_depth` separately. The plan does not clarify whether `EnvironmentVariation` replaces only `waves`/`current`/`wind` or the entire `Environment` object. This needs to be explicit.\n\n---\n\n### B. Technical Accuracy\n\n**Pydantic model issues:**\n\n6. **`RollerStation.position` is `list[float]` without length validation in the data model definition.** The contract says \"length=3\" but the data model code sample uses bare `list[float]`. The existing codebase consistently uses `Field(..., min_length=3, max_length=3)` for position vectors (see `Tugs.first_position`, `Rollers.position`). The data model should show the Field constraints explicitly to match codebase convention, and a `field_validator` should be added as done in the existing `Rollers` class.\n\n7. **`RollerStation.support_count` lacks `Field` constraints in the data model.** The contract says range 1-20 but the code sample shows `support_count: int = 4` with no `Field(ge=1, le=20)`. The existing `Rollers.supports` field uses `Field(default=4, ge=1, le=20)`.\n\n8. **`RollerStation.v_angle` is always present, even for `flat` and `cradle` roller types.** This is misleading. A flat roller does not have a V-angle. The `v_angle` field should either be `Optional[float]` or the validator should conditionally require it based on the parent `RollerArrangement.type`. Currently, the `RollerStation` model has no reference to the parent type, which makes conditional validation impossible at the station level. This is a design issue.\n\n9. **`RollerArrangement.uniform()` factory assumes spacing along the X-axis only.** Line `pos = [first_position[0] + i * spacing, first_position[1], first_position[2]]`. This is a valid simplification for typical inline installations, but it should be documented as a constraint. Real roller routes could follow a curved path.\n\n10. **`Equipment.resolve_roller_compat` validator mutates `self` in an `\"after\"` mode validator.** The code does `self.roller_arrangement = RollerArrangement(...)`. In Pydantic v2, model instances are mutable by default, so this works, but it is fragile if `model_config = ConfigDict(frozen=True)` is ever set. The existing `Equipment` class does not use frozen config, so this is acceptable for now, but worth noting.\n\n11. **`EnvironmentVariation` and `SoilVariation` reference `Waves`, `Current`, `Wind`, `SeabedStiffness` models directly.** This is correct -- these models exist in `environment.py` and are already exported from `schema/__init__.py`. The import path is clean.\n\n12. **`CampaignMatrix.combinations()` is documented but the implementation is only `...` (ellipsis).** This is fine for a spec, but the return type `list[dict]` is imprecise. Each dict needs documented keys. The contract mentions \"named parameters\" but does not enumerate the key names or their types.\n\n**Builder integration issues:**\n\n13. **`BuoysBuilder.should_generate()` returns `False` for S-lay models (`not self.spec.is_s_lay()`).** This means S-lay models get no buoy section at all. But the plan's `RollerArrangement` should generate roller buoys for S-lay too -- stinger rollers are modeled differently (on the `Stinger` object via `StingerRoller`), but route rollers for S-lay are plausible. The plan does not clarify whether `RollerArrangement` applies to S-lay scenarios or only floating. Looking at the existing code, S-lay uses `StingerRoller` on the stinger, not 6D buoy rollers. If `RollerArrangement` is floating-only, this should be stated. If it applies to both, `should_generate()` needs modification.\n\n14. **`BuoysBuilder._build_roller()` uses hardcoded support positions** (`[17.5, 3.5, -1.6]`, etc.). The plan says T05 will replace this with `get_support_geometry()` that calculates positions from `v_angle` and `diameter`. But the existing hardcoded values bear no obvious relationship to a V-angle of 120 degrees and diameter of 0.5m. The plan does not provide the actual geometry formula. For a V-roller with half-angle = 60 degrees and radius 0.25m, the support position offsets should be on the order of `0.25 * sin(60) ~ 0.22m` and `0.25 * cos(60) ~ 0.125m`. The existing hardcoded values of 17.5 and 3.5 are orders of magnitude larger, suggesting they are in a different coordinate system (possibly the global/buoy-local frame for multiple rollers along the stinger). The plan needs to reconcile this discrepancy or it will produce incorrect geometry.\n\n15. **The roller naming convention changes from `\"Rollers\"` (singular entity) to `\"Roller_1\"`, `\"Roller_2\"`, etc.** This breaks downstream references. The existing `BuoysBuilder` registers `\"Rollers\"` in context. Other builders (lines, groups) may reference this name. The plan does not address updating cross-references in `LinesBuilder`, `GroupsBuilder`, or `SupportsBuilder`.\n\n---\n\n### C. Feasibility\n\n**Can be implemented with the existing codebase: Yes, with caveats.**\n\n16. **The `SectionComposer` is described as wrapping `ModularModelGenerator`, but no `ModularModelGenerator` class appears in the source tree.** The existing system uses `BuilderRegistry` with individual builders called in order. There is a `cli.py` and `__main__.py` but I was not shown a generator orchestrator class. If `ModularModelGenerator` does not exist, `SectionComposer` needs to be built from `BuilderRegistry` directly, or the plan should reference the actual orchestration mechanism.\n\n17. **The `SectionRegistry` contract says it is \"a thin facade\" over `BuilderRegistry`.** Looking at `BuilderRegistry`, it maps output filenames to builder classes. The `SectionType` enum in the data model has different granularity (e.g., `ROLLER_ARRANGEMENT` is not a separate builder -- rollers are built inside `BuoysBuilder`). The facade mapping is not straightforward. Either `SectionType` should match the actual builder output files, or the facade needs non-trivial translation logic.\n\n18. **T08 (legacy absorption) references `from_legacy_config()` accepting a legacy config dict.** The actual `OrcInstallation` class at `D:\\workspace-hub\\digitalmodel\\src\\digitalmodel\\solvers\\orcaflex\\orcaflex_installation.py` has three different methods (`create_model_for_water_depth`, `create_installation_depth_model`, `create_installation_depth_model2`) with different config structures. The plan only acknowledges one pattern (`delta_elevations` to `water_depths`). The second and third methods handle subsea installation with cranes, master links, and intermediate slings -- entirely different from pipeline installation. T08 should either explicitly scope to `create_model_for_water_depth` only, or acknowledge the other methods.\n\n19. **Dependencies on external packages.** The legacy `OrcInstallation` imports `assetutilities` (`saveDataYaml`, `ymlInput`, `add_cwd_to_filename`). The new system should not inherit these dependencies. The plan does not mention this.\n\n---\n\n### D. Risk Gaps\n\n20. **Missing risk: Name collision in output directories.** The `output_naming` template `\"{base_name}_wd{water_depth}m_{environment}\"` could produce identical names if parameter values collide (e.g., water_depth=8.0 vs 8.00, or environment names with special characters). The `validate()` method checks for duplicate names, but only after formatting. Floating-point formatting is not controlled (e.g., `water_depth=8` vs `water_depth=8.0`).\n\n21. **Missing risk: Deep copy performance.** `generate_run_specs()` deep-copies the entire `ProjectInputSpec` per combination. For large campaign matrices (96+ runs as shown in the example), this is 96 deep copies of a complex Pydantic model graph. Pydantic v2 `model_copy(deep=True)` is efficient, but the plan uses `copy.deepcopy()` which may not invoke Pydantic's optimized path.\n\n22. **Missing risk: Template file paths are relative, and resolution context is not specified.** `InstallationSection.template` is a string path. Relative to what? The campaign YAML file? The working directory? The project root? This ambiguity will cause file-not-found errors.\n\n23. **Missing risk: Concurrent file writes.** The plan mentions T04 and T05 are parallelizable at implementation time, but does not address whether campaign generation itself could be parallelized (generating multiple run directories concurrently). File I/O in parallel is a common source of bugs.\n\n24. **Missing risk: Variable substitution in YAML can produce invalid YAML.** If a variable value contains YAML special characters (`:`, `#`, `[`, `{`, etc.), the naive `str.replace()` approach in `VariableResolver` will produce syntactically invalid YAML. The plan mentions \"validate parsed YAML after substitution\" in the risk table but this is not reflected in the contracts or task definitions.\n\n---\n\n### E. Specific Improvement Suggestions\n\n1. **Add a parameter override mapping table to the CampaignGenerator contract.** Explicitly document: `water_depth` maps to `spec.environment.water.depth`; `tension` maps to `spec.equipment.tensioner.tension_value`; `environment` replaces `spec.environment.waves`, `spec.environment.current`, `spec.environment.wind`; `soil` replaces `spec.environment.seabed.stiffness` and `spec.environment.seabed.friction_coefficient`; `route_length` adjusts `spec.pipeline.segments[*].length`. Without this, implementers will make inconsistent choices.\n\n2. **Define the route length adjustment algorithm precisely.** Either: (a) scale all segments proportionally to match total, (b) adjust only the last segment, or (c) require that the user's campaign spec uses single-segment pipelines when varying route length. Document the chosen approach.\n\n3. **Make `RollerStation.v_angle` optional (`float | None = None`).** Default to `None` for flat and cradle types. Add a model validator on `RollerArrangement` that enforces `v_angle is not None` when `type == V_ROLLER`.\n\n4. **Add `Field` constraints to all `RollerStation` fields** to match the validation ranges listed in the contract (position length=3, support_count 1-20, v_angle 30-180, diameter 0.05-5.0, friction 0-1). The data model code sample is missing these.\n\n5. **Document the geometry formula for `get_support_geometry()`.** Provide the mathematical transformation from `(v_angle, diameter, support_count)` to OrcaFlex support positions. Reconcile with the existing hardcoded values in `_build_roller()` (which are in a completely different scale, suggesting a frame-of-reference issue).\n\n6. **Address roller name change impact on downstream builders.** Renaming from `\"Rollers\"` to `\"Roller_1\"` etc. will break `GroupsBuilder` and potentially `LinesBuilder` if they reference the roller buoy by name. Add a task step to T05 (or create T05b) to update cross-references and `BuilderContext` fields.\n\n7. **Add `roller_buoy_names: list[str]` to `BuilderContext`** so downstream builders can reference the dynamically generated roller names without hardcoding `\"Rollers\"`.\n\n8. **Verify or create `ModularModelGenerator` class.** The plan and `SectionComposer` contract reference this class, but it does not appear in the source tree. Either create it as part of T06, or update the contracts to reference `BuilderRegistry` directly.\n\n9. **Scope T08 explicitly to `create_model_for_water_depth()` only.** The other two methods in `OrcInstallation` (`create_installation_depth_model`, `create_installation_depth_model2`) handle subsea crane installation, which is not pipeline installation. Trying to absorb all three into the campaign system will dramatically increase scope.\n\n10. **Use `model_copy(deep=True)` instead of `copy.deepcopy()`** in `generate_run_specs()`. Pydantic v2's `model_copy` is designed for this and handles internal state correctly.\n\n11. **Add template path resolution rules** to the `SectionComposer` contract. Specify that template paths in `InstallationSection.template` are resolved relative to the campaign YAML file's directory.\n\n12. **Add YAML-safe value escaping** to `VariableResolver.resolve()`. After string replacement, either validate the resulting YAML or use a YAML-aware substitution mechanism (e.g., render into a dict structure, then dump to YAML) rather than raw string replacement.\n\n13. **Add a `max_runs` parameter to `CampaignGenerator.generate()`** as mentioned in the risk table but not reflected in the contract. The contract's `generate()` signature only takes `output_dir`.\n\n14. **Add `SectionType.ROLLER_ARRANGEMENT` handling to the `SectionRegistry` facade.** Currently, no builder produces a `roller_arrangement` section file separately -- rollers are built inside `BuoysBuilder`. If `SectionType.ROLLER_ARRANGEMENT` is in the enum, there must be a clear mapping to how it is generated. If it is always part of the buoys section, remove it from the enum to avoid confusion.\n\n15. **Add the `CampaignResult` dataclass and `CompositionResult` dataclass to the `schema/__init__.py` exports** or to a separate `campaign.py` module's `__all__`. The plan creates these but does not specify export paths.\n\n16. **Add an explicit backward-compatibility test in T03** that loads the existing floating spec YAML (`docs/modules/orcaflex/pipeline/installation/floating/30in_pipeline/spec.yml`) and the S-lay spec YAML (`docs/modules/orcaflex/pipeline/installation/s-lay/SB-SA/spec.yml`) and asserts they parse without error. The tasks mention this verbally but do not name the specific files to load.\n\n17. **Clarify the `ParameterRange` model's role.** It appears in the data model but is never referenced by `CampaignMatrix`, `CampaignSpec`, or any contract. It seems like a generic alternative to the typed fields (`water_depths`, `tensions`, etc.) on `CampaignMatrix`. If it is unused, remove it. If it is meant as a future extension point for arbitrary parameters, document that.\n\n---\n\n### Review Verdict\n\n**Status: NOT APPROVED -- revise and resubmit.**\n\nThe plan is well-structured and the phasing is logical, but it has several specification gaps that will cause implementation ambiguity or defects, particularly around:\n\n- Parameter-to-field override mapping (suggestions 1, 2, 4)\n- Roller geometry calculation (suggestions 5, 14)\n- Cross-builder reference breakage from renamed rollers (suggestions 6, 7)\n- Missing or phantom classes (`ModularModelGenerator`, `ParameterRange`) (suggestions 8, 17)\n- Legacy scope clarity (suggestion 9)\n- YAML-safety of variable substitution (suggestion 12)\n\nAddressing suggestions 1-9 is critical before implementation begins. Suggestions 10-17 are important but could be resolved during implementation with lower risk.","session":"ef48966e-5b14-4d9f-ae4f-6d8f30d68a2e"}
