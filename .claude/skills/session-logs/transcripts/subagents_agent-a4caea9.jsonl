{"ts":"2026-02-03T19:45:28.147Z","role":"ai","text":"I'll explore the digitalmodel project's diffraction module structure systematically.","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:45:28.366Z","role":"ai","text":"[tool:Bash]","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:45:35.402Z","role":"human","text":"[result]","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:45:37.603Z","role":"ai","text":"Now let me get the full path to the source diffraction module:","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:45:37.817Z","role":"ai","text":"[tool:Bash]","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:45:41.646Z","role":"human","text":"[result]","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:45:42.920Z","role":"ai","text":"Now let me read the key files to understand the structure:","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:45:43.358Z","role":"ai","text":"[tool:Read]","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:45:44.075Z","role":"ai","text":"[tool:Read]","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:45:51.489Z","role":"ai","text":"[tool:Read]","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:45:50.778Z","role":"human","text":"[result]","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:45:56.360Z","role":"human","text":"[result]","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:46:03.322Z","role":"human","text":"[result]","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:46:04.231Z","role":"ai","text":"[tool:Read]","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:46:12.705Z","role":"human","text":"[result]","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:46:16.156Z","role":"ai","text":"Now let me read the remaining key files:","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:46:16.673Z","role":"ai","text":"[tool:Read]","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:46:17.446Z","role":"ai","text":"[tool:Read]","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:46:24.375Z","role":"ai","text":"[tool:Read]","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:46:23.823Z","role":"human","text":"[result]","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:46:30.637Z","role":"human","text":"[result]","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:46:37.463Z","role":"human","text":"[result]","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:46:40.969Z","role":"ai","text":"Now let me check for test files and conftest:","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:46:41.432Z","role":"ai","text":"[tool:Bash]","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:46:47.586Z","role":"human","text":"[result]","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:46:50.949Z","role":"ai","text":"[tool:Read]","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:46:51.713Z","role":"ai","text":"[tool:Read]","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:46:57.759Z","role":"human","text":"[result]","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:47:04.693Z","role":"human","text":"[result]","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:47:08.475Z","role":"ai","text":"Now let me get the full DiffractionSpec and RunConfig classes:","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:47:09.033Z","role":"ai","text":"[tool:Bash]","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:47:11.295Z","role":"ai","text":"[tool:Bash]","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:47:13.721Z","role":"human","text":"[result]","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:47:15.218Z","role":"human","text":"[result]","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:47:16.967Z","role":"ai","text":"[tool:Read]","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:47:23.722Z","role":"human","text":"[result]","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:47:25.797Z","role":"ai","text":"Perfect! Now let me create a comprehensive summary document. Let me gather a few more details:","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:47:26.311Z","role":"ai","text":"[tool:Bash]","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:47:31.832Z","role":"human","text":"[result]","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
{"ts":"2026-02-03T19:48:14.838Z","role":"ai","text":"Excellent! Now I have all the information needed. Let me compile a comprehensive report.\n\n## Diffraction Module Structure Exploration Report\n\nI've completed a thorough exploration of the digitalmodel project's diffraction module. Here's the comprehensive information you requested:\n\n---\n\n### 1. **Exact Location of Diffraction Directory**\n\n**Full Path:** `/d/workspace-hub/digitalmodel/src/digitalmodel/hydrodynamics/diffraction/`\n\nThis is the primary source directory containing all diffraction analysis modules.\n\n---\n\n### 2. **All Existing Files in Diffraction Directory**\n\n| File | Type | Size | Purpose |\n|------|------|------|---------|\n| `__init__.py` | Module init | 4.5 KB | Public API exports and version info |\n| `input_schemas.py` | Schemas | 19.4 KB | Canonical spec schema (DiffractionSpec, VesselSpec, etc.) |\n| `output_schemas.py` | Schemas | 15.4 KB | Results schemas (DiffractionResults, RAOSet, etc.) |\n| `orcawave_runner.py` | Core logic | 17.3 KB | Runner orchestration (WRK-029) |\n| `orcawave_converter.py` | Converter | 12.8 KB | OrcaWave→unified schema conversion |\n| `orcawave_backend.py` | Backend | 19.4 KB | OrcaWave input generation |\n| `orcawave_data_extraction.py` | Utility | 14.4 KB | Data extraction from OrcaFlex models |\n| `orcawave_test_utilities.py` | Testing | 14.0 KB | Mock data generators for testing |\n| `output_validator.py` | Validator | 13.3 KB | Comprehensive output validation |\n| `aqwa_converter.py` | Converter | 14.6 KB | AQWA→unified schema conversion |\n| `aqwa_backend.py` | Backend | 14.4 KB | AQWA input generation |\n| `aqwa_lis_parser.py` | Parser | 22.2 KB | AQWA LIS file parsing |\n| `cli.py` | CLI | 21.8 KB | Command-line interface |\n| `batch_processor.py` | Processing | 14.4 KB | Batch job orchestration |\n| `comparison_framework.py` | Comparison | 17.4 KB | AQWA vs OrcaWave comparison |\n| `geometry_quality.py` | QA | 16.4 KB | Mesh geometry validation |\n| `orcaflex_exporter.py` | Exporter | 15.0 KB | Export to OrcaFlex format (YAML/CSV/Excel) |\n| `mesh_pipeline.py` | Pipeline | 10.5 KB | Mesh processing pipeline |\n| `spec_converter.py` | Converter | 5.6 KB | YAML spec conversion utilities |\n| `reverse_parsers.py` | Parser | 26.4 KB | Reverse parsing from binary formats |\n\n**Total:** 20 Python files, 340 KB combined\n\n---\n\n### 3. **`__init__.py` Exports**\n\n```python\n# Main results containers\n- DiffractionResults\n- RAOSet\n- AddedMassSet\n- DampingSet\n\n# Component data structures\n- RAOComponent\n- HydrodynamicMatrix\n- FrequencyData\n- HeadingData\n\n# Enumerations\n- DOF\n- Unit\n\n# Validation functions\n- validate_rao_completeness()\n- validate_matrix_set()\n- validate_diffraction_results()\n- OutputValidator\n- validate_results()\n\n# Export\n- OrcaFlexExporter\n\n# Converters\n- AQWAConverter\n- convert_aqwa_results()\n- OrcaWaveConverter (conditional, requires OrcFxAPI)\n- convert_orcawave_results()\n- ORCAWAVE_AVAILABLE (flag)\n\n# Phase 3: Automation + QA\n- DiffractionComparator\n- compare_diffraction_results()\n- BatchProcessor\n- BatchConfiguration\n- process_batch_from_config_file()\n- GeometryQualityChecker\n- GeometryQualityReport\n\n# Test utilities (optional)\n- MockDataGenerator\n- create_test_vessel()\n- OrcaWaveDataExtractor\n- extract_all_rao_data()\n- extract_all_added_mass()\n- extract_all_damping()\n- TEST_UTILITIES_AVAILABLE (flag)\n\n# WRK-029: OrcaWave runner\n- OrcaWaveRunner\n- RunConfig\n- RunResult\n- RunStatus\n- run_orcawave()\n\nVersion: 3.0.0 | Status: Phase 3 - Automation + QA (Complete)\n```\n\n---\n\n### 4. **Output Schemas: `DiffractionResults`, `RAOSet`, `RAOComponent`, `DOF`**\n\n#### **DOF Enum** (`output_schemas.py:17-24`)\n```python\nclass DOF(Enum):\n    SURGE = 1    # X-translation\n    SWAY = 2     # Y-translation\n    HEAVE = 3    # Z-translation\n    ROLL = 4     # Rotation about X\n    PITCH = 5    # Rotation about Y\n    YAW = 6      # Rotation about Z\n```\n\n#### **RAOComponent** (`output_schemas.py:88-104`)\n```python\n@dataclass\nclass RAOComponent:\n    dof: DOF                        # Degree of freedom\n    magnitude: np.ndarray           # RAO magnitude [nfreq x nheading]\n    phase: np.ndarray               # RAO phase in degrees [nfreq x nheading]\n    frequencies: FrequencyData      # Frequency discretization\n    headings: HeadingData           # Heading discretization\n    unit: str                       # RAO unit (depends on DOF type)\n    \n    def __post_init__(self): # Sets appropriate units based on DOF\n```\n\n#### **RAOSet** (`output_schemas.py:107-177`)\n```python\n@dataclass\nclass RAOSet:\n    vessel_name: str\n    analysis_tool: str              # \"AQWA\" or \"OrcaWave\"\n    water_depth: float              # meters\n    \n    # RAO components for each DOF\n    surge: RAOComponent\n    sway: RAOComponent\n    heave: RAOComponent\n    roll: RAOComponent\n    pitch: RAOComponent\n    yaw: RAOComponent\n    \n    # Metadata\n    created_date: str\n    source_file: Optional[str] = None\n    notes: Optional[str] = None\n    \n    def get_component(self, dof: DOF) -> RAOComponent: ...\n    def to_dict(self) -> Dict: ...\n```\n\n#### **DiffractionResults** (`output_schemas.py:284-314`)\n```python\n@dataclass\nclass DiffractionResults:\n    vessel_name: str\n    analysis_tool: str              # \"AQWA\" or \"OrcaWave\"\n    water_depth: float\n    \n    # Main coefficient sets\n    raos: RAOSet\n    added_mass: AddedMassSet\n    damping: DampingSet\n    \n    # Metadata\n    created_date: str\n    analysis_date: Optional[str] = None\n    source_files: Optional[List[str]] = None\n    notes: Optional[str] = None\n    \n    def to_dict(self) -> Dict: ...\n```\n\n---\n\n### 5. **OrcaWaveConverter Class** (`orcawave_converter.py:40-382`)\n\n```python\nclass OrcaWaveConverter:\n    \"\"\"Convert OrcaWave/OrcaFlex diffraction results to unified schema\"\"\"\n    \n    def __init__(self, model_file: Path, vessel_name: Optional[str] = None):\n        # Initialize with OrcaFlex model file path\n        # Auto-detects vessel if vessel_name is None\n    \n    def convert_to_unified_schema(\n        self,\n        water_depth: float,\n        load_model: bool = True\n    ) -> DiffractionResults:\n        \"\"\"Convert OrcaWave results to unified diffraction schema\"\"\"\n    \n    # Private methods:\n    def _load_model(self): ...\n    def _find_vessel(self): ...\n    def _extract_rao_data(self) -> Dict: ...\n    def _extract_added_mass_data(self) -> Dict: ...\n    def _extract_damping_data(self) -> Dict: ...\n    def _build_rao_set(self, rao_data: Dict, water_depth: float) -> RAOSet: ...\n    def _build_added_mass_set(self, am_data: Dict, water_depth: float) -> AddedMassSet: ...\n    def _build_damping_set(self, damp_data: Dict, water_depth: float) -> DampingSet: ...\n    def _get_analysis_date(self) -> Optional[str]: ...\n    @staticmethod def _get_added_mass_units() -> Dict[str, str]: ...\n    @staticmethod def _get_damping_units() -> Dict[str, str]: ...\n\ndef convert_orcawave_results(\n    model_file: str,\n    water_depth: float,\n    output_folder: str,\n    vessel_name: Optional[str] = None\n) -> Path: ...\n```\n\n---\n\n### 6. **OrcaWaveRunner & RunResult Classes (WRK-029)** (`orcawave_runner.py`)\n\n#### **RunStatus Enum** (`orcawave_runner.py:61-70`)\n```python\nclass RunStatus(str, Enum):\n    PENDING = \"pending\"\n    PREPARING = \"preparing\"\n    RUNNING = \"running\"\n    COMPLETED = \"completed\"\n    FAILED = \"failed\"\n    DRY_RUN = \"dry_run\"\n    CANCELLED = \"cancelled\"\n```\n\n#### **RunConfig** (`orcawave_runner.py:78-129`)\n```python\nclass RunConfig(BaseModel):\n    \"\"\"Configuration for an OrcaWave runner instance.\"\"\"\n    \n    executable_path: Path | None = Field(\n        default=None,\n        description=\"Explicit path to orcawave executable. Auto-detected if None.\",\n    )\n    output_dir: Path | None = Field(\n        default=None,\n        description=\"Directory for generated files and results.\",\n    )\n    dry_run: bool = Field(\n        default=False,\n        description=\"If True, generate files but skip solver invocation.\",\n    )\n    timeout_seconds: int = Field(\n        default=7200,\n        gt=0,\n        description=\"Maximum solver execution time in seconds.\",\n    )\n    generate_modular: bool = Field(\n        default=True,\n        description=\"Generate modular section files alongside the single input file.\",\n    )\n    copy_mesh_files: bool = Field(\n        default=True,\n        description=\"Copy mesh files referenced by the spec into the output directory.\",\n    )\n    extra_args: list[str] = Field(\n        default_factory=list,\n        description=\"Additional command-line arguments passed to the solver.\",\n    )\n```\n\n#### **RunResult** (`orcawave_runner.py:137-152`)\n```python\n@dataclass\nclass RunResult:\n    \"\"\"Result of an OrcaWave runner execution.\"\"\"\n    \n    status: RunStatus\n    input_file: Path | None = None\n    modular_files: list[Path] = field(default_factory=list)\n    output_dir: Path | None = None\n    mesh_files: list[Path] = field(default_factory=list)\n    log_file: Path | None = None\n    stdout: str = \"\"\n    stderr: str = \"\"\n    return_code: int | None = None\n    duration_seconds: float | None = None\n    error_message: str | None = None\n    spec_name: str | None = None\n```\n\n#### **OrcaWaveRunner** (`orcawave_runner.py:176-477`)\n```python\nclass OrcaWaveRunner:\n    \"\"\"Orchestrates OrcaWave input preparation and solver execution.\"\"\"\n    \n    def __init__(self, config: RunConfig | None = None) -> None: ...\n    \n    @property\n    def result(self) -> RunResult | None: ...\n    \n    # Public API\n    def run(\n        self, spec: DiffractionSpec, spec_path: Path | str | None = None\n    ) -> RunResult:\n        \"\"\"Execute the full pipeline: prepare + execute.\"\"\"\n    \n    def prepare(\n        self,\n        spec: DiffractionSpec,\n        spec_path: Path | str | None = None,\n    ) -> RunResult:\n        \"\"\"Generate input files, copy mesh files, and validate.\"\"\"\n    \n    def execute(self) -> RunResult:\n        \"\"\"Invoke the OrcaWave solver or perform dry-run.\"\"\"\n    \n    # Internal methods\n    def _detect_executable(self) -> Path | None: ...\n    def _generate_input_files(\n        self, spec: DiffractionSpec, output_dir: Path\n    ) -> tuple[Path, list[Path]]: ...\n    def _copy_mesh_files(\n        self, spec: DiffractionSpec, output_dir: Path, spec_dir: Path | None = None\n    ) -> list[Path]: ...\n    def _validate_mesh_references(\n        self, spec: DiffractionSpec, output_dir: Path\n    ) -> list[str]: ...\n    def _invoke_solver(\n        self, executable: Path, input_file: Path, output_dir: Path,\n        timeout: int, extra_args: list[str]\n    ) -> tuple[int, str, str]: ...\n    def _capture_log(self, output_dir: Path) -> Path | None: ...\n    @staticmethod def _derive_spec_name(spec: DiffractionSpec) -> str: ...\n\ndef run_orcawave(\n    spec: DiffractionSpec,\n    output_dir: Path | str = \"output\",\n    dry_run: bool = False,\n    timeout_seconds: int = 7200,\n    spec_path: Path | str | None = None,\n) -> RunResult:\n    \"\"\"Run an OrcaWave diffraction analysis from a DiffractionSpec.\"\"\"\n```\n\n---\n\n### 7. **OutputValidator Class** (`output_validator.py:21-389`)\n\n```python\nclass OutputValidator:\n    \"\"\"Validate diffraction analysis outputs\"\"\"\n    \n    def __init__(self, results: DiffractionResults): ...\n    \n    def run_all_validations(self) -> Dict:\n        \"\"\"Run complete validation suite\"\"\"\n        # Returns comprehensive validation report\n    \n    # Private validation methods\n    def _validate_physical_validity(self) -> Dict[str, List[str]]: ...\n    def _validate_ranges(self) -> Dict[str, List[str]]: ...\n    def _validate_frequency_coverage(self) -> Dict[str, List[str]]: ...\n    def _validate_heading_coverage(self) -> Dict[str, List[str]]: ...\n    def _validate_symmetry(self) -> Dict[str, List[str]]: ...\n    def _determine_overall_status(self, *issue_dicts) -> str: ...\n    def _print_validation_summary(self): ...\n    def export_report(self, output_file: Path): ...\n\ndef validate_results(\n    results: DiffractionResults,\n    output_file: Optional[Path] = None\n) -> Dict:\n    \"\"\"Run validation and optionally export report\"\"\"\n```\n\n**Validation Categories:**\n- Schema validation (completeness, dimensions, NaN/Inf)\n- Physical validity (RAO ranges, positive diagonal terms)\n- Range checks (phase, coefficient bounds)\n- Frequency coverage (min/max, spacing, discretization)\n- Heading coverage (full 360°, spacing, count)\n- Symmetry checks (matrix symmetry validation)\n\n---\n\n### 8. **CLI File** (`cli.py:1-200+`)\n\n**Main Commands:**\n- `diffraction convert-aqwa` - Convert AQWA results to OrcaFlex\n- `diffraction convert-orcawave` - Convert OrcaWave results to OrcaFlex\n- `diffraction compare` - Compare AQWA vs OrcaWave results\n- `diffraction batch-process` - Batch process multiple vessels\n- `diffraction validate-geometry` - Validate mesh geometry quality\n\n**CLI Group:** `@click.group()` at module level\n**Version:** 3.0.0\n\n---\n\n### 9. **Test Conftest & Fixtures** (`tests/hydrodynamics/diffraction/conftest.py`)\n\n```python\n# Fixtures location\nFIXTURES_DIR = Path(__file__).parent / \"fixtures\"\n\n@pytest.fixture\ndef fixtures_dir() -> Path:\n    \"\"\"Return path to test fixtures directory.\"\"\"\n\n@pytest.fixture\ndef ship_raos_spec_path(fixtures_dir: Path) -> Path:\n    \"\"\"Path to ship RAO spec fixture.\"\"\"\n    # -> fixtures/spec_ship_raos.yml\n\n@pytest.fixture\ndef semisub_spec_path(fixtures_dir: Path) -> Path:\n    \"\"\"Path to semi-sub spec fixture.\"\"\"\n    # -> fixtures/spec_semisub.yml\n\n@pytest.fixture\ndef fpso_turret_spec_path(fixtures_dir: Path) -> Path:\n    \"\"\"Path to FPSO turret spec fixture.\"\"\"\n    # -> fixtures/spec_fpso_turret.yml\n\n@pytest.fixture\ndef dry_run_config(tmp_path: Path) -> RunConfig:\n    \"\"\"RunConfig pre-configured for dry-run testing.\"\"\"\n    # RunConfig(output_dir=tmp_path, dry_run=True)\n```\n\n**Test Fixtures Directory:** `/d/workspace-hub/digitalmodel/tests/hydrodynamics/diffraction/fixtures/`\n\n**Available YAML Specs:**\n- `spec_ship_raos.yml`\n- `spec_semisub.yml`\n- `spec_fpso_turret.yml`\n\n---\n\n### 10. **DiffractionSpec & RunConfig Classes**\n\n#### **DiffractionSpec** (`input_schemas.py:539-621`)\n\n```python\nclass DiffractionSpec(BaseModel):\n    \"\"\"Top-level canonical specification for diffraction analysis.\n    \n    This is the schema for spec.yml files. It captures all information\n    needed to generate solver-specific inputs for AQWA, OrcaWave, or\n    other BEM solvers.\n    \"\"\"\n    \n    version: str = Field(default=\"1.0\", description=\"Schema version\")\n    analysis_type: AnalysisType = Field(\n        default=AnalysisType.DIFFRACTION,\n        description=\"Type of analysis\",\n    )\n    \n    # Single body (simple case)\n    vessel: Optional[VesselSpec] = Field(\n        None,\n        description=\"Single vessel (for single-body analysis)\",\n    )\n    # Multi-body\n    bodies: Optional[list[BodySpec]] = Field(\n        None,\n        description=\"Multiple bodies (for multi-body analysis)\",\n    )\n    \n    environment: EnvironmentSpec\n    frequencies: FrequencySpec\n    wave_headings: WaveHeadingSpec\n    solver_options: SolverOptions = Field(default_factory=SolverOptions)\n    outputs: OutputSpec = Field(default_factory=OutputSpec)\n    metadata: MetadataSpec = Field(default_factory=MetadataSpec)\n    \n    @model_validator(mode=\"after\")\n    def check_vessel_or_bodies(self) -> DiffractionSpec: ...\n    \n    def get_bodies(self) -> list[BodySpec]:\n        \"\"\"Get all bodies as a list, wrapping single vessel if needed.\"\"\"\n    \n    @classmethod\n    def from_yaml(cls, path: str | Path) -> DiffractionSpec:\n        \"\"\"Load spec from a YAML file.\"\"\"\n    \n    def to_yaml(self, path: str | Path) -> Path:\n        \"\"\"Save spec to a YAML file.\"\"\"\n    \n    def to_json_schema(self) -> dict:\n        \"\"\"Export JSON Schema for external validation.\"\"\"\n```\n\n#### **Key Sub-Models of DiffractionSpec:**\n\n1. **VesselGeometry** (`input_schemas.py:120-157`)\n   - `mesh_file: str`\n   - `mesh_format: MeshFormatType`\n   - `symmetry: SymmetryType`\n   - `reference_point: list[float]` (x, y, z)\n   - `waterline_z: float`\n   - `length_units: str`\n\n2. **VesselInertia** (`input_schemas.py:160-206`)\n   - `mass: float`\n   - `centre_of_gravity: list[float]`\n   - `radii_of_gyration: Optional[list[float]]`\n   - `inertia_tensor: Optional[dict[str, float]]`\n\n3. **VesselSpec** (`input_schemas.py:209-234`)\n   - `name: str`\n   - `type: Optional[str]`\n   - `geometry: VesselGeometry`\n   - `inertia: VesselInertia`\n   - `external_stiffness: Optional[list[list[float]]]`\n   - `external_damping: Optional[list[list[float]]]`\n   - `fixed_dofs: Optional[list[str]]`\n\n4. **EnvironmentSpec** (`input_schemas.py:237-273`)\n   - `water_depth: float | str` (\"infinite\" for deep water)\n   - `water_density: float = 1025.0`\n   - `gravity: float = 9.80665`\n\n5. **FrequencySpec** (`input_schemas.py:287-336`)\n   - `input_type: FrequencyInputType` (PERIOD or FREQUENCY)\n   - `values: Optional[list[float]]`\n   - `range: Optional[FrequencyRangeSpec]`\n   - Methods: `to_frequencies_rad_s()`, `to_periods_s()`\n\n6. **WaveHeadingSpec** (`input_schemas.py:346+`)\n   - Wave direction specification\n\n#### **RunConfig** (full definition at `orcawave_runner.py:78-129`)\n\nAlready detailed above in section 6.\n\n---\n\n### Summary Table of Key Files & Locations\n\n| Component | File | Location | Lines |\n|-----------|------|----------|-------|\n| DiffractionResults, RAOSet, RAOComponent, DOF | `output_schemas.py` | Lines 17-432 | 416 |\n| DiffractionSpec, VesselSpec, EnvironmentSpec | `input_schemas.py` | Lines 1-655 | 655 |\n| OrcaWaveConverter | `orcawave_converter.py` | Lines 40-382 | 343 |\n| OrcaWaveRunner, RunConfig, RunResult, RunStatus | `orcawave_runner.py` | Lines 61-513 | 452 |\n| OutputValidator | `output_validator.py` | Lines 21-389 | 369 |\n| CLI Commands | `cli.py` | Lines 37-615 | 579 |\n| Test Fixtures | `conftest.py` | Lines 1-39 | 39 |\n| Module Exports | `__init__.py` | Lines 1-176 | 176 |\n\n---\n\n### Architecture Overview\n\n```\nDiffractionSpec (input_schemas.py)\n    ↓\nOrcaWaveBackend.generate_single() [WRK-059]\n    ↓\nOrcaWaveRunner.prepare() [generates files, copies mesh, validates]\n    ↓\nOrcaWaveRunner.execute() [invokes orcawave.exe or dry-run]\n    ↓\nRunResult [status, paths, logs, duration]\n    ↓\nOrcaWaveConverter [converts to unified schema]\n    ↓\nDiffractionResults (output_schemas.py)\n    ↓\nOutputValidator [validates completeness & physical validity]\n    ↓\nOrcaFlexExporter [exports to YAML/CSV/Excel]\n```\n\n---\n\nAll file paths are absolute and ready for reference in your implementation tasks.","session":"1e35094e-0e12-4613-ae4b-dc93267c84ad"}
