---
id: WRK-263
title: Progressively reduce agent harness files to ~20 lines by migrating content to skills
status: done
priority: high
complexity: medium
compound: false
created_at: 2026-02-20T00:00:00Z
percent_complete: 100
completed_at: 2026-02-24
target_repos:
  - workspace-hub
commit:
spec_ref:
related: [WRK-226, WRK-229, WRK-230]
blocked_by: []
synced_to: []
plan_reviewed: false
plan_approved: false
standing: true
cadence: monthly  # revisit monthly; ~20 lines/file is target within 1 month
brochure_status: n/a
computer: ace-linux-1
execution_workstations: [ace-linux-1]
plan_workstations: [ace-linux-1]
---

# Progressively reduce agent harness files to ~20 lines by migrating content to skills

## What

Migrate content from the key AI agent harness files into purpose-built skills and docs so that each harness file becomes a minimal pointer index — targeting ~20 lines per file within one month. Establish this as a standing rule: **if content belongs in a skill, it should be in a skill; harness files are pointers, not documentation**.

**Files in scope:**
- `CLAUDE.md` (currently 113 lines, 5,147 bytes — 4KB budget)
- `MEMORY.md` (currently 59 lines, ~4.4KB — 200-line limit enforced)
- `AGENTS.md` (canonical contract file)
- `.codex/CODEX.md` and `.gemini/GEMINI.md` (provider adapters)

**Target:** ~20 lines per file, each file containing only:
1. One-line purpose statement
2. Pointer to canonical skill or doc for each topic
3. Hard-gate rules that must be inlined (no more than 5)

## Why

Every session loads these files unconditionally. Each byte of content that can live in a skill instead reduces the auto-loaded context budget. WRK-226 removed ~1,581 bytes from CLAUDE.md — this item drives the remaining reduction systematically. The 20-line target forces the question: "is this rule a skill or a pointer?" — which is the right question for every line.

Additionally, content in skills is:
- Versioned and improvable per-skill
- Discoverable via the knowledge graph
- Skippable when not relevant (on-demand load)
- Testable against session outcomes (skill scoring via WRK-229)

## Acceptance Criteria

- [x] Audit each in-scope file: classify every section as (a) must-inline, (b) belongs in existing skill, (c) belongs in new skill, (d) redundant/delete
- [x] For sections classified (b): add pointer line to harness file; verify skill already covers the content or extend it
- [x] For sections classified (c): create a new skill at the appropriate path in `.claude/skills/`; replace section with pointer
- [x] For sections classified (d): delete — no pointer needed
- [x] Each harness file reduced to ≤20 lines after migration (CLAUDE.md=20, MEMORY.md=18, AGENTS.md=20, .codex/CODEX.md=19, .gemini/GEMINI.md=18)
- [x] Establish the 20-line rule in `.claude/rules/coding-style.md` under a new "Agent Harness Files" section: *"CLAUDE.md, MEMORY.md, AGENTS.md, CODEX.md, GEMINI.md must not exceed 20 lines. Any content exceeding this limit must be migrated to a skill or doc before the file can be committed."*
- [x] R-HARNESS check in `scripts/readiness/nightly-readiness.sh`: warns if any harness file exceeds 25 lines; fixed paths for .codex/CODEX.md, .gemini/GEMINI.md, and added MEMORY.md coverage
- [x] Verify WRK-226's R5 budget warnings clear after reduction

## Plan

1. **Audit** — Read each file; tag every section with a classification label
2. **Extract skills** — For each "belongs in skill" section: create or extend the target skill; replace section with one-line pointer
3. **Delete redundant** — Remove sections already covered by MEMORY.md, process.md, or rules
4. **Inline gates** — Keep only mandatory hard gates (WRK gate rules, security, legal) that must fire every session
5. **Establish rule** — Add 20-line limit to coding-style.md; add R-HARNESS preflight check
6. **Verify** — Run `ensure-readiness.sh`; R5 should show CLAUDE.md within 4KB

## Agentic AI Horizon

- Agent harness files are the highest-leverage context to reduce — every byte saved is saved on every session, forever
- Skills-based architecture means agents load only what they need; this item moves the harness from "load everything" to "load nothing except pointers"
- **Disposition: invest now** — 20-line target is achievable in a single focused session; compounding value is immediate

---
*Source: "/work add that claude.md and memory.md and any other file contents should be transferred to appropriate skills such that these are minimum .. i.e. progressively target to 20 lines per file in a month and make this as a rule in future — this should touch the key ai agent harness files.. may be agents.md"*
