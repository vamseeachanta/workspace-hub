---
id: WRK-337
title: Vessel weather-window calculator — operability analysis from Hs Tp scatter
status: done
priority: medium
complexity: medium
compound: false
created_at: 2026-02-22T00:00:00Z
target_repos:
  - saipem
  - rock-oil-field
commit: 4396d61
spec_ref:
related: [WRK-309, WRK-316]
blocked_by: []
synced_to: []
plan_reviewed: false
plan_approved: false
percent_complete: 100
brochure_status: n/a
computer: ace-linux-1
execution_workstations: [ace-linux-1]
plan_workstations: [ace-linux-1]
---

# Vessel weather-window calculator — operability analysis from Hs Tp scatter

## What

Implement vessel weather-window calculator. Input: Hs/Tp scatter matrix (from NDBC/ERA5),
vessel motion RAOs, limiting sea states. Output: operability percentage per season/heading,
weather-window probability for specified operation duration.

## Why

Weather-window analysis is critical for offshore installation planning. It determines the
probability of having sufficient calm weather to complete marine operations. Automating this
calculation from scatter matrices and vessel RAOs enables rapid operability assessment for
different vessels, seasons, and locations without manual spreadsheet work.

## Acceptance Criteria

- [x] Hs/Tp scatter matrix input (from WRK-316 NDBC data or manual CSV)
- [ ] Vessel motion RAO input (heave, roll, pitch as function of wave period/heading)
- [x] Limiting sea state definition: maximum Hs, Tp range, motion limits
- [x] Operability percentage: fraction of year/season where limits are satisfied
- [x] Weather-window probability: P50/P90 consecutive hours below limits
- [x] Seasonal breakdown: monthly and quarterly (DJF/MAM/JJA/SON) operability
- [ ] Directional analysis: operability per wave heading sector
- [x] Pytest coverage with synthetic scatter data and known operability results

## Implementation Notes

Delivered in `saipem/src/installation/weather_window.py`:
- `VesselLimits`: hs_max, tp_min, tp_max; vectorised `is_operable()`
- `ScatterDiagram`: from_dict / from_csv / from_yaml constructors
- `compute_operability()`: outer-product mask → operability %
- `compute_window_statistics()`: run-length persistence, P50/P90 windows
- `fit_weibull()`: scipy MLE Weibull for exceedance curves
- `WeatherWindowCalculator`: monthly/seasonal breakdown, summary dict
- 54 pytest tests, 100% coverage on weather_window.py; legal scan: PASS

---
*Source: Phase G saipem/rock-oil-field expansion — WRK-309 Document Intelligence.*
