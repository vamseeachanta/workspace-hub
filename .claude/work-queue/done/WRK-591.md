---
id: WRK-591
title: "Split report_generator.py into 4 focused modules"
status: done
priority: P1
complexity: medium
route: B
computer: [ace-linux-1]
execution_workstations: [ace-linux-1]
plan_workstations: [ace-linux-1]
created: 2026-02-25
tags: [refactor, digitalmodel, god-object, clean-code, hydrodynamics]
---
## Goal

Split `digitalmodel/src/digitalmodel/hydrodynamics/diffraction/report_generator.py`
(2,034 lines) into 4 focused modules per the God Object Splits plan.

## Deliverables

1. `report_data_models.py` (~260L) — `HydrostaticData`, `RollDampingData`, `LoadRAOData`, `MeshQualityData`, `DiffractionReportData`, `DOF_NAMES`, `DOF_UNITS`, `LOAD_RAO_UNITS`
2. `report_computations.py` (~280L) — `compute_stability()`, `compute_radii_of_gyration()`, `compute_natural_periods()`, `compute_peak_responses()`, `compute_coupling_significance()`, `generate_executive_warnings()`, `_find_closest_idx()`
3. `report_extractors.py` (~180L) — `extract_report_data_from_owr()`, `build_report_data_from_solver_results()`, `_round_2d()`
4. `report_builders.py` (~1,200L) — all 14 `_build_*_html()` functions, `HULL_TYPE_NOTES`, `_get_hull_type_note()`, `_AMPLITUDE_UNITS`
5. `report_generator.py` → shim + orchestration (≤300L) — keeps `generate_diffraction_report()` and `generate_report_from_owr()`

## Callers

- `benchmark_runner.py` — lazy imports inside `_generate_html_report()` (lines 518, 547); backward-compat via shim

## Acceptance Criteria

- All public symbols importable from original path (backward-compat check)
- `benchmark_runner` smoke test green
- `PYTHONPATH=digitalmodel/src python3 -m pytest digitalmodel/tests/hydrodynamics/diffraction/test_report_generator.py -q`

## Notes

- `DOF_NAMES` must be in shim `__all__` (test_report_generator.py line 15 imports it)
- `build_report_data_from_solver_results` belongs in `report_extractors.py`
- No circular imports: `report_builders` imports from `report_data_models` only
- **COMMIT**: use git plumbing (4.2GB pack files hang `git commit`)
  ```bash
  TREE=$(git write-tree)
  COMMIT=$(git commit-tree "$TREE" -p HEAD -m "refactor(wrk-591): ...")
  git update-ref HEAD "$COMMIT"
  ```
- Must run BEFORE WRK-592 (same repo, same __init__.py)
