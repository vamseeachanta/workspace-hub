---
id: WRK-571
title: "feat(digitalmodel): port VIV MATLAB mode analysis scripts to Python"
status: done
priority: medium
complexity: large
compound: false
created_at: 2026-02-25T00:00:00Z
target_repos:
  - digitalmodel
commit:
spec_ref:
related:
  - WRK-309
  - WRK-568
  - WRK-570
blocked_by:
  - WRK-568
synced_to: []
plan_reviewed: false
plan_approved: false
percent_complete: 0
brochure_status: n/a
computer: ace-linux-1
---
# feat(digitalmodel): Port VIV MATLAB Mode Analysis Scripts to Python

## What

Port MATLAB VIV (Vortex-Induced Vibration) mode analysis scripts to Python in
`digitalmodel`. These implement natural frequency extraction and power-in region
identification per DNV-RP-F105 and API RP 2RD.

## Source MATLAB Files (in document index)

### VIV Mode Finding (DNV-RP-F105 power-in regions)
- `FindModes.m` / `ModesFind.m`
  - `/mnt/ace/docs/disciplines/drilling/projects/3824_bp_macondo_containment_riser_analysis/.../VIV/.../FindModes.m`
  - Parses SHEAR7/FEA output natural frequency table; identifies excited modes
    and power-in regions for a given current velocity
  - Multiple copies: 4000 DEN drilling riser, free-standing riser configurations

### Pluck Test Frequency Extraction
- `testmodes.m`
  - `/mnt/ace/docs/disciplines/completion/projects/31245_shell_west_boreas_bop_on_tree_assessment/ANL/VIV/Model Setup/Pluck Test/testmodes.m`
  - FFT-based natural frequency + damping extraction from pluck test time-history

### Shear7 VIV Post-Processing
- `PostProcVIVLoc.m`
  - `/mnt/ace/docs/disciplines/drilling/projects/0151_merton_riser_im/.../Shear7 VIV/PostProcVIVLoc.m`
  - Post-processes SHEAR7 output for VIV damage location along riser length

## Legal Note

VIV modal analysis uses publicly documented Euler-Bernoulli beam theory and
reduced velocity method (DNV-RP-F105). Port the algorithm, not client-specific
inputs. No client names in ported code.

## Target Module

```
digitalmodel/src/digitalmodel/structural/viv/
├── __init__.py
├── modes.py   # Natural freq table + power-in region identification
└── pluck.py   # Pluck test FFT-based frequency/damping extraction
```

## What These Calculate

### `modes.py`
- Reduced velocity: `Vr = U / (f_n * D)` (DNV-RP-F105 Sec 2)
- Power-in region: `3.0 < Vr < 16.0` (cross-flow) / `1.0 < Vr < 3.5` (in-line)
- Dominant mode identification from modal participation

### `pluck.py`
- FFT of acceleration/displacement time-history
- Peak picking for natural frequencies
- Logarithmic decrement for damping ratio
- Comparison of measured vs analytical Euler-Bernoulli frequencies

## Steps

1. Read `FindModes.m` and `testmodes.m` to understand algorithm
2. TDD: write tests using analytical beam natural frequencies
3. Implement `modes.py` — natural frequency table parser + power-in region finder
4. Implement `pluck.py` — FFT frequency extraction
5. Validate against MATLAB outputs; legal scan

## Acceptance Criteria

- [ ] `digitalmodel/src/digitalmodel/structural/viv/modes.py` implemented
- [ ] `digitalmodel/src/digitalmodel/structural/viv/pluck.py` implemented
- [ ] Tests: single-mode power-in identification, multi-mode case, out-of-range case
- [ ] Tests: pluck test FFT on synthetic sine-decay signal
- [ ] No client identifiers in code; legal scan pass
- [ ] Cross-review via `scripts/review/cross-review.sh`
