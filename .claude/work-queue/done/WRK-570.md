---
id: WRK-570
title: "feat(digitalmodel): port API 579 FFS MATLAB (GML/LML) to Python"
status: done
priority: high
complexity: large
compound: false
created_at: 2026-02-25T00:00:00Z
target_repos:
  - digitalmodel
commit:
spec_ref:
related:
  - WRK-309
  - WRK-568
blocked_by:
  - WRK-568
synced_to: []
plan_reviewed: false
plan_approved: false
percent_complete: 0
brochure_status: n/a
computer: ace-linux-1
---
# feat(digitalmodel): Port API 579 FFS MATLAB to Python — GML and LML

## What

Port the API 579-1/ASME FFS-1 Fitness for Service **General Metal Loss (GML)** and
**Local Metal Loss (LML)** MATLAB implementations to Python in `digitalmodel`.

## Source Files (in document index)

- `API579GML.m` — General Metal Loss; multiple project revisions (Rev0–Rev8, Live)
  - Primary: `/mnt/ace/docs/disciplines/drilling/projects/0168_python_support/.../API579GML.m`
- `API579LML.m` — Local Metal Loss; multiple revisions
  - Primary: `/mnt/ace/docs/disciplines/drilling/projects/0168_python_support/.../API579LML.m`
- `controlFileLML_01.m` — Control/input file demonstrating LML usage

Multiple revision history (Rev0→Rev8→Live) from the riser IM project provides
a regression test suite: outputs must match across revisions.

## What These Calculate

### GML (API 579-1 Part 4 — General Metal Loss)
- Remaining Strength Factor: `RSF = t_meas / t_min` (Level 1)
- Allowable RSF threshold (default 0.90)
- Inputs: OD, nominal WT, measured average WT, SMYS, design pressure, temperature

### LML (API 579-1 Part 4/5 — Local Metal Loss)
- Critical Thickness Profile (CTP) method
- Point Thickness Reading (PTR) analysis
- Level 1 and Level 2 assessment routes

## Legal Note

API 579-1 is a public standard. The algorithm is freely reimplementable.
No client project identifiers in ported code; docstrings must cite API 579-1
clause/equation numbers, not the MATLAB source files.

## Target Module

```
digitalmodel/src/digitalmodel/structural/ffs/
├── __init__.py
├── gml.py   # General Metal Loss — Part 4
└── lml.py   # Local Metal Loss — Part 4/5
```

## Steps

1. Read `API579GML.m` (primary revision) — map MATLAB variables to API 579-1 clauses
2. Read `API579LML.m` — map LML algorithm to Part 4/5 equations
3. TDD: write tests first using API 579-1 Annex worked examples
4. Implement `gml.py` and `lml.py` with dataclass inputs, typed outputs
5. Validate against MATLAB Rev8/Live outputs for regression coverage
6. Legal scan; cross-review

## Acceptance Criteria

- [ ] `digitalmodel/src/digitalmodel/structural/ffs/gml.py` implemented
- [ ] `digitalmodel/src/digitalmodel/structural/ffs/lml.py` implemented
- [ ] ≥5 unit tests for Level 1 GML (pass/fail RSF assessment)
- [ ] ≥5 unit tests for Level 1 LML (PTR/CTP)
- [ ] Outputs match MATLAB reference for all test cases
- [ ] No client identifiers in code (legal scan pass)
- [ ] Docstrings reference API 579-1 clause numbers
- [ ] Cross-review via `scripts/review/cross-review.sh`
