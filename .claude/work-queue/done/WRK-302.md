---
id: WRK-302
title: "fix: recurring Edit correction pattern — not responding to improve"
status: done
priority: medium
source: comprehensive-learning/phase-5
computer: ace-linux-1
execution_workstations: [ace-linux-1]
plan_workstations: [ace-linux-1]
percent_complete: 100
---
## Context
Auto-created by comprehensive-learning analysis.

## Description
Correction Trend Analysis detected increasing trend.
This week: 770
Last week: 601
4-week avg: 401.5

## Root Cause
83.6% of "Edit corrections" were sequential-chain edits (chain_position > 3) with
gaps < 30 s.  These are deliberate workflow sequences — e.g., editing 30+ CSV rows
in a pipelay-parameters.csv session, or incrementally updating SKILL.md sections.
`capture-corrections.sh` correctly logs any re-edit within 600 s, but the
`phase_5_correction_trend_analysis()` aggregator was not filtering out chain noise
before counting trends.  Result: 770 raw events escalated, masking any real signal.

Two additional contributing bugs:
- `session-analysis.sh` jq query used `.tool_sequence` / `.occurrences` fields
  against `skill-candidates.jsonl` entries that actually have `.signal` / `.score`.
  This produced 599 blank `- **null** — null occurrences` lines in script-candidates.md.
- `phase_7_action_candidates()` regex only matched the legacy format, so no
  skill candidates from the current schema were ever actioned.

## Fix Applied (2026-02-24)

### 1. Chain-noise filter in `phase_5_correction_trend_analysis()`
`scripts/analysis/comprehensive_learning_pipeline.py`:
- Skip corrections where `correction_gap_seconds < 60` AND `chain_position > 2`.
- These are sequential same-session edits, not genuine mistakes.
- Verified: Edit corrections drop from 513 to 184 this week (64% noise reduction).

### 2. Minimum-volume floor for WRK escalation
`scripts/analysis/comprehensive_learning_pipeline.py`:
- Added `MIN_WEEKLY_COUNT_TO_ESCALATE = 10`.
- Prevents low-volume tool trends (Write at ~8/week) from generating WRK noise.

### 3. Fix jq schema mismatch in `session-analysis.sh`
`scripts/analysis/session-analysis.sh`:
- Changed jq query from `.tool_sequence` / `.occurrences` to `.signal` / `.score`.
- Added `select(.signal != null and .signal != "")` guard.
- Fallback grep path updated to match `.signal` field.

### 4. Fix candidate parsing in `phase_7_action_candidates()`
`scripts/analysis/comprehensive_learning_pipeline.py`:
- Added `CURRENT_PATTERN` regex to match `- **signal** — score: X.X (source: ...)`.
- Added `MIN_SCORE_TO_ACTION = 0.7` threshold for score-based candidates.
- Legacy pattern preserved for backward compatibility.

### 5. Reset polluted script-candidates.md
`.claude/state/candidates/script-candidates.md`:
- Cleared 599 blank null-occurrence entries.

## Acceptance Criteria
- [x] Issue addressed or candidate assessed
