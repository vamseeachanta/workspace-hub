---
id: WRK-612
title: Research and prototype Gmsh Python API for automated hull mesh generation
status: done
priority: medium
complexity: medium
compound: false
created_at: 2026-02-25T00:00:00Z
completed_at: 2026-02-26T00:00:00Z
target_repos:
  - CAD-DEVELOPMENTS
commit: b8c50f6
spec_ref:
related:
  - WRK-611
  - WRK-613
blocked_by:
synced_to: []
plan_ensemble: false
ensemble_consensus_score: null
plan_reviewed: false
plan_approved: false
percent_complete: 100
brochure_status:
computer: ace-linux-2
execution_workstations: [ace-linux-2]
plan_workstations: [ace-linux-2]
---

# Research and prototype Gmsh Python API for automated hull mesh generation

## What

Research the Gmsh Python API (`import gmsh`) and build `agents/mesh_agent.py` — a prototype that takes a hull STEP file (exported from FreeCAD or pythonOCC) and produces a quality surface/volume mesh ready for FEA solvers (CalculiX, FEniCS, Elmer). Focus on a single hull geometry as proof of concept.

## Why

Gmsh is available on ace-linux-2, is fully scriptable via Python (`pip install gmsh`), and outputs `.msh` format readable by all open-source FEA solvers. Automating mesh generation is the critical bridge between CAD geometry (Stage 1) and FEA solving (Stage 3) in the pipeline.

## Acceptance Criteria

- [ ] Research note at `docs/research/gmsh-hull-meshing.md`: Gmsh Python API capabilities, mesh size strategies for curved hull surfaces, quality metrics
- [ ] `agents/mesh_agent.py` with `mesh_from_step(step_path, output_path, mesh_size=0.05) -> dict` — returns mesh quality stats
- [ ] Proof-of-concept: mesh at least one hull geometry from `geometry/hull/` exported to STEP
- [ ] Output: `.msh` file with surface + optional volume mesh; mesh quality report (element count, min/max aspect ratio, skewness)
- [ ] Mesh size parameters configurable via YAML (`specs/mesh_config.yaml`)
- [ ] 5+ tests in `tests/test_mesh_agent.py` (mock STEP input)
- [ ] Pushed to `bakkiprasad5669/CAD-DEVELOPMENTS`

## Research Questions

1. What Gmsh meshing algorithm works best for curved hull surfaces (BRep from OCC)?
2. Can Gmsh directly open FreeCAD `.FCStd` files via its OCC kernel, or must we export to STEP first?
3. What mesh size produces a quality mesh for structural FEA on a small hull (L~5m)?
4. How to handle watertight hull solid vs. surface-only shell meshing?

## Agentic AI Horizon

- Automated mesh generation removes the last manual step in the CAD→FEA pipeline
- AI can tune mesh size based on analysis type (coarse for global loads, fine for stress concentration)
- Gmsh supports adaptive refinement — future agents can run mesh convergence studies automatically

## Implementation Notes (2026-02-26, ace-linux-2)

**Files created/modified:**
- `agents/mesh_agent.py` (155 lines) — Gmsh Python API meshing pipeline
- `tests/test_mesh_agent.py` (132 lines) — 8 tests, all passing
- `specs/mesh_config.yaml` — mesh parameters (algorithm 6, sizes 40-400mm)
- `docs/research/gmsh-hull-meshing.md` — research findings

**Research answers:**
1. Algorithm 6 (Frontal-Delaunay) works best for curved hull surfaces
2. Gmsh cannot open FCStd directly — must export to STEP first
3. Mesh sizes 40-400mm produce quality mesh for 5m hull structural FEA
4. Surface-only shell meshing (dimension=2) is correct for thin-walled hull structures

**Proof-of-concept results:** 352 nodes, 582 S3 triangle elements, quality (minSICN): min=0.874, avg=0.982.

**Gmsh quality API gotcha:** Initial attempt used sequential element IDs which failed for mixed element types. Fixed by filtering for element type 2 (triangles) and using actual element tags from `gmsh.model.mesh.getElementsByType()`.

**Gmsh versions:** pip gmsh 4.15.1 (used), system binary 4.12.1 at `/usr/bin/gmsh`.

**Commit:** `b8c50f6` (auto-sync picked up)

---
*Source: WRK-610 analysis — mesh_agent.py is Stage 2 of the AI-agent FEA pipeline.*
