---
id: WRK-311
title: "improve: QTF benchmarking for case 3.1 — charts, comparisons, and validation depth"
status: pending
priority: high
complexity: medium
compound: false
created_at: 2026-02-23T00:00:00Z
target_repos:
  - digitalmodel
commit:
spec_ref:
related: [WRK-310]
blocked_by: []
synced_to: []
plan_ensemble: false
ensemble_consensus_score: null
plan_reviewed: false
plan_approved: false
percent_complete: 0
brochure_status: n/a
plan_workstations: [ace-linux-1]
execution_workstations: [ace-linux-1]
---

# improve: QTF benchmarking for case 3.1 — charts, comparisons, and validation depth

## Context

Case 3.1 is the bottom-mounted cylinder sum-frequency QTF validation against WAMIT.
The current `benchmark_report.html` has a 4-panel Plotly figure (mean drift PI,
quadratic PI, direct potential, indirect potential) with WAMIT reference markers
(× symbols) overlaid from digitized CSV files. The correlation is r=1.0000 across
all 11 frequency points. However, the charts and comparison depth are not yet
satisfying and need improvement.

Current state:
- WAMIT markers loaded from `3.1/digitized/*.csv` (4 files)
- OrcaWave lines from `.owr` → `.xlsx` → parsed QTF sheets
- Mean drift imag column is all-NaN (correct — mean drift is real-valued)

## What Needs to Improve

### 1. Chart quality and readability
- Review axis labels, units, tick formatting
- Check if the 4 QTF panels have consistent y-axis scales (or should they?)
- Add frequency band shading or annotations for key regions
- Verify mean drift panel shows only the real component (not NaN imag markers)
- Ensure WAMIT × markers are sized/coloured to stand out clearly from OrcaWave lines

### 2. WAMIT reference data quality
- Re-examine digitized CSV files against the paper figures (Figures 31–34)
- Are the digitized omega values correctly spaced (0.5–3.0 rad/s at 0.25 steps)?
- Are real/imag scales correct? The potential load panels currently show
  large values (100–550) which may be misread from the original figure
- Add a digitization confidence note to the report

### 3. Comparison completeness
- Case 3.1 computes a sum-frequency QTF — should include off-diagonal (ω₁≠ω₂) entries
- Currently only the diagonal (ω₁=ω₂) or mean-drift (ω=0) slice is shown
- Consider adding a 2D QTF surface heatmap (ω₁ vs ω₂, colour = amplitude)
- The diffraction RAO (first-order) should be shown as a separate figure for context

### 4. Validation narrative
- The existing "Validation Notes & Potential Mismatch Sources" table is generic
- Add case-specific observations: which QTF components match well / have caveats
- Explicitly note that WAMIT markers are approximate (digitized) so r=1 means
  OrcaWave tracks the curve shape, not that exact values match to machine precision

### 5. Figure layout
- Consider splitting the current 4-panel figure into two 2-panel figures:
  - Figure A: Drift and quadratic (true QTF quantities from pressure integration)
  - Figure B: Direct and indirect potential (second-order potential contributions)
- Or retain 4-panel but add a 5th panel for the sum-QTF total

### 6. Benchmark report section ordering
- QTF Analysis (section 12) is at the bottom — for a validation-focused report
  it may belong higher, e.g. after Load RAOs (section 7)

## Files Involved

- `scripts/benchmark/qtf_postprocessing.py` — main QTF figure builder
- `docs/modules/orcawave/L00_validation_wamit/3.1/digitized/*.csv` — WAMIT refs
- `docs/modules/orcawave/L00_validation_wamit/3.1/benchmark/benchmark_report.html`
- `src/digitalmodel/hydrodynamics/diffraction/benchmark_runner.py` — report assembly

## Acceptance Criteria

- [ ] All 4 QTF panels clearly legible with correct units and axis labels
- [ ] WAMIT digitized values verified against paper figures; corrections applied
- [ ] Mean drift panel shows real component only (no NaN imag trace)
- [ ] At least one additional comparison view (2D heatmap or off-diagonal slice)
- [ ] Case-specific validation narrative added (not just the generic mismatch table)
- [ ] Regenerated `benchmark_report.html` committed and pushed

## Open Questions (to resolve at session start)

1. Which specific charts in the current report are unsatisfactory? (Need user review
   of the rendered HTML before proceeding)
2. Are the digitized potential load values (100–550 range) correct or mis-scaled?
3. Should QTF section move earlier in the report, or stay at section 12?
