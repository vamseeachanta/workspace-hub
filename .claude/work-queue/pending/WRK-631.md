---
id: WRK-631
title: "feat(frontierdeepwater): Microsoft Teams chatbot integration — Phase 2 deployment for both clients"
status: pending
priority: medium
complexity: complex
compound: false
created_at: 2026-02-26T00:00:00Z
target_repos:
  - frontierdeepwater
  - TBD-client2-repo
commit:
spec_ref:
related:
  - WRK-628
  - WRK-625
  - WRK-626
  - WRK-627
  - WRK-629
  - WRK-630
blocked_by:
  - WRK-627
  - WRK-630
parent: WRK-628
synced_to: []
plan_reviewed: false
plan_approved: false
percent_complete: 0
brochure_status: n/a
computer: ace-linux-1
execution_workstations: [ace-linux-1]
plan_workstations: [ace-linux-1]
provider: claude
---

# feat(frontierdeepwater): Microsoft Teams Chatbot Integration — Phase 2 Deployment (Both Clients)

## What

Deploy engineering AI chatbots via Microsoft Teams for both Client 1 and Client 2,
replacing the desktop demo with a persistent, team-accessible assistant.

Both clients have Microsoft Teams — this enables a low-friction deployment path
without requiring browser setup or CLI access per engineer.

### Architecture

**Option A (Recommended — start here):**
Teams + Azure Bot Service + Claude API
```
Engineer (Teams) → Azure Bot Service → Claude API (with system prompt)
                       ↓
                 Logging / audit trail (Azure)
```
- System prompts from WRK-625 (Client 1) / WRK-629 (Client 2) loaded as bot persona
- No RAG required for Phase 2 — system prompt + conversation context sufficient
- Cost: ~$20-200/mo per team (Claude API usage)
- Setup time: 1-2 days with Azure Bot Framework SDK

**Option B (Graduate to when usage grows):**
Teams + Azure Bot Service + RAG backend
```
Engineer (Teams) → Azure Bot Service → RAG retriever → Company knowledge base
                       ↓                    ↓
                 Claude API          Azure Cognitive Search / Pinecone
```
- Index calculation memos, project reports, design basis docs
- Cost: $500-2,000/mo
- Setup time: 2-4 weeks

### Phase 2 Deliverables

**Teams bot configuration:**
- `deployment/teams-bot/manifest.json` — Teams app manifest
- `deployment/teams-bot/bot.py` — Azure Bot Service handler (Python)
  - Routes messages to Claude API with discipline-specific system prompt
  - Handles conversation threading (multi-turn context)
  - Logs Q&A to Azure Table Storage for audit trail
- `deployment/teams-bot/config.yaml` — API keys (env vars), model selection, rate limits
- `deployment/teams-bot/system_prompts/` — symlink to `ai-initiatives/prompts/`

**Client 1 Teams bot:**
- Bot name: "Rigid Jumper Assistant" (SME1's team channel)
- System prompt: `rigid_jumper_assistant.md` from WRK-625
- Fallback: "Pipeline Engineering Assistant" if pipeline queries detected

**Client 2 Teams bot:**
- Bot name: "Structural Engineering Assistant"
- System prompt: `structural_offshore_assistant.md` from WRK-629
- Focused on diffraction / plate FFS / GoA

**Shared infrastructure:**
- Azure resource group `aceengineer-ai-clients` with shared Bot Service
- Per-client app registrations (separate AAD apps for auth isolation)
- Usage dashboard: Azure Monitor → daily token consumption per client

### Rollout Plan

```
Week 2-3: Deploy bot to 2-3 engineers per team (pilot)
Week 4:   Evaluate usage metrics, refine prompts from pilot feedback
Week 5+:  Expand to full team; decide on RAG upgrade (Option B)
```

### Knowledge Base Integration (Option B path)

When graduating to RAG:
- Index sources: calculation memos, SOWs, design basis docs (client uploads)
- Chunking strategy: section-level (## headers) with frontmatter metadata
- Retrieval: top-3 chunks by cosine similarity, injected into Claude context
- Document store: Azure Blob Storage + Azure Cognitive Search
- Privacy: client 1 and client 2 data in separate search indexes (no cross-contamination)

## Why

Microsoft Teams is already the communication hub at both clients — deploying the AI
assistant there removes the "I have to open another tab" friction that kills adoption.
Bot appears in the engineer's existing channel; questions feel natural in chat format.
Azure Bot Service + Claude API is a 2-day setup with no new infrastructure beyond
what both clients already have (Microsoft 365 / Azure tenant).

## Acceptance Criteria

- [ ] `deployment/teams-bot/bot.py` implemented with Claude API integration
- [ ] `deployment/teams-bot/manifest.json` created for Teams app deployment
- [ ] Client 1 bot deployed to test Teams tenant and validated (3 questions)
- [ ] Client 2 bot deployed to test Teams tenant and validated (3 questions)
- [ ] Conversation threading (multi-turn context) working
- [ ] Audit log (Q&A pairs) persisted to Azure Table Storage
- [ ] Usage dashboard stub in Azure Monitor
- [ ] README: 1-page deployment guide for client IT admin
- [ ] No client API keys or tenant IDs hardcoded — all via env vars
- [ ] Legal scan passes

## Notes on Phasing

This item is blocked until demo succeeds (WRK-627, WRK-630). Create Azure resources only
after go-ahead from client pilots. The bot.py framework can be built speculatively but
no client tenant registration until approved.

## Agentic AI Horizon

High AI fit: Azure Bot Framework is well-documented; Claude orchestrates the full setup;
Codex writes bot.py. The architecture decision (Option A vs B) is the main human judgment
call — recommend user confirms Option A before Codex implements.
