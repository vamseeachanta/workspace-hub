---
id: WRK-116
title: "Scale hull panel meshes to target principal dimensions for hydrodynamic analysis"
status: pending
priority: medium
complexity: medium
compound: false
created_at: 2026-02-10T22:15:00Z
target_repos:
  - digitalmodel
commit:
spec_ref:
related: [WRK-114, WRK-043, WRK-031]
blocked_by: []
synced_to: []
plan: inline
plan_reviewed: true
plan_approved: true
percent_complete: 0
brochure_status:
tags: [hull-library, scaling, hydrodynamics, panel-mesh, diffraction]
---

# Scale Hull Panel Meshes to Target Principal Dimensions

## What
Build a hull scaling pipeline that takes a cataloged hull panel mesh (from WRK-114) and scales it to match target principal dimensions (length, beam, draft) for use in diffraction/hydrodynamic analysis. Support both geometric (uniform) and parametric (non-uniform) scaling approaches.

## Why
The hull library contains representative meshes at fixed dimensions. Real analysis requires meshes at project-specific dimensions. Rather than re-creating geometry from scratch, scaling existing panels to target L/B/D ratios is the industry-standard rapid workflow. This directly enables the parametric hull pipeline (WRK-043) and solver benchmarking (WRK-031).

## Acceptance Criteria
- [ ] Scaling function that takes a PanelMesh + target L/B/D and returns a scaled PanelMesh
- [ ] Geometric (uniform) scaling: single scale factor applied to all vertices
- [ ] Parametric (non-uniform) scaling: independent X/Y/Z scale factors from L/B/D ratios
- [ ] Preserve panel topology (connectivity unchanged, only vertex positions scaled)
- [ ] Output scaled mesh as GDF file ready for diffraction solvers
- [ ] Validate scaled mesh: no degenerate panels, correct bounding box, normals consistent
- [ ] Integration with hull catalog: select source hull by hull_id, scale to target, export
- [ ] Tests covering both scaling modes, edge cases, and round-trip verification

## Plan

**Target**: `src/digitalmodel/hydrodynamics/hull_library/mesh_scaler.py` (new) + integration with hull catalog

### Existing Assets (reuse)
- `src/digitalmodel/hydrodynamics/hull_library/mesh_generator.py` — GDF mesh generation, PanelMesh handling
- `src/digitalmodel/hydrodynamics/hull_library/coarsen_mesh.py` — existing mesh manipulation (vertex clustering pattern)
- `src/digitalmodel/hydrodynamics/hull_library/panel_catalog.py` — PanelCatalogEntry schema
- `src/digitalmodel/hydrodynamics/bemrosetta/models/mesh_models.py` — PanelMesh, MeshFormat models
- `data/hull_library/catalog/hull_panel_catalog.yaml` — source hull dimensions (LOA, beam, draft)
- `data/hull_library/panels/` — 14+ GDF meshes as scaling sources

### Phase 1 — Scaling Functions
- `scale_mesh_uniform(mesh, scale_factor) → PanelMesh` — single factor applied to all XYZ
- `scale_mesh_parametric(mesh, sx, sy, sz) → PanelMesh` — independent X/Y/Z factors
- `scale_mesh_to_target(mesh, source_dims, target_dims) → PanelMesh` — compute sx=L_target/L_source etc.
- Input: GDF vertex array + panel connectivity; output: same topology, scaled vertices
- Preserve panel normals orientation (outward-pointing convention for diffraction solvers)

### Phase 2 — Validation & Quality Checks
- Bounding box check: scaled mesh matches target L/B/D within tolerance
- No degenerate panels: minimum panel area > threshold (1e-4 m²)
- Panel normals: all outward-pointing (dot product with centroid vector > 0)
- Aspect ratio: flag panels with aspect ratio > 10:1 after scaling
- Waterplane area check: compare with expected Cwp × L × B

### Phase 3 — GDF Export & Catalog Integration
- Export scaled mesh as GDF file: `{hull_name}_scaled_{Lm}x{Bm}x{Dm}.gdf`
- Option to register scaled mesh in hull catalog as a derived entry (references source hull)
- CLI interface: `python -m digitalmodel.hydrodynamics.hull_library.mesh_scaler --hull barge_100x20x6 --target-L 150 --target-B 30 --target-D 9`

### Phase 4 — Tests
- Unit: scale known cube mesh → verify vertex positions
- Round-trip: scale up then scale down → verify original dimensions restored
- Integration: scale benchmark barge → run OrcaWave → verify RAO peak periods shift proportionally (note: √(scale_factor) is approximate, valid for simple geometries only — use as sanity check, not pass/fail)
- Edge cases: zero draft, very large aspect ratios, single-panel mesh, non-uniform scaling with extreme L/B ratios

---
*Source: "prepare a plan to scale the various hull objects for hydrodynamic analysis"*
