---
id: WRK-106
title: Hull panel geometry generator from waterline, section, and profile line definitions
status: pending
priority: medium
complexity: complex
compound: false
created_at: 2026-02-08 18:00:00+00:00
target_repos:
- digitalmodel
commit: null
spec_ref: null
related:
- WRK-043
- WRK-031
blocked_by: []
synced_to: []
tags:
- hull-geometry
- mesh-generation
- parametric
- diffraction
review:
  cross_review: pending
  iterations: 0
provider: claude
plan_reviewed: false
plan_approved: false
computer: ace-linux-1
---

# Hull Panel Geometry Generator from Line Definitions

## What
Build a hull data generator that creates hull panel geometry from line definitions. The generator takes waterline curves, section curves, and profile curves as input and produces panelised hull geometry suitable for diffraction analysis mesh generation. Support parametric hull form creation where hull shapes are defined by engineering line data rather than imported CAD meshes.

## Why
Current hull geometry for diffraction analysis relies on pre-existing meshes or manual CAD exports. A line-based generator enables:
- Rapid parametric hull form creation from standard naval architecture curves
- Hull variation studies without CAD tools (change waterlines/sections programmatically)
- Direct integration with the diffraction analysis pipeline (WRK-031, WRK-043)
- Consistent mesh quality control (panel density, aspect ratio) built into generation

## Acceptance Criteria
- [ ] Parse hull line definitions: waterline curves, section curves, profile curves
- [ ] Interpolate between defined sections to create full 3D hull surface
- [ ] Panelise hull surface into quad/tri panels suitable for diffraction solvers
- [ ] Support parametric variation of key hull parameters (beam, draft, length, bilge radius, etc.)
- [ ] Control panel density and distribution (finer near waterline, coarser at keel)
- [ ] Output formats compatible with existing mesh-utilities and diffraction pipeline
- [ ] Validate generated geometry: watertight below waterline, correct normals, no degenerate panels
- [ ] Unit tests for standard hull forms (box barge, ship-shaped, semi-submersible pontoon)
- [ ] Documentation with examples showing line input → panel output workflow

## Reference
- WRK-043: Parametric hull form analysis (downstream consumer of generated hulls)
- WRK-031: 3-way benchmark (needs hull geometries as input)
- Existing mesh-utilities skill for mesh operations

## Plan

**Target**: `src/digitalmodel/hull_library/line_generator/`

### Existing Assets (reuse)
- `hull_library/` — hull form library, schematic_generator (CoordMapper + SVG)
- `mesh_utilities/` — mesh operations, decimation (WRK-101 done)
- `hydrodynamics/bemrosetta/` — GDF mesh format support
- `visualization/svg_primitives.py` — SVG generation

### Phase 1 — Line Definition Parser
- `line_parser.py`:
  - Parse waterline curves (half-breadth at each station vs. waterline height)
  - Parse section curves (section shape at each station)
  - Parse profile curves (sheer, keel, deck line)
  - Input formats: CSV (station, offset pairs), JSON, YAML

### Phase 2 — Surface Interpolation
- `hull_surface.py`:
  - Interpolate between defined sections using `scipy.interpolate.BSpline`. For hull forms with discontinuities (transom, chine), split into smooth segments and interpolate separately.
  - Specify interpolation method constraints for monotonicity where applicable
  - Create full 3D hull surface from sparse line definitions
  - Handle symmetry (port/starboard mirroring)
  - **Deferred**: Parametric hull form variation (beam scaling, Lackenby transformation) deferred to a future WRK item. Phase 2 handles interpolation from explicit line definitions only.

### Phase 3 — Panelization
- `panelizer.py`:
  - Convert smooth surface to quad/tri panels
  - Control panel density: finer near waterline, coarser at keel
  - Configurable panel count target
  - Validate: watertight below waterline, correct outward normals, no degenerate panels

### Phase 4 — Output & Integration
- Export to GDF (BEMRosetta/WAMIT), OrcaWave formats
- AQWA mesh format export: **deferred** until `solvers/aqwa/` module exists (see WRK-039). Include format specification reference for future implementation.
- Integration with existing mesh-utilities for further operations
- SVG cross-section visualization for verification
- Add step for validating hydrostatic properties (displaced volume, centre of buoyancy) from the generated mesh

### Phase 5 — Tests
- Standard hull forms: box barge (exact), ship-shaped (use KCS or KVLCC2 hull offsets from SIMMAN workshop as reference validation hull), semi-sub pontoon
- Define quantitative mesh quality thresholds (e.g., max aspect ratio <5, min angle >15 deg)
- Mesh quality metrics: aspect ratio, minimum angle, panel area variance
- Hydrostatic validation: compare generated mesh volume/CB against analytical values for box barge
- Round-trip: lines -> surface -> panels -> verify geometry

### Review Notes
- **Verdict**: Claude: MINOR | Codex: MINOR | Gemini: APPROVE
- **Actions taken**:
  - Specified interpolation library: `scipy.interpolate.BSpline` with segment splitting for discontinuities
  - Deferred parametric hull form variation (beam scaling, Lackenby transformation) to future WRK item
  - Deferred AQWA mesh format export until `solvers/aqwa/` module exists (explicit dependency)
  - Added hydrostatic property validation step (volume, CB) from generated mesh
  - Added quantitative mesh quality thresholds
  - Specified reference validation hull: KCS or KVLCC2 from SIMMAN workshop per Codex feedback
  - Added monotonicity constraints for interpolation
- *Cross-reviewed: 2026-02-09*

*Approved by user: 2026-02-09*

---
*Source: /work add Expand hull data using lines — build a hull data generator for generating hull panel geometry from line definitions*

## Agentic AI Horizon

- Hull panel geometry generator from waterline/section/profile definitions is a core geometry input primitive that hydrodynamic analysis workflows depend on — high compounding value.
- Geometry generation from engineering line definitions requires domain-specific interpolation and panelisation logic; not superseded by general AI improvements.
- **Disposition: invest now** — this is foundational geometry infrastructure; agents running hull analysis (WRK-043, WRK-099, WRK-126) need a reliable panel mesh generator.
