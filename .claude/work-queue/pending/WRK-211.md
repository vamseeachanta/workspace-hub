---
id: WRK-211
title: 'Ecosystem health check skill — parallel agent for session and repo-sync workflows'
status: pending
priority: medium
complexity: medium
compound: false
created_at: 2026-02-19T00:00:00Z
target_repos:
  - workspace-hub
module: automation
tags:
  - ecosystem
  - health-checks
  - agent-teams
  - automation
  - skills
related:
  - WRK-210
  - WRK-208
  - WRK-209
  - WRK-207
blocked_by: []
synced_to: []
provider: claude
spec_ref: ''
plan_reviewed: false
plan_approved: true
percent_complete: 0
brochure_status: n/a
---

# WRK-211: Ecosystem Health Check Skill — Parallel Agent

## What

Create a skill at `.claude/skills/workspace-hub/ecosystem-health/SKILL.md`
that defines a standardised health check suite for the workspace-hub ecosystem.
This skill runs as a **parallel agent** at the end of `/repo-sync` sessions
or at session exit, checking encoding, hook wiring, uv availability, skill
frontmatter quality, and work queue integrity — without blocking the main
orchestrator.

## Why

**Session trigger (2026-02-19)**: User: "the workspace-hub repo ecosystem
should be health checked for all these key things. Let us create a skill that
will get rolled into right timing in a session as hook to avoid these problems.
This can be a parallel agent at the end of a repo-sync session or general
session based on workflows that we undertake on these repos."

Problems caught too late in this session:
- WRK-162.md arrived as UTF-16 — only detected at runtime crash
- Hook wiring was never verified after setup
- uv enforcement gaps discovered mid-session

A periodic health check catches these proactively.

## Health Check Suite

| Check | Command | Pass Condition |
|-------|---------|----------------|
| Encoding | `.claude/hooks/check-encoding.sh` | Exit 0, no bad files |
| Hook wiring | `git config core.hooksPath` | Returns `.claude/hooks` |
| pre-commit exists | `ls .claude/hooks/pre-commit` | File present + executable |
| uv available | `command -v uv` | Found in PATH |
| .gitattributes | `grep working-tree-encoding .gitattributes` | *.md/*.yaml rules present |
| Work queue index | `uv run --no-project python scripts/work-queue/generate-index.py --dry-run` | Exit 0 |
| Skill frontmatter | Scan for missing `name:`, `version:`, `tags:` | 0 missing |
| Diverged skills | `_diverged/` count | Stable or decreasing |
| Pending signals | `.claude/state/pending-reviews/` | < 50 unprocessed |

## Trigger Points

1. **End of `/repo-sync`** — after pull + encoding check (Phase 5)
2. **Session exit** — spawned as parallel agent by stop hook
3. **Manual** — `/ecosystem-health` command

## Acceptance Criteria

- [ ] `SKILL.md` created at `.claude/skills/workspace-hub/ecosystem-health/SKILL.md`
- [ ] Health check suite documented with pass/fail conditions
- [ ] Invocation pattern defined: parallel agent (Task tool with `subagent_type=Bash`)
- [ ] Output format: structured summary table + JSON signal for `/improve`
- [ ] `/repo-sync` skill updated: Phase 5 spawns ecosystem health agent
- [ ] Stop hook (`ecosystem-health-check.sh`) updated to reference this skill

## Plan

Route A — inline plan. User approved 2026-02-19.

**Deliverables**:
1. `.claude/skills/workspace-hub/ecosystem-health/SKILL.md`
2. Update `/repo-sync` skill Phase 5 to spawn health agent
3. Update `ecosystem-health-check.sh` stop hook to reference skill
4. JSON signal output spec for `/improve` consumption
