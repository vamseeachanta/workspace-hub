---
id: WRK-284
title: "Add WRK scope check to readiness.sh"
status: pending
priority: high
complexity: simple
compound: false
created_at: 2026-02-21T00:00:00Z
target_repos:
  - workspace-hub
related: [WRK-285]
blocked_by: [WRK-285]
---

# Add WRK scope check to readiness.sh

## What

`readiness.sh` (PreToolUse hook) runs at session start but only checks quota,
agent CLIs, and env tools. It does not check if a WRK item is in scope before
work begins — meaning Claude can start executing multi-step tasks with no WRK
item active.

## Plan (Route A)

1. Read `.claude/state/active-wrk` (created by WRK-285)
2. If file missing or empty → surface reminder with pending count
3. If file present → echo active WRK id as confirmation
4. Keep under 100ms (no git operations)

## Acceptance Criteria

- [ ] `readiness.sh` reads `.claude/state/active-wrk`
- [ ] Missing/empty file → prints warning with pending queue count
- [ ] Active WRK present → prints `Active: WRK-NNN` in startup output
- [ ] No change to existing quota/agent/env checks
- [ ] Runs in < 100ms

## Implementation Notes

Insert after the readiness-lock check, before `check_agent_capacity`.
Read state file: `ACTIVE_WRK=$(cat "${STATE_DIR}/active-wrk" 2>/dev/null || echo "")`.

## Session Notes (2026-02-21)

**Observed**: `readiness.sh` fires on the first tool call of every session but exits
with no WRK context — it only checks quota, agent CLIs, and env tools. This means
Claude can dive into multi-step execution before the WRK gate is even consulted.

**Pattern confirmed**: "tackle all" work in this session bypassed the WRK gate because
no session-start WRK check existed. The stop hook caught the violation, but the gate
should fire at the *start*, not the end.

**Insertion point**: after the readiness-lock (`LOCK_FILE`) check at line ~40, before
`check_agent_capacity` — keeps the check lightweight and non-blocking on valid sessions.
