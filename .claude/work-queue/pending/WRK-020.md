---
id: WRK-020
title: "GIS skill for cross-application geospatial tools \u2014 Blender, QGIS, well\
  \ plotting"
status: pending
priority: medium
complexity: complex
created_at: 2026-01-29 00:00:00+00:00
target_repos:
- digitalmodel
commit: null
spec_ref: null
related:
- WRK-015
blocked_by: []
synced_to: []
provider: claude
provider_alt: null
task_agents:
  phase_1: codex
  phase_2a: codex
  phase_2b: codex
  phase_3: codex
  phase_4: claude
  phase_5: codex
plan_reviewed: false
plan_approved: false
computer: ace-linux-2
---

# GIS skill for cross-application geospatial information and tools

## What
Build a GIS skill/module within digitalmodel that provides geospatial information, coordinate handling, and visualization tools for use across multiple applications and use cases:
- **Applications**: Blender (3D visualization), QGIS (spatial analysis), Google Earth/Maps, and other GIS-capable tools
- **Use cases**: Identifying and plotting well locations, bathymetry/terrain rendering, field boundary mapping, pipeline routes, platform locations
- **Core capabilities**: Coordinate transformation (geographic ↔ projected ↔ local), GIS data import/export, spatial queries, and integration APIs for each target application

Example workflow: given well coordinates from BSEE or other regulatory data, plot them interactively in Blender with proper geospatial positioning, or export to QGIS for spatial analysis overlaid on bathymetry.

## Why
GIS operations are needed across multiple workflows (metocean analysis, field data visualization, digital twin positioning, client presentations). A centralized GIS skill avoids duplicating coordinate handling and spatial logic across separate tools, and provides consistent geospatial capabilities to all downstream applications.

## Acceptance Criteria
- [ ] Coordinate reference system (CRS) handling: WGS84, UTM zones, local project coordinates
- [ ] Coordinate transformation utilities between CRS types
- [ ] Well location plotting capability:
  - QGIS: layer generation with well markers, attribute tables
  - Blender: 3D positioned well objects with metadata
- [ ] GIS data format support: GeoJSON, Shapefile, KML/KMZ, GeoTIFF
- [ ] Spatial query support: find wells within radius, bounding box, polygon
- [ ] Bathymetry/terrain data integration for 3D rendering
- [ ] Blender GIS integration: Python scripts/add-on for importing geospatial data
- [ ] QGIS integration: processing scripts or plugin for well data workflows
- [ ] API/interface for other applications to consume GIS data
- [ ] Document supported CRS, data formats, and application integration steps

## Plan

**Target**: `src/digitalmodel/gis/` (new top-level module — digitalmodel does not currently have a `gis/` directory)

### Existing Assets (reuse)
- `worldenergydata/metocean/` — NDBC buoy coordinates, NOAA station locations
- `worldenergydata/bsee/` — well locations (lat/lon from BSEE block/lease data)
- `digitalmodel/visualization/svg_primitives.py` — SVG generation patterns
- pyproj (if installed) for CRS transformations

### Phase 1 — CRS & Coordinate Engine
- `coordinates.py`:
  - `CoordinatePoint` dataclass: lat, lon, elevation, crs
  - CRS definitions: WGS84 (EPSG:4326), UTM zones, NAD83, local project coords
  - Transform between CRS using pyproj or manual formulas
  - Batch transform for coordinate lists

### Phase 2a — Core Formats (GeoJSON, KML/KMZ via xml.etree)
- `formats.py`:
  - Read/write GeoJSON (native Python, no heavy dependency)
  - Read/write KML/KMZ (xml.etree)

### Phase 2b — Heavy Formats (optional, requires external deps)
  - Shapefile support via optional fiona/geopandas dependency
  - GeoTIFF reader for bathymetry (optional rasterio dependency)

### Phase 3 — Spatial Queries
- `spatial.py`:
  - Find points within radius (Haversine)
  - Bounding box query
  - Polygon containment (ray casting for simple polygons)
  - Nearest-N search with KD-tree (scipy.spatial if available)

### Phase 4 — Application Integrations
- `blender_export.py`:
  - Generate Blender Python script that places well markers in 3D space
  - Coordinate mapping: geo coords → Blender scene units via configurable scale
  - Well metadata as Blender custom properties
- `qgis_export.py`:
  - Generate QGIS project file (.qgs) with well layer
  - Attribute table with well metadata
  - Styled layer definition (.qml) for well markers
- `map_export.py`:
  - Folium/Leaflet HTML map with well markers (no API key needed)
  - Optional Google Maps integration via API key

### Phase 5 — Tests
- Unit tests: CRS transform accuracy (known control points)
- Format round-trip tests: write → read → compare
- Spatial query tests: known points within/outside radius
- Integration: export BSEE well locations to GeoJSON, verify in map
- Blender export: validate generated Python script syntax via `ast.parse`
- QGIS export: validate `.qgs` XML schema without requiring QGIS runtime
- Test matrix: document which tests run without optional deps (pyproj, geopandas, rasterio)
- MVP test subset: GeoJSON + Haversine + Folium export must pass with zero optional deps

### Dependencies
- Core: no heavy dependencies (pure Python CRS for basic UTM)
- Optional: pyproj (accurate transforms), geopandas (shapefiles), folium (maps), rasterio (GeoTIFF)
- Blender/QGIS: export scripts only (don't require runtime installation)

### Review Notes
- **Verdict**: Claude: MINOR | Codex: MINOR | Gemini: APPROVE
- **Actions taken**:
  - Noted `gis/` is a new top-level module in digitalmodel
  - Split Phase 2 into 2a (Core Formats: GeoJSON, KML) and 2b (Heavy Formats: Shapefile, GeoTIFF)
  - Added Blender/QGIS export validation tests (ast.parse, XML schema) without runtime deps
  - Added test matrix and MVP test subset per Codex feedback
  - Defined strict MVP: GeoJSON + Haversine + Folium export with zero optional deps
- *Cross-reviewed: 2026-02-09*

*Approved by user: 2026-02-09*

---
*Source: gis skill to help with required gis information and tools for use across different applications eg: blender, qgis, etc. and different usecases eg: for identifying and plotting wells in interactive softwares such as blender etc*

## Agentic AI Horizon

- GIS skill centralises geospatial capability that multiple agents and workflows (metocean, field data, deployment analysis) will leverage — direct ecosystem boost.
- Coordinate transformation and spatial query primitives won't be superseded by model improvements; they need to be coded infrastructure.
- **Disposition: invest now** — the GIS skill is foundational scaffolding; agents will call it repeatedly once it exists; build it as a reusable skill module.
