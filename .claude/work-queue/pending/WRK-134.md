---
id: WRK-134
title: Add future-work brainstorming step before archiving completed items
status: pending
priority: medium
complexity: medium
compound: false
created_at: 2026-02-12T00:00:00Z
target_repos:
  - workspace-hub
commit:
spec_ref:
related: [WRK-094]
blocked_by: []
synced_to: []
plan_reviewed: false
plan_approved: false
percent_complete: 0
brochure_status: n/a
---

# Add Future-Work Brainstorming Step Before Archiving Completed Items

## What
Add a workflow step between item completion and archiving that identifies and brainstorms future work inspired by or enabled by the just-completed item. This captures follow-on opportunities while context is fresh.

## Why
Completed work items often reveal new opportunities, adjacent improvements, or downstream tasks. Currently these insights are lost once an item is archived. A structured brainstorming step ensures continuity and keeps the work queue fed with high-quality, context-rich items.

## Acceptance Criteria
- [ ] `on-complete-hook.sh` (or new pre-archive hook) prompts for future work identification
- [ ] Hook analyzes the completed item's scope, target repos, and related items to suggest follow-on work
- [ ] Suggested items can be auto-captured as new WRK items (pending user approval)
- [ ] process.md updated to document the new step between completion and archive
- [ ] SKILL.md updated with the new lifecycle step

## Plan

**Spec**: inline (Route B — medium complexity, 1 repo)
**Target**: `.claude/work-queue/scripts/`, `.claude/work-queue/process.md`, `.claude/skills/coordination/workspace/work-queue/SKILL.md`

### Design Decision: Pre-Archive Hook vs. Archive Script Integration

Integrate the future-work brainstorming into `archive-item.sh` as a **pre-archive step** that runs *before* the file move, rather than as a separate hook script. Rationale:

- The current flow is: `archive-item.sh` -> update frontmatter -> move file -> `on-complete-hook.sh` (brochure check) -> regenerate INDEX.
- A pre-archive brainstorming step belongs *before* the move, while context is still accessible and the user can abort the archive if they want to act on suggestions first.
- The brainstorming logic itself goes into a new script `suggest-future-work.sh` that `archive-item.sh` calls. This keeps responsibilities separated (single-purpose scripts) while maintaining the linear archive flow.
- The brochure hook (`on-complete-hook.sh`) remains post-archive as-is — it is informational and does not gate archiving.

**Revised archive flow**:
```
archive-item.sh WRK-NNN
  1. Find item in pending/working/blocked
  2. NEW: Run suggest-future-work.sh WRK-NNN <item-path>
     a. Parse completed item: title, ACs, plan, target_repos, related items
     b. Cross-reference pending items to avoid duplicate suggestions
     c. Generate suggestion categories (extensions, test gaps, docs, perf, adjacent)
     d. Print suggestions to stdout
     e. Prompt: "Create any of these as WRK items? [y/N/select]"
     f. If yes: call capture pipeline for approved suggestions, set related: [WRK-NNN]
  3. Update status to archived, set completed_at
  4. Move to archive/YYYY-MM/
  5. Run on-complete-hook.sh (brochure — unchanged)
  6. Regenerate INDEX.md
```

### Existing Assets to Reuse

| Component | Path | Reuse |
|-----------|------|-------|
| Archive script | `.claude/work-queue/scripts/archive-item.sh` | Insert call to new script at step 2 |
| Brochure hook | `.claude/work-queue/scripts/on-complete-hook.sh` | Pattern for frontmatter parsing (YAML extraction loop) |
| Index generator | `.claude/work-queue/scripts/generate-index.py` | `parse_frontmatter()` regex parser — reference for field extraction |
| Process docs | `.claude/work-queue/process.md` | Section 5 (Archive) needs new sub-step |
| Skill definition | `.claude/skills/coordination/workspace/work-queue/SKILL.md` | Scripts table + archive flow description |
| Pending items dir | `.claude/work-queue/pending/` | Cross-reference target for duplicate detection |
| State YAML | `.claude/work-queue/state.yaml` | `last_id` counter for new WRK item creation |
| Frontmatter template | `.claude/work-queue/process.md` (Conventions section) | Template for generated WRK drafts |

### Phase 1 — Script Implementation (ACs 1-3)

**Files**:
- `NEW: .claude/work-queue/scripts/suggest-future-work.sh`
- `EDIT: .claude/work-queue/scripts/archive-item.sh`

#### 1a. Create `suggest-future-work.sh`

Shell script (`#!/usr/bin/env bash`) that:

1. **Accepts**: `<WRK-NNN> <item-file-path>`
2. **Parses the completed item** (reuse the YAML frontmatter extraction pattern from `on-complete-hook.sh`):
   - `title` — what was accomplished
   - `target_repos` — which repos were touched
   - `related` — linked items (check their status: are they still pending?)
   - `complexity` — informs suggestion depth
   - Body text: `## What`, `## Acceptance Criteria`, `## Plan` sections
3. **Reads existing pending items** — scan `pending/*.md` to extract titles and IDs for duplicate avoidance
4. **Generates suggestion categories** — prints structured suggestions under these headings:
   - **Extensions**: capabilities that naturally follow from the completed work (e.g., "WRK-NNN added X — consider adding Y integration")
   - **Test coverage**: if the item's ACs mention tests, suggest additional edge cases or integration tests
   - **Documentation**: if no brochure exists for target repos, suggest creating one; if the item added features, suggest user-facing docs
   - **Performance**: for data/compute items, suggest benchmarking or optimization
   - **Adjacent improvements**: items that share `target_repos` or `related` items that are still pending — highlight synergies
5. **Prints suggestions** to stdout in numbered format:
   ```
   === Future Work Suggestions (from WRK-NNN) ===

   1. [extension] Add <Y> support to <module> (builds on <title>)
   2. [test-gap] Integration tests for <module> with real data
   3. [docs] Create marketing brochure for <repo>
   4. [adjacent] WRK-XXX (<related pending item>) may benefit from patterns established here

   Create WRK items for any of these? [enter numbers, 'all', or 'skip']:
   ```
6. **Captures user selection** — reads from stdin:
   - `skip` or empty: no items created, proceed to archive
   - `all`: create all suggestions
   - `1,3` or `1 3`: create selected suggestions
7. **Creates WRK items** for approved suggestions:
   - Read `last_id` from `state.yaml`, increment for each new item
   - Write frontmatter using the standard template (from `process.md` Conventions)
   - Set `related: [WRK-NNN]` linking back to the parent completed item
   - Set `priority: low` (suggestions default to low; user can reprioritize later)
   - Set `complexity: simple` as default (user refines during triage)
   - Write file to `pending/<WRK-NEW>.md`
   - Update `state.yaml` `last_id` and `total_captured` counters
   - Regenerate INDEX.md after all items created
8. **TTY detection**: If stdin is not a TTY (`[[ ! -t 0 ]]`), auto-skip the interactive prompt to avoid hanging in batch/CI/agent contexts. Print suggestions to stdout but do not wait for input.
9. **Exit code**: 0 on success (including skip), non-zero on error. Never blocks archiving on failure — if the script errors, print a warning and let `archive-item.sh` continue.

**Suggestion generation approach**: The script generates suggestions based on **pattern matching** against the completed item's content, not AI inference. This keeps it fast and deterministic:
- If ACs contain unchecked boxes → suggest follow-up item for remaining work
- If `target_repos` has repos without `docs/marketing/*brochure*` → suggest brochure creation
- If `related` contains pending items → surface them as adjacent work
- If title/body contains keywords like "phase 1", "initial", "basic" → suggest phase 2/advanced version
- If complexity is `complex` and no test coverage mentioned → suggest test hardening
- The orchestrator agent (Claude Code) can provide richer AI-generated suggestions when running `/work archive` interactively; the script provides a deterministic baseline

#### 1b. Modify `archive-item.sh`

Insert the `suggest-future-work.sh` call between finding the item and updating frontmatter:

```bash
# ── Suggest future work (pre-archive) ───────────────
if [[ -x "$SCRIPT_DIR/suggest-future-work.sh" ]]; then
    echo ""
    "$SCRIPT_DIR/suggest-future-work.sh" "$WRK_ID" "$SOURCE_FILE" || {
        echo "WARN: suggest-future-work.sh failed, continuing with archive"
    }
fi
```

Place this after the "Find the item" block (line ~37) and before the "Create archive directory" block (line ~42). The `|| { warn }` pattern ensures archive proceeds even if suggestions fail.

**Non-interactive mode**: Add `--no-suggest` flag to `archive-item.sh` for batch/CI use:
```bash
NO_SUGGEST=false
if [[ "${2:-}" == "--no-suggest" ]]; then
    NO_SUGGEST=true
fi
```
Skip the suggestion step when `NO_SUGGEST=true`.

#### Test strategy (Phase 1)

- **Manual test**: Archive a real completed item (e.g., one of the items in `working/`) and verify suggestions appear
- **Dry-run test**: Run `suggest-future-work.sh` directly against a working item without archiving — verify output format and no side effects when user selects `skip`
- **Edge cases**: item with no ACs, item with empty target_repos, item with no related items, item with all related items already archived

### Phase 2 — Documentation Updates (ACs 4-5)

**Files**:
- `EDIT: .claude/work-queue/process.md`
- `EDIT: .claude/skills/coordination/workspace/work-queue/SKILL.md`

#### 2a. Update `process.md`

In Section 5 (Archive), insert a new sub-step between the trigger description and the script steps:

```markdown
### 5. Archive

**Trigger**: All acceptance criteria met, or manual `/work archive WRK-NNN`.

#### 5a. Future Work Brainstorming (pre-archive)

Before archiving, the system prompts for follow-on work identification:

- Script: `scripts/suggest-future-work.sh WRK-NNN <item-path>`
  1. Parses the completed item's title, ACs, plan, target repos, and related items.
  2. Cross-references existing pending items to avoid duplicate suggestions.
  3. Generates categorized suggestions: extensions, test gaps, documentation, performance, adjacent work.
  4. Presents numbered suggestions for user selection.
  5. Creates approved suggestions as new WRK items with `related: [WRK-NNN]`.
- Skippable: user can enter 'skip' to proceed directly to archive.
- Non-blocking: if the script fails, archive continues with a warning.
- Disable with `--no-suggest` flag on `archive-item.sh`.

#### 5b. Archive Execution

- Script: `scripts/archive-item.sh WRK-NNN`
  [existing steps 1-4 renumbered, unchanged]
```

Also update the directory structure diagram to include `suggest-future-work.sh`.

#### 2b. Update `SKILL.md`

1. Add `suggest-future-work.sh` to the `scripts:` frontmatter list.
2. In the "Phase 2: Process" section, add a note about the pre-archive brainstorming step.
3. Add a new section "## Future Work Brainstorming" documenting the suggestion categories and capture flow.
4. Update the Scripts table at the bottom to include the new script.
5. Bump version to `1.5.0` with changelog entry.

#### Test strategy (Phase 2)

- Verify `process.md` renders correctly (no broken markdown tables or lists)
- Verify SKILL.md frontmatter parses correctly (YAML valid)
- Verify the new script appears in the scripts listing

### Phase 3 — Refinement and Edge Cases

**Files**:
- `EDIT: .claude/work-queue/scripts/suggest-future-work.sh` (refinements)

1. **Duplicate detection**: Before suggesting an item, grep pending titles for keyword overlap (>50% word match). If a close match exists, annotate the suggestion: `[may overlap with WRK-XXX: <title>]`
2. **Related item surfacing**: For each `related` ID in the completed item, check if it is still in `pending/` or `blocked/`. If so, include it as an "adjacent" suggestion with context about the relationship.
3. **Quiet mode**: Add `--quiet` flag that prints suggestions but skips the interactive prompt (for use by the orchestrator agent, which handles user interaction itself).

### Acceptance Criteria Mapping

| AC | Phase | Deliverable |
|----|-------|-------------|
| Hook prompts for future work identification | Phase 1a | `suggest-future-work.sh` prints categorized suggestions |
| Hook analyzes scope, target repos, related items | Phase 1a | Script parses frontmatter + body, cross-references pending items |
| Suggested items auto-captured as WRK items | Phase 1a | Script creates `pending/WRK-NEW.md` with `related: [WRK-NNN]` |
| process.md updated | Phase 2a | New sub-step 5a documented in Archive section |
| SKILL.md updated | Phase 2b | New script in frontmatter, new section, version bump |

### Estimated Effort

- Phase 1: ~120 lines of bash (suggest-future-work.sh) + ~10 lines edit (archive-item.sh) — 2-3 hours
- Phase 2: ~40 lines added to process.md + ~30 lines added to SKILL.md — 1 hour
- Phase 3: ~30 lines refinement to suggest-future-work.sh — 30 minutes
- **Total**: ~4 hours

---
*Source: /work add to workflow to identify and brainstorm future work after completion of existing work item i.e. prior to archiving item*
