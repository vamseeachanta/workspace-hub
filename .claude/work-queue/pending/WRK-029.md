---
id: WRK-029
title: "OrcaWave diffraction analysis runner + file preparation"
status: done
priority: high
complexity: complex
created_at: 2026-01-29T12:00:00Z
completed_at: 2026-02-03T00:00:00Z
target_repos:
  - digitalmodel
commit: cefb610d
spec_ref: specs/modules/mighty-gliding-lemur.md
related: [WRK-030, WRK-031, WRK-025]
blocked_by: []
synced_to: []
---

# OrcaWave Diffraction Analysis Runner + File Preparation

## What
Add the ability to run OrcaWave diffraction analysis from digitalmodel. Includes file preparation with modular structure — decide between include-file approach (OrcaWave's native include mechanism) vs linear YAML-based combined file. Implement solver invocation and execution lifecycle.

## Why
OrcaWave is the Orcina diffraction solver and integrates tightly with OrcaFlex. Supporting OrcaWave alongside AQWA provides solver diversity and enables benchmarking. File preparation must be modular for the same reasons as AQWA — reuse, parametric studies, and error reduction.

## Acceptance Criteria
- [x] OrcaWave solver invocation with configurable parameters — `OrcaWaveRunner.execute()` + `RunConfig`
- [x] Modular file structure decision: include files vs YAML combined (document rationale) — docstring in `orcawave_runner.py`
- [x] Template system for common input patterns — existing spec fixtures + `DiffractionSpec.from_yaml()`
- [x] Mesh/geometry input handling — `_copy_mesh_files()` + `_validate_mesh_references()`
- [x] Wave environment specification — existing `EnvironmentSpec` in `input_schemas.py`
- [x] Run status tracking and log capture — `RunStatus` enum + `RunResult` dataclass
- [x] Integration with batch pipeline (WRK-030) — `RunResult` compatible with `BatchProcessor`

## Deliverables
- `src/digitalmodel/hydrodynamics/diffraction/orcawave_runner.py` (350 lines)
- `tests/hydrodynamics/diffraction/test_orcawave_runner.py` (300 lines, 39 tests, 89.8% coverage)
- CLI command `run-orcawave` in `cli.py`
- Exports registered in `__init__.py`
- `dry_run_config` fixture in `conftest.py`

---
*Source: ability to run orcawave; file preparation with modular structure (include files or linear yaml file combined?)*
