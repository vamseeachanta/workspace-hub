---
id: WRK-259
title: "common.units — global unit conversion registry for cross-basin analysis"
status: pending
priority: high
complexity: medium
compound: false
created_at: 2026-02-20T00:00:00Z
target_repos:
  - worldenergydata
target_module: common.units
commit:
spec_ref:
related: [WRK-084, WRK-190, WRK-193, WRK-194, WRK-195]
blocked_by: []
plan: inline
plan_reviewed: false
plan_approved: false
percent_complete: 0
provider: claude
---

# common.units — Global Unit Conversion Registry

## Why

Every production data module (sodir, brazil_anp, ukcs, bsee, eia_us, texas_rrc,
canada) handles unit conversion independently with local constants:
- sodir: `Sm3_TO_BBL = 6.2898`, `MSM3_TO_MCF = 35.3147`
- brazil_anp: `SM3_TO_BBL` (own constant)
- ukcs: `TONNES_TO_BBL = 7.33`, `MMSCF_TO_MCF = 1000.0`
- bsee: barrels native
- canada: m3 native

Cross-regional analysis in `sodir/cross_regional.py` reimplements conversions
inline. There is no single source of truth. When a new basin module is added,
conversion factors are copy-pasted and may diverge.

## What

Build `src/worldenergydata/common/units.py`:

```python
# Central registry of conversion factors
# All factors should be traceable to SI or published industry standards

class OilUnits:
    SM3_TO_BBL = 6.2898      # 1 standard cubic metre crude → barrels (API standard)
    TONNE_TO_BBL = 7.33      # 1 tonne crude oil → barrels (API, varies ±5% by gravity)
    BBL_TO_SM3 = 1 / 6.2898

class GasUnits:
    SM3_TO_MMSCF = 1 / 28316.85  # 1 Sm3 gas → MMscf (exact)
    MSM3_TO_BCF = 0.0353147      # 1 MSm3 → BCF
    MMSCF_TO_MCF = 1000.0
    MCF_TO_MMSCF = 0.001

class WaterUnits:
    M3_TO_BBL = 6.2898
    TONNE_TO_BBL = 6.2898  # water ≈ 1 tonne/m3

def convert(value, from_unit: str, to_unit: str) -> float: ...
def convert_series(series, from_unit: str, to_unit: str) -> pd.Series: ...

UNIT_REGISTRY: dict  # maps (from, to) → factor
```

Also add `src/worldenergydata/common/units_catalog.md` — human-readable table
of all conversion factors with sources (API, ISO, ASTM).

## Acceptance Criteria

- [ ] `OilUnits`, `GasUnits`, `WaterUnits`, `PressureUnits`, `EnergyUnits` classes
- [ ] `convert(value, from_unit, to_unit)` function with registry lookup
- [ ] `convert_series(pd.Series, from, to)` for vectorised conversion
- [ ] All conversion factors referenced to standards (API, ISO, ASTM)
- [ ] `units_catalog.md` — human-readable reference table
- [ ] 20+ tests covering round-trip accuracy, edge cases, unknown units
- [ ] Update `sodir/`, `brazil_anp/`, `ukcs/` to import from `common.units`
  instead of local constants (search/replace, not a rewrite)

## Notes
- `common/` already exists: `catalog.py`, `types.py`, `validation/`, `logging.py`
- New file: `common/units.py` (fits the existing pattern)
- Conversion factors: use API Measurement Coordination Committee values
