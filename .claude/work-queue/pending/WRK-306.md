---
id: WRK-306
title: "feat: AI agent readiness check — claude/codex/gemini CLI versions + default models"
status: pending
priority: medium
created: 2026-02-22
tags: [readiness, ai-agents, cron, comprehensive-learning, session-start]
computer: ace-linux-1
blocked_by: []
---

## Goal

Add an AI agent readiness check that verifies `claude`, `codex`, and `gemini` CLIs are
installed, reachable, and using the current default model versions. Run nightly (not
per-session) to keep sessions lean.

## Motivation

Model versions change frequently. An outdated default model silently downgrades quality
without any warning. Grouping this into the nightly readiness/pipeline check keeps
sessions free of version-detection overhead.

## Scope

### 1. Readiness script

Create `scripts/readiness/ai-agent-readiness.sh`:

```
Checks per agent:
  claude: `claude --version` → extract version; compare to known-latest in config
  codex:  `codex --version`  → same
  gemini: `gemini --version` → same

Default model check (per agent):
  Run a minimal probe (e.g., `claude -p "ping" --model <default>`) to confirm
  the configured default model is accepted by the API.

Output: JSONL to .claude/state/session-signals/ai-readiness.jsonl
  {"ts":"ISO8601","agent":"claude","cli_version":"x.y.z","model":"claude-sonnet-4-6","status":"ok"}
  {"ts":"ISO8601","agent":"codex","cli_version":"x.y.z","model":"o4-mini","status":"ok"}
  {"ts":"ISO8601","agent":"gemini","cli_version":"x.y.z","model":"gemini-2.5-pro","status":"ok"}
  {"ts":"ISO8601","agent":"claude","status":"warn","detail":"CLI not found on PATH"}
```

### 2. comprehensive-learning integration

Add to Phase 1 (Insights): read `ai-readiness.jsonl` and surface any `warn` or `error` rows.
Add to Phase 10 (Report): include agent readiness summary line.

### 3. workstations skill cross-reference

Document in workstations SKILL.md `## Software Capability Map` which machines have which
AI agent CLIs available (already partially tracked under `programs:`; add entries for
`claude-code`, `codex`, `gemini` per machine).

### 4. Cron integration

Add to ace-linux-1 cron (or prepend to comprehensive-learning run):
```bash
# runs inside comprehensive-learning Phase 1 — no separate cron needed
```

### Known-latest config

Maintain a small YAML at `scripts/readiness/ai-agent-versions.yaml`:
```yaml
claude:
  cli_min: "1.0.0"          # minimum acceptable claude CLI version
  default_model: claude-sonnet-4-6
codex:
  cli_min: "1.0.0"
  default_model: o4-mini
gemini:
  cli_min: "1.0.0"
  default_model: gemini-2.5-pro
```

Update this file manually when new defaults are released.

## Acceptance Criteria

- [ ] `scripts/readiness/ai-agent-readiness.sh` created and tested on ace-linux-1
- [ ] `ai-readiness.jsonl` populated after first run
- [ ] comprehensive-learning Phase 1 reads and surfaces warnings
- [ ] workstations SKILL.md updated with CLI availability per machine
- [ ] Codex cross-review passes

## Route

Route A — new script + 2 small SKILL.md edits.
