---
id: WRK-230
title: Holistic session lifecycle — unify gap surfacing, stop hooks, and skill input pipeline
status: working
priority: high
complexity: medium
compound: false
created_at: 2026-02-20T00:00:00Z
target_repos:
  - workspace-hub
commit:
spec_ref:
related: [WRK-177, WRK-178, WRK-224, WRK-225, WRK-226, WRK-228, WRK-229, WRK-231, WRK-234]
blocked_by: [WRK-228, WRK-229, WRK-231]
synced_to: []
plan_reviewed: false
plan_approved: true
standing: true
cadence: weekly
auto_execute: true
percent_complete: 80
brochure_status: n/a
---

# Holistic session lifecycle — unify gap surfacing, stop hooks, and skill input pipeline

## What

Review and unify all session-boundary mechanisms — session start readiness, session end gap surfacing, stop hooks, and skill input pipeline — into a coherent lifecycle. The individual pieces exist (session-review.sh, WRK-177, WRK-178, WRK-224) but are not connected. This item makes the investment explicit: at session end, the agent actively surfaces knowledge gaps and spins off WRK items, rather than passively logging patterns.

## Why

The concept is the same whether triggered at session end or on a periodic cadence — identify gaps, surface for action, invest in the right knowledge. But session end is the highest-signal moment: skills were just exercised, knowledge limits were just hit, context is fresh. `session-review.sh` already extracts skill candidates but stops short of gap diagnosis and WRK item creation. We are explicitly investing energy here to close that gap — not just acknowledging it exists.

## The Lifecycle (current vs target)

| Trigger | Current | Target |
|---------|---------|--------|
| Session start | Readiness check (partial — WRK-224) | Full preflight: tool checks, quota, context health (WRK-226 hook) |
| Session end | `session-review.sh` — extracts skill candidates passively | Actively diagnose gaps, score skill demand, spin off WRK items for deep gaps |
| Stop hook | Engineering audit (WRK-177), data provenance (WRK-178) — isolated | Unified stop hook pipeline: audit + gap surfacing run in sequence |
| Periodic | Skills curation, knowledge graph (WRK-229) | Same — periodic is the backstop; session-end is the primary signal |

## Acceptance Criteria

- [ ] Extend `hooks/session-review.sh` to explicitly:
  - Score skills exercised in the session against their current depth
  - Flag skills that were called on but couldn't answer well (low-confidence responses, repeated fallbacks) as gap candidates
  - Apply the same triage logic as WRK-229: shallow gap → create skill autonomously; deep gap → spin off WRK item with context and demand evidence
- [ ] Coordinate with WRK-177 and WRK-178 stop hooks — run in a unified stop pipeline, not as isolated scripts
- [ ] Session-start preflight (WRK-226 hook) and session-end gap surfacing are complementary: start checks health, end surfaces new gaps
- [ ] Output of session-end gap surfacing feeds into WRK-229 periodic curation as prior signal — no duplicate gap WRK items created if one already exists
- [ ] Document the full lifecycle in `.claude/docs/session-lifecycle.md` (existing file, extend it)

## Agentic AI Horizon

- Agentic AI will make session boundaries less meaningful — agents will run continuously, not in discrete sessions. The lifecycle we build now should be trigger-agnostic: gap surfacing fires on session end today, on agent completion events tomorrow.
- **Disposition**: build now with trigger abstraction in mind; session-end is the first trigger, not the only one
- In 3–4 months the gap diagnosis quality will improve significantly as models improve — the scaffolding built here will benefit automatically

---
*Source: "knowledge gaps can also be surfaced when we go through sessions — review sessions and identify it. Is this better off happening at end of session? There is a work item for readiness. we should review these holistically. the concept is the same and we are doing the same thing except we are explicitly investing energy here"*
