---
id: WRK-611
title: Build FCStd parser for AI-agent geometry extraction (no FreeCAD required)
status: pending
priority: high
complexity: medium
compound: false
created_at: 2026-02-25T00:00:00Z
target_repos:
  - CAD-DEVELOPMENTS
commit:
spec_ref:
related:
  - WRK-612
blocked_by:
synced_to: []
plan_ensemble: false
ensemble_consensus_score: null
plan_reviewed: false
plan_approved: false
percent_complete: 0
brochure_status:
computer: ace-linux-2
---

# Build FCStd parser for AI-agent geometry extraction (no FreeCAD required)

## What

Build `agents/fcstd_parser.py` — a pure-Python library that extracts all useful data from FreeCAD `.FCStd` files without requiring a FreeCAD installation. Outputs a structured geometry metadata dict that other agents can consume.

## Why

FreeCAD `.FCStd` files are ZIP archives with readable internal structure:
- `Document.xml` — object tree (Sketch, Interpolation_Curve, Loft, Group, Mirror) — plain XML
- `Parameters` — B-spline knot parameters (binary little-endian doubles) — e.g., `t=[0.0, 0.212, 0.474, 0.737, 1.0]`
- `Tangents` — tangent vectors at control points (binary 3D doubles)
- `PartShape.brp` — OpenCASCADE BRep geometry (requires pythonOCC for full parsing)

The first three can be extracted with stdlib only (`zipfile`, `xml`, `struct`). This gives the agent the spline parameter space and object topology to understand and reconstruct hull geometry — without launching FreeCAD.

## Acceptance Criteria

- [ ] `agents/fcstd_parser.py` with `parse(path) -> dict` function using only stdlib (zipfile, xml.etree, struct)
- [ ] Output dict schema: `{filename, freecad_version, created_at, objects: [...], curves: [{name, n_points, params: [t_i], tangents: [(tx, ty, tz)]}], brep_files: [...]}`
- [ ] Handles all 12 `.FCStd` files in `geometry/hull/` without error
- [ ] Optional pythonOCC path: if `OCC` available, also parse one BRep and add vertex/edge counts
- [ ] CLI: `python3 agents/fcstd_parser.py geometry/hull/example.FCStd --json`
- [ ] 8+ unit tests in `tests/test_fcstd_parser.py`
- [ ] Pushed to `bakkiprasad5669/CAD-DEVELOPMENTS`

## Agentic AI Horizon

- This parser is the foundation for all downstream agents: mesh_agent reads curve params, solve_agent reads object topology
- Once BRep extraction is working via pythonOCC, agents can directly query vertex coordinates, face normals, and surface area — the inputs for mesh seeding and FEA pre-processing
- Future: LLM-driven geometry modification (change a spline parameter, regenerate the hull) becomes possible when the parameter space is exposed

---
*Source: review of CAD-DEVELOPMENTS — FCStd files contain extractable spline parameters and object trees accessible via stdlib.*
