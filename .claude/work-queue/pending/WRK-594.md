---
id: WRK-594
title: "data(worldenergydata): populate pipeline geometry lookup from BSEE + API 5L standard table"
status: pending
priority: high
complexity: medium
compound: false
created_at: 2026-02-25T00:00:00Z
target_repos:
  - worldenergydata
commit:
spec_ref:
  - data/modules/bsee/pipeline/
  - src/worldenergydata/bsee/pipeline/
related:
  - WRK-589
  - WRK-593
  - WRK-595
blocked_by: []
synced_to: []
plan_reviewed: false
plan_approved: false
percent_complete: 0
brochure_status: n/a
computer: ace-linux-1
---

# data(worldenergydata): Populate Pipeline Geometry Lookup

## What

Add two data tables that enable OD/WT-based pipeline identification and
enrichment for the OrcaFlex extraction pipeline (WRK-595):

1. `data/modules/pipeline/api_5l_pipe_schedule.csv` — standard pipe OD/WT table
2. A `PipelineSpecLookup` class in `worldenergydata.bsee.pipeline` that
   matches an extracted OD/WT against standard pipe schedules

## Why

OrcaFlex line objects contain OD and WallThickness in SI units (meters).
By matching these against API 5L / ISO 3183 standard pipe schedules,
we can enrich the extracted YAML with:
- Nominal pipe size (NPS)
- Pipe schedule (standard, extra strong, etc.)
- Material grade range (X42–X80)
- Applicable standards (DNV-OS-F101, API 1111, etc.)

This replaces the object name with meaningful engineering context.

## Sources

### API 5L Pipe Schedule Table

Published in API 5L / ISO 3183 (Specification for Line Pipe).
Full OD/WT tables are publicly reproducible from the standard.
Key columns:
```
nps_in, od_mm, od_in, schedule, wt_mm, wt_in,
weight_kgm, grade_range, standard, domain_hint
```

Relevant nominal sizes for offshore pipelines (from OrcaFlex models):
- 4" to 36" NPS (offshore typical range)
- Schedules: STD, XS, XXS, SCH40, SCH80, and specific WT from API 5L

### BSEE Pipeline Geometry

BSEE API: `https://www.data.bsee.gov/Other/DataTables/PipelineRaws.aspx`
Fields: PIPELINE_NAME, SEGMENT_LEN, FLUID_TYPE, OD_IN, WT_IN, GRADE,
        API_WELL_NO, INSTALL_DATE, STATUS_CD, WATER_DEPTH_FT

Download CSV, store as `data/modules/bsee/pipeline/pipeline_segments.csv`

## Implementation

### PipelineSpecLookup class

```python
class PipelineSpecLookup:
    def match_od_wt(
        self, od_m: float, wt_m: float, tolerance: float = 0.002
    ) -> dict | None:
        """
        Match extracted OrcaFlex OD/WT (SI) to closest standard pipe spec.
        Returns: {nps_in, od_mm, wt_mm, schedule, grade_range, standards[]}
        or None if no match within tolerance.
        """
```

## Steps

1. Create `api_5l_pipe_schedule.csv` from API 5L Table 2 (published standard)
   - Rows for NPS 4" to 36", STD/XS/XXS + common offshore schedules
2. Download BSEE pipeline CSV and store (may need filtering for GoM offshore)
3. Implement `PipelineSpecLookup.match_od_wt()` with tolerance matching
4. Add tests: match 0.2731m OD (10.75" NPS) → NPS 10, grade X65

## Acceptance Criteria

- [ ] `api_5l_pipe_schedule.csv` covers NPS 4"–36" with standard/XS/XXS
- [ ] `PipelineSpecLookup.match_od_wt(0.5334, 0.025)` → {"nps_in": 21.0, ...}
- [ ] BSEE pipeline CSV downloaded (GoM offshore pipelines)
- [ ] Tests pass
