---
id: WRK-343
title: "OpenFOAM technical debt and exploration — tutorials, ecosystem audit, WRK-047 refresh"
status: pending
priority: medium
complexity: medium
compound: false
created_at: 2026-02-23T00:00:00Z
computer: ace-linux-2
target_repos:
  - workspace-hub
  - digitalmodel
commit:
spec_ref:
related: [WRK-047, WRK-290, WRK-292]
blocked_by: []
synced_to: []
plan_reviewed: true
plan_approved: false
percent_complete: 85
brochure_status: n/a
---

# OpenFOAM technical debt and exploration

## What

Hands-on OpenFOAM exploration and ecosystem audit on ace-linux-2 to build practical
familiarity, resolve known issues, and refresh the WRK-047 implementation plan before
starting greenfield development in digitalmodel.

## Why

WRK-047 (OpenFOAM CFD capability for digitalmodel) was planned 2026-01-29 and approved
2026-02-10 — but no implementation has started. Since then, OpenFOAM v2312 was installed
on ace-linux-2 (WRK-290), PyFoam has a known broken dependency, and the GMSH meshing
module in digitalmodel has likely evolved. Running tutorials and auditing the ecosystem
now prevents false starts when WRK-047 kicks off.

## Prior Work in digitalmodel

Significant OpenFOAM planning already exists in the digitalmodel repo from July 2025.
This work item must review and reconcile these specs with the newer WRK-047 plan:

| Document | Path | Content |
|----------|------|
---------|
| **Main spec** | `digitalmodel/.claude/projects/2025-07-29-openfoam-capabilities/spec.md` | User stories, scope, deliverables for OpenFOAM integration |
| **Technical spec** | `digitalmodel/.claude/projects/2025-07-29-openfoam-capabilities/sub-specs/technical-spec.md` | Module structure (`src/digitalmodel/modules/openfoam/`), PyFoam integration, YAML config schema, solver config |
| **Test spec** | `digitalmodel/.claude/projects/2025-07-29-openfoam-capabilities/sub-specs/tests.md` | 150+ lines of unit/integration test coverage, mock strategy, validation benchmarks |
| **Roadmap ref** | `digitalmodel/.claude/product/roadmap.md` | OpenFOAM listed as Phase 5 "should-have" under Advanced Simulation |
| **GMSH module** | `digitalmodel/src/digitalmodel/solvers/gmsh_meshing/__init__.py` | Already exports to OpenFOAM mesh format |
| **Blender example** | `digitalmodel/src/digitalmodel/solvers/blender_automation/examples/marine_engineering_integration.py` | Hull STL export for OpenFOAM/Fluent CFD |

### Key discrepancy to resolve

The July 2025 spec places the module at `src/digitalmodel/modules/openfoam/` while WRK-047
places it at `src/digitalmodel/solvers/openfoam/`. The `solvers/` path is consistent with
GMSH and Blender patterns. Section 5 of this work item must resolve this.

## Scope

### 1. Tutorial walkthroughs (hands-on)

Run standard OpenFOAM tutorials on ace-linux-2 to verify the installation end-to-end
and build operator familiarity:

| Tutorial | Solver | Tests |
|----------|--------|
-------|
| cavity | icoFoam | blockMesh → solve → paraFoam |
| damBreak | interFoam | VOF free surface, multi-phase |
| motorBike | simpleFoam + snappyHexMesh | External aero, complex mesh |
| pitzDaily | simpleFoam | Turbulence modeling (k-epsilon) |

Document each run: commands, runtime, any errors, output screenshots/notes.

### 2. OpenFOAM version landscape

- Compare ESI (v2312 installed) vs Foundation (v12) dict syntax differences
- Identify which version WRK-047 templates should target
- Document any syntax that differs between versions (e.g., turbulenceProperties format)
- Decision: confirm or revise WRK-047's "target ESI v2306+" assumption

### 3. Python ecosystem audit

| Package | Status on ace-linux-2 | Action |
|---------|----------------------|
--------|
| **PyFoam** | Broken (`six.moves` error) | Fix or find alternative |
| **fluidfoam** | Not installed | Evaluate for post-processing |
| **oftest** | Not installed | Evaluate for OpenFOAM testing |
| **meshio** | Pending install | Install and verify OpenFOAM mesh conversion |
| **pyvista** | Not installed | Evaluate for visualization |
| **Allrun/Allclean** | System scripts | Document patterns for automation |

For each: install, verify, document capability and integration potential.

### 4. OpenFOAM dict file structure patterns

Study the dict file syntax that WRK-047 Phase 1 needs to generate:
- `blockMeshDict` — vertex specification, block structure, grading
- `snappyHexMeshDict` — surface refinement, layer addition
- `controlDict` — solver control, function objects
- `fvSchemes` / `fvSolution` — numerical scheme selection
- `transportProperties` / `turbulenceProperties` — physics models
- `decomposeParDict` — parallel decomposition

Document the template patterns needed, identify which are boilerplate vs case-specific.
Cross-reference against the YAML config schema in the July 2025 technical spec.

### 5. WRK-047 plan refresh

Audit WRK-047 against current state:
- [ ] OpenFOAM now installed (was "NOT installed" in plan)
- [ ] GMSH meshing module in digitalmodel — has it changed since Jan 29?
- [ ] BemRosetta mesh models — any updates?
- [ ] PyFoam broken — impact on Phase 4/5?
- [ ] Are Jinja2 templates the right approach or should we use f-strings/dataclasses?
- [ ] **Reconcile July 2025 specs with WRK-047**: module path (`modules/` vs `solvers/`),
      YAML config schema overlap, test coverage overlap, dependency list alignment
- [ ] July 2025 spec chose "Option B: File-Based Integration with PyFoam" — still valid
      given PyFoam is currently broken?
- Produce a delta document: what changed, what still holds, recommended plan amendments

## Acceptance Criteria

- [ ] At least 3 OpenFOAM tutorials run successfully on ace-linux-2
      *(pitzDaily confirmed via WRK-290; cavity + damBreak pending live session)*
- [x] Tutorial run notes documented in `docs/research/openfoam-tutorials.md`
- [x] ESI vs Foundation version comparison documented
- [x] Python ecosystem packages audited (install status, working/broken, capability)
- [x] PyFoam `six.moves` issue resolved or alternative identified
- [x] Dict file patterns documented for template generation
- [x] July 2025 specs reviewed and reconciliation notes produced
- [x] WRK-047 delta document produced with recommended plan amendments
- [x] All findings feed back into WRK-047 and WRK-292

## Deliverables

| Artifact | Path |
|----------|
------|
| Tutorial run notes | `docs/research/openfoam-tutorials.md` |
| Version comparison | `docs/research/openfoam-version-landscape.md` |
| Python ecosystem audit | `docs/research/openfoam-python-ecosystem.md` |
| Dict pattern reference | `docs/research/openfoam-dict-patterns.md` |
| WRK-047 delta / refresh | `docs/research/openfoam-wrk047-refresh.md` |

## Execution Notes

- **Machine**: ace-linux-2 (OpenFOAM v2312 installed, verified)
- **Prerequisite**: Gmsh and ParaView should be installed first (WRK-290 pending items)
  — but tutorials 1-2 only need blockMesh + solver + basic post-processing
- **Parallelism**: Sections 1-4 can run in parallel; Section 5 depends on findings from 1-4
- **Time estimate**: 2-3 focused sessions

## Agentic AI Horizon

- Tutorial walkthroughs require shell access on ace-linux-2 — agent can drive if SSH available
- Ecosystem audit is research-heavy — well suited for AI-assisted evaluation
- Dict pattern analysis is pattern recognition — AI can extract templates from tutorial cases
- WRK-047 refresh is a planning task — AI excels at cross-referencing current vs planned state
- **Disposition: do now** — this is prerequisite exploration that de-risks WRK-047 implementation

---
*Source: user request for OpenFOAM technical debt and exploration work item*
