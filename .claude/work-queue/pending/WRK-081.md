---
id: WRK-081
title: Build interactive NPV calculator for website lead generation
status: pending
priority: low
complexity: complex
compound: false
created_at: 2026-02-02T14:00:00Z
target_repos:
  - aceengineer-website
commit:
spec_ref:
related: [WRK-073]
blocked_by: []
synced_to: []
---

# Build interactive NPV calculator for website lead generation

## What
Build a browser-based interactive NPV calculator as a lead magnet tool. Follow the pattern established by the existing fatigue-life and S-N curve calculators. Allows prospects to input field development parameters and get NPV/IRR estimates.

## Why
The existing fatigue calculators demonstrate the "try before you buy" pattern for engineering services. No equivalent exists for energy data services. An NPV calculator gives energy investors and operators a tangible way to experience the platform value.

## Acceptance Criteria
- [ ] HTML/JS calculator page in calculators/ directory
- [ ] Inputs: production profile, oil price, CAPEX, OPEX, discount rate, tax rate
- [ ] Outputs: NPV, IRR, MIRR, payback period, cashflow chart
- [ ] Interactive Plotly chart showing cumulative cashflow
- [ ] Matches existing calculator UI pattern (Bootstrap + marketing.css)
- [ ] No server required (client-side JS)
- [ ] Linked from energy.html calculators mention and engineering.html calculators section

## Plan

### Existing Calculator Pattern to Follow

The site has two fatigue calculators that establish the exact UI/UX pattern:

**Reference implementation**: `/mnt/local-analysis/workspace-hub/aceengineer-website/src/calculators/fatigue-sn-curve.html` (644 lines)

**Structure**:
1. Front matter: `---\nrootPath: "../"\n---`
2. Head: meta tags, OG, JSON-LD `WebApplication` schema, Plotly CDN include (`https://cdn.plot.ly/plotly-2.27.0.min.js`)
3. Inline CSS: calculator-card, form-group, btn-calculate (#e95420), result-card (dark gradient), chart-container, sn-info, disclaimer
4. Body layout: Bootstrap grid -- `col-md-5` for inputs, `col-md-7` for chart/results
5. Input pattern: `<select>` and `<input type="number">` with labels, `<small class="text-muted">` hints
6. Calculate button: `class="btn btn-calculate"` with `onclick="calculateFunction()"`
7. Results card: hidden by default (`style="display: none;"`), shown after calculation
8. Plotly chart: `<div id="chart-id" class="chart-container" style="height: 400px;">`
9. Formula reference section: calculator-card with equation display
10. Engineering disclaimer: yellow warning box
11. CTA: "Need Comprehensive Analysis?" linking to contact.html
12. Footer include + inline `<script>` with all calculation logic

**Calculator index page**: `/mnt/local-analysis/workspace-hub/aceengineer-website/src/calculators/index.html`
- Lists calculators as calculator-card divs with title, description, "Open Calculator" btn-primary link

### Phase 1: Create NPV Calculator HTML Page (4 hours)

1. **Create file**: `src/calculators/npv-field-development.html`
2. **Front matter**: `rootPath: "../"`
3. **JSON-LD**: WebApplication schema (following fatigue-sn-curve.html pattern)
   - applicationCategory: "Financial Engineering Calculator"
   - featureList: NPV, IRR, MIRR, payback period, cashflow visualization
4. **Input panel** (col-md-5):
   - **Production Profile Section**:
     - Initial production rate (bbl/day), number input, default 5000
     - Decline rate (%/year), number input, default 15
     - Production years, number input, default 20
   - **Economics Section**:
     - Oil price ($/bbl), number input, default 70
     - Price escalation (%/year), number input, default 2
   - **Cost Section**:
     - CAPEX ($M), number input, default 500
     - Annual OPEX ($M/year), number input, default 50
     - OPEX escalation (%/year), number input, default 3
   - **Financial Section**:
     - Discount rate (%), number input, default 10
     - Tax rate (%), number input, default 21
     - Royalty rate (%), number input, default 18.75 (standard GoM federal)
   - Calculate button: `class="btn btn-calculate" onclick="calculateNPV()"`

5. **Results panel** (col-md-7):
   - Result card (dark gradient like fatigue calculator):
     - NPV ($M) -- large result-value in green/red
     - IRR (%) -- computed via Newton's method in JS
     - Payback period (years)
     - Profit-to-Investment ratio
   - Plotly chart: cumulative cashflow curve (x=year, y=cumulative $M)
     - Revenue line (green), cost line (red), net cashflow (blue), cumulative (thick)
   - Sensitivity info box (like sn-info): explain key parameters

6. **Formula reference section**:
   - NPV = sum of DCF: CF_t / (1+r)^t
   - IRR definition: rate where NPV = 0
   - Decline curve: Q(t) = Q_0 * (1 - d)^t

7. **Disclaimer**: "This calculator is for screening purposes only. Actual field development economics require detailed reservoir modeling..."

8. **CTA**: "Need Detailed Field Development Economics?" linking to `contact.html?vertical=energy`

### Phase 2: JavaScript Calculation Engine (2 hours)

All logic in inline `<script>` at bottom of page (following existing pattern):

```javascript
function calculateNPV() {
  // 1. Read inputs
  // 2. Generate yearly production profile (exponential decline)
  // 3. Calculate yearly revenue = production * price * (1 - royalty)
  // 4. Calculate yearly cost = OPEX * (1 + escalation)^t
  // 5. Calculate yearly tax = max(0, (revenue - cost - depreciation) * tax_rate)
  // 6. Calculate yearly cashflow = revenue - cost - tax - capex(year 0)
  // 7. Discount cashflows: DCF_t = CF_t / (1 + r)^t
  // 8. NPV = sum(DCF)
  // 9. IRR via bisection method
  // 10. Payback period = first year cumulative > 0
  // 11. Update results display
  // 12. Update Plotly chart
}
```

Key calculations:
- **Decline curve**: Exponential `Q(t) = Q_initial * (1 - decline_rate)^t`
- **NPV**: Standard DCF summation
- **IRR**: Bisection method (search rate where NPV = 0, range -50% to 200%)
- **MIRR**: Finance rate = discount rate, reinvestment rate = discount rate
- **Payback**: First year where cumulative net cashflow turns positive

### Phase 3: Plotly Visualization (1 hour)

Create interactive Plotly chart showing:
- **Trace 1**: Annual gross revenue (bar chart, green)
- **Trace 2**: Annual total costs including tax (bar chart, red)
- **Trace 3**: Annual net cashflow (line, blue)
- **Trace 4**: Cumulative net cashflow (line, thick orange, secondary y-axis)
- **Layout**: Dark theme matching site aesthetic, responsive, hover tooltips with dollar formatting

### Phase 4: Update Calculator Index and Cross-Links (1 hour)

1. **Update calculator index**: Add NPV calculator entry to `src/calculators/index.html`
   - Follow existing calculator-card pattern with title, description, "Open Calculator" link
2. **Update energy.html**: Add mention of NPV calculator tool
   - File: `/mnt/local-analysis/workspace-hub/aceengineer-website/src/energy.html`
3. **Update sitemap.xml**: Add `calculators/npv-field-development.html`
4. **Rebuild**: `node build.js`

### File Paths Summary

New files:
- `aceengineer-website/src/calculators/npv-field-development.html`

Files to modify:
- `aceengineer-website/src/calculators/index.html` (add new calculator card)
- `aceengineer-website/src/energy.html` (add calculator mention)
- `aceengineer-website/sitemap.xml` (add URL)

### Dependencies and Prerequisites

- Plotly CDN already used by fatigue-sn-curve calculator (no new dependencies)
- No server-side code needed -- all client-side JavaScript
- Bootstrap 3.x grid system (col-md-5 / col-md-7 split)
- CSS follows existing calculator styles (no new CSS files needed)

### Test Strategy

- Manual browser testing: verify all input combinations produce valid results
- Edge cases: zero production, negative NPV, very high discount rate, zero CAPEX
- Cross-reference: compare NPV output against a known spreadsheet calculation
- Responsive: verify layout on mobile (Bootstrap responsive grid)
- Consider adding JS unit tests for the calculation functions as part of WRK-055

---
*Source: Gap analysis -- 2 fatigue calculators exist, zero energy data tools for lead generation*
