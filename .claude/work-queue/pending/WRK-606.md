---
id: WRK-606
title: "chore(doc-index): build standards transfer ledger — single source of truth for code porting"
status: pending
priority: high
complexity: medium
compound: false
created_at: 2026-02-25T00:00:00Z
target_repos:
  - workspace-hub
commit:
related:
  - WRK-309
  - WRK-482
  - WRK-602
  - WRK-603
  - WRK-604
  - WRK-605
computer: ace-linux-1
percent_complete: 0
---

# Standards Transfer Ledger — Single Source of Truth for Code Porting

## What

Build `data/document-index/standards-transfer-ledger.yaml` — a single, authoritative
registry that tracks every engineering standard from initial discovery through to
implementation, so no agent ever creates duplicate WRK items or re-ports already-done work.

Also write:
- `scripts/data/document-index/build-ledger.py` — seeds and refreshes the ledger
- `scripts/data/document-index/query-ledger.py` — CLI query tool

## Why

Currently, the state of code porting is scattered across:
- `data/document-index/enhancement-plan.yaml` (34K lines, 348 actionable gaps with doc_number)
- `specs/data-sources/*.yaml` (12 YAMLs, 538 standards, 530 reference / 6 gap / 2 implemented)
- WRK-482..559 (78 WRK items, 59 unique standards referenced)

An agent can't easily answer: "Has API RP 1111 been ported? If not, which WRK covers it?"
Without this ledger, duplicate WRK items and repeat porting are inevitable.

## Ledger Schema

```yaml
# data/document-index/standards-transfer-ledger.yaml
generated: '2026-02-25'
total: 348
summary:
  gap: 289          # located PDF, no WRK item yet
  wrk_captured: 59  # WRK item created, not yet implemented
  in_progress: 0    # WRK item in progress
  done: 2           # implemented and merged
  reference: 530    # reference only, no implementation planned

standards:
  - id: API-RP-1111
    title: "Design, Construction, Operation, and Maintenance of Offshore Hydrocarbon Pipelines"
    org: API
    domain: pipeline
    doc_path: /mnt/ace/docs/_standards/API/API RP 1111.PDF
    status: wrk_captured   # gap | wrk_captured | in_progress | done | deferred | reference
    wrk_id: WRK-564
    repo: digitalmodel
    modules: []            # filled when done: ["digitalmodel.pipeline.pressure_containment"]
    implemented_at: null   # ISO date when status→done
    notes: ""
```

## Status Flow

```
gap → wrk_captured → in_progress → done
                   ↘ deferred
reference (never flows to done — these are for reading only)
```

## Script: build-ledger.py

Sources, merged in priority order (later sources override status):
1. `enhancement-plan.yaml` — seeds all `gap` entries with doc_path + doc_number
2. `specs/data-sources/*.yaml` — upgrades status to `done`/`reference` for hand-curated entries
3. WRK items in `.claude/work-queue/` — upgrades status to `wrk_captured` or `done`
   (regex match on standard IDs; WRK done folder → `done`)

```bash
uv run --no-project python scripts/data/document-index/build-ledger.py
uv run --no-project python scripts/data/document-index/build-ledger.py --dry-run
```

## Script: query-ledger.py

```bash
# Show all pipeline gaps with no WRK item
python scripts/data/document-index/query-ledger.py --domain pipeline --status gap

# Show all done items
python scripts/data/document-index/query-ledger.py --status done

# Check a specific standard
python scripts/data/document-index/query-ledger.py --id "API-RP-1111"

# Show all standards linked to a repo
python scripts/data/document-index/query-ledger.py --repo digitalmodel
```

Output format: table with columns id | domain | status | wrk_id | doc_path

## Acceptance Criteria

- [ ] `data/document-index/standards-transfer-ledger.yaml` committed
  - Contains all 348 doc-number gap entries from enhancement-plan.yaml
  - Contains all 538 standards from specs/data-sources/*.yaml
  - Deduplicates by standard ID (same standard in multiple files → one entry)
  - `status` correctly reflects current WRK state (59 wrk_captured, 2 done, rest gap)
- [ ] `scripts/data/document-index/build-ledger.py` committed
  - Idempotent: re-running does not change already-`done` entries to `gap`
  - Preserves manually-set `modules`, `implemented_at`, `notes` fields
  - Outputs per-domain summary + total counts
- [ ] `scripts/data/document-index/query-ledger.py` committed
  - All 4 filter modes work: --domain, --status, --id, --repo
  - Default output: table sorted by domain then id
- [ ] Legal scan passes on committed ledger content

## Remaining Gaps After Ledger Built (expected ~289)

### Pipeline (top priority for digitalmodel + doris)
- DNV-OS-F101 (submarine pipeline)
- DNV-OS-F201 (dynamic risers)
- ISO 13628 pts 7/12 (completion/workover risers, dynamic risers)
- ISO 13624-1 (drilling risers)
- ISO 16389 (dynamic risers)
- ISO 16708-1 (pipeline reliability)

### Structural (digitalmodel + OGManufacturing)
- API RP 2A-WSD (fixed offshore platforms)
- ASTM E1049 (cycle counting — critical for fatigue module)
- ASTM E606 (strain-controlled fatigue)

### Cathodic Protection (digitalmodel)
- API RP 1632 (underground pipeline CP)
- ISO 15156 (cracking-resistant alloys)
- ISO 15589-2 (pipeline CP)
- DNV RP F106 (external pipeline coatings)

### Marine / Mooring (digitalmodel)
- DNV OS E301 (position mooring)
- API RP 2I (in-service mooring inspection)
- API RP 2P / 2SM (spread mooring / synthetic moorings)

## Notes

- Ledger is committed to workspace-hub (not gitignored) — it is a curated registry
- `doc_path` values point to physical drive paths — not committed file contents
- When any WRK implementing a standard is completed, manually update:
  `status: done`, `modules: [...]`, `implemented_at: YYYY-MM-DD`
- Long-term: add a pre-commit hook that warns if a WRK closes without updating the ledger
