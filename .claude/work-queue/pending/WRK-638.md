---
id: WRK-638
title: "feat(memory): ecosystem-catalog.yaml — machine-readable destination map for curate-memory.py"
status: pending
priority: high
complexity: small
compound: false
created_at: 2026-02-27T00:00:00Z
target_repos:
  - workspace-hub
commit:
spec_ref:
related:
  - WRK-637
  - WRK-635
blocked_by:
  - WRK-637
parent:
synced_to: []
plan_reviewed: false
plan_approved: false
percent_complete: 0
brochure_status: n/a
computer: [ace-linux-1]
execution_workstations: [ace-linux-1]
plan_workstations: [ace-linux-1]
provider: claude
---

# feat(memory): Ecosystem Catalog — Machine-Readable Destination Map

## Problem

Phase 3c (`curate-memory.py`) classifies memory bullets and proposes target paths
across the full ecosystem. But without a catalog of what already exists, it will:
- Propose duplicate skills that already exist under different names
- Miss the canonical path for existing domain doc dirs
- Create new rule files for content that should append to existing ones

The ecosystem has 300+ skills, 6 rule files, 30+ docs, 10+ domain doc trees — all
of which are valid promotion targets. `curate-memory.py` needs a lookup table.

## What

**`scripts/memory/build-ecosystem-catalog.py`** — generates
**`specs/ecosystem-catalog.yaml`** by scanning the workspace.

### Catalog structure

```yaml
# specs/ecosystem-catalog.yaml — AUTO-GENERATED, do not edit manually
# Updated: <ISO8601 timestamp>
# Generator: scripts/memory/build-ecosystem-catalog.py

skills:
  - path: .claude/skills/engineering/marine-offshore/cathodic-protection/SKILL.md
    category: engineering/marine-offshore
    name: cathodic-protection
    description: <first line of SKILL.md description field>
  # ... all ~300 skills

rules:
  - path: .claude/rules/coding-style.md
    sections: [Naming Conventions, Size Limits, Import Organization, ...]
  - path: .claude/rules/testing.md
    sections: [TDD, Coverage, Test Quality, ...]
  # ... all 6 rule files with section headers extracted

docs:
  - path: .claude/docs/orchestrator-pattern.md
    topic: orchestrator-pattern
  # ... all docs

domain_doc_dirs:
  # Existing <repo>/docs/domains/<domain>/ directories
  - repo: digitalmodel
    domain: cathodic_protection
    path: digitalmodel/docs/domains/cathodic_protection/
  - repo: digitalmodel
    domain: hydrodynamics
    path: digitalmodel/docs/domains/hydrodynamics/
  # ...

specs_modules_dirs:
  # Existing specs/modules/ entries per repo
  - repo: digitalmodel
    path: specs/modules/digitalmodel/
  # ...

config_dirs:
  # Existing config/<domain>/ directories
  - path: config/analysis/cost_data/
    domain: cost_data
  # ...
```

### Generator script (`scripts/memory/build-ecosystem-catalog.py`)

```python
# Build ecosystem catalog for curate-memory.py destination lookup
# Run: python3 scripts/memory/build-ecosystem-catalog.py
# Output: specs/ecosystem-catalog.yaml
```

Scans:
- All `SKILL.md` files under `.claude/skills/` (excluding `_archive/`, `_diverged/`)
- All `.md` files under `.claude/rules/` (extract section headings)
- All `.md` files under `.claude/docs/`
- All `docs/domains/` dirs under each submodule
- All `config/` subdirs under each submodule
- All `specs/modules/` entries

**Exclusions:** `_archive/`, `_diverged/`, `incoming/` — these are not valid
promotion targets until explicitly promoted.

### Usage by curate-memory.py

```python
import yaml
catalog = yaml.safe_load(open('specs/ecosystem-catalog.yaml'))

# Find existing skill for a candidate
def find_skill(keywords):
    return [s for s in catalog['skills']
            if any(k in s['name'] or k in s['category'] for k in keywords)]

# Find existing rule file that covers a topic
def find_rule_section(topic):
    return [r for r in catalog['rules']
            if any(topic in sec.lower() for sec in r['sections'])]
```

### Refresh trigger

Regenerate catalog as part of Phase 3c setup:
```bash
python3 scripts/memory/build-ecosystem-catalog.py
# If catalog is > 7 days old, regenerate before curate-memory.py runs
```

## Acceptance Criteria

- [ ] `build-ecosystem-catalog.py` generates valid YAML without errors
- [ ] Catalog includes all non-archived skills (count ≥ 250)
- [ ] Catalog includes all 6 rule files with section headers
- [ ] Catalog includes domain doc dirs from digitalmodel, worldenergydata at minimum
- [ ] `curate-memory.py` imports and uses catalog for path proposals
- [ ] Duplicate detection: if candidate matches existing skill name ≥ 80%, propose
      "extend: <existing path>" not "create: <new path>"
- [ ] Catalog file excluded from legal scan (no content, only paths)

## Notes

- This is a READ-ONLY scan tool — no files are modified
- `_diverged/` skills are intentionally excluded — they are candidates for cleanup,
  not promotion targets (separate WRK-639 to audit diverged skills)
- Catalog is committed to git so it can be diffed to track ecosystem growth
- File size expected: ~50-100 KB YAML — acceptable to commit
