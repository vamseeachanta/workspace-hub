---
id: WRK-213
title: 'Codex multi-agent roles — assess native role system vs workspace-hub agent skill approach'
status: archived
priority: medium
complexity: medium
compound: false
created_at: 2026-02-19T00:00:00Z
target_repos:
  - workspace-hub
module: automation
tags:
  - codex
  - agent-teams
  - multi-agent
  - skills
  - interoperability
related:
  - WRK-212
blocked_by: []
synced_to: []
provider: claude
spec_ref: ''
plan_reviewed: true
plan_approved: true
percent_complete: 100
brochure_status: n/a
---
# WRK-213: Codex Multi-Agent Roles — Assessment and Integration

## What

Codex 0.102.0 shipped native multi-agent role configuration via
`.codex/config.toml` + `agents/role_config.toml` files. Assess how this maps
to workspace-hub's existing agent skill approach (WRK-212), and determine
what should be adopted natively vs kept as workspace-specific skill files.

## Context

From @LLMJunky's "Codex Multi-Agent Playbook Part 1" (2026-02-19, 70K views):

- **Three built-in roles**: `default`, `explorer`, `worker`
- **Custom roles**: `.codex/config.toml` + per-agent `agents/role_config.toml`
  — model, reasoning level, system prompt, permissions, MCP servers
- **Hierarchical scope**: project vs global (mirrors AGENTS.md pattern)
- **Default cap**: 6 parallel agents; configurable to `max_threads = 12`+
- **Skills ↔ subagents**: callable from each other (bidirectional)
- **25 pre-built roles**: github.com/am-will/codex-skills/tree/main/agents

**Key insight**: What workspace-hub builds manually (agent `.md` files + spawn
prompts) is now natively supported in Codex via TOML config. The Claude Code
equivalent is the agent-teams skill (WRK-212). The two ecosystems are
converging on the same architectural pattern.

## Questions to answer

1. **TOML roles vs skill index routing — what's the difference?**
   Claude Code routes via skill index (`.claude/skills/**/SKILL.md` + frontmatter
   `invoke:` field) — declarative markdown loaded at session start. Codex TOML
   roles (`.codex/config.toml`) are imperative config: model selection, reasoning
   level, system prompt, permissions, MCP servers — closer to agent *constructor*
   parameters than skill *content*. Are these the same concept at different layers,
   or genuinely different? Where does one end and the other begin?

2. **Can Codex and Claude use these interchangeably?**
   Workspace-hub already symlinks `.codex/skills` → `.claude/skills` (WRK-198-202)
   so skill *content* is shared. But Codex TOML role config has no Claude Code
   equivalent — Claude Code agents are configured via spawn prompt + `subagent_type`,
   not a config file. Can the TOML role definitions be written so that Codex and
   Claude Code agents behave equivalently when given the same task? Or are they
   fundamentally different execution models that only share skill content?

3. Are the 25 pre-built Codex roles worth importing as workspace-hub skills
   (or linking as `canonical_ref:` in `_diverged/`)?
4. Does `.codex/config.toml` `max_threads = 12` affect how we think about
   MAX_TEAMMATES=3 in Claude Code? (Different systems — don't conflate)
5. Should workspace-hub's `.codex/skills` symlinks (WRK-198-202) reference
   these new Codex role configs, or are they separate?
6. Is there a `CODEX.md` equivalent pattern to document Codex-side agent
   roles for the workspace?

## Research Finding — TOML roles vs skill index (2026-02-19)

They solve the same problem at different layers:

### Claude skills (OpenClaw pattern)
- Routing is **semantic** — LLM reads skill descriptions, picks the right one based on intent
- Skills = instruction sets (markdown telling the agent *what to do*)
- Single agent loads the skill into context, executes sequentially
- No per-skill model or permission boundaries

### Codex TOML roles
- Routing is **explicit** — orchestrator spawns specific named roles programmatically
- Roles = full agent specs (model + permissions + tools + system prompt + MCP servers)
- Designed for **parallel** execution (multiple agents running simultaneously)
- Each role can have a different model, different sandbox, different tool access

### Core difference
> Claude skills extend *what one agent knows*.
> Codex roles define *who gets spawned for what task* — more like a hiring org chart than a knowledge base.

### Interchangeable? Partially.
- The **mental model** transfers completely — define specialisations, route tasks to the right one
- The **files** don't — TOML configs won't run in Claude Code and vice versa
- Where they **meet**: MCP servers. Both Codex and Claude support MCP, so a shared MCP tool layer is the common substrate

### Implication for workspace-hub
The 700+ module skill library is already the "role definition" content layer. The question is
only whether the routing layer is a markdown `invoke:` field, a TOML role name, or an MCP call.
The domain logic (skill content) doesn't care — which is why `.codex/skills → .claude/skills`
symlinks already work and should continue to be the pattern (WRK-198-202).

**Practical decision**: Keep skill *content* shared (symlinks). Maintain routing *config*
separately per provider (TOML for Codex, skill frontmatter for Claude). MCP is the bridge
for tooling that must work in both.

## Research Finding — Orchestrator Context Separation (2026-02-19)

**Trigger**: `/clear` in the same prompt layer wiped orchestrator context → agent returned blank output
instead of asking a clarifying question. Root cause: `/clear` on CLI agents doesn't just clear history —
it can reset tool state and workspace context entirely. The orchestrator "woke up" with no grounding
and froze rather than recovering.

**Principle**:
> The orchestrator's context is sacred — it's the working memory that makes everything coherent.
> Letting a `/clear` command nuke it from the same prompt layer is a design flaw, not a feature.

**Architecture implication**:
- **Prompt layer** = user ↔ orchestrator only; no system commands here
- **Control plane** = system commands (`/clear`, `/reset`, session lifecycle) routed to subagents
  or a separate control layer that the orchestrator never touches directly
- **Result**: The orchestrator never forgets who it is or where it is; user always has a coherent
  working memory to talk to

**Mapping to workspace-hub**:
- Claude Code's `task_agents:` spawn pattern already embodies this — subagents are ephemeral,
  orchestrator (main session) persists
- Gap: `/clear` issued in the main session still kills orchestrator state; need a convention
  (or hook) that prevents `/clear` from being used mid-session in orchestrator context
- Codex TOML roles reinforce this — orchestrator role vs worker roles are explicitly separated
  at config level, not just by convention

*Source: Narada/Vamsee conversation, 2026-02-19; user insight: "prompt layer should be reserved
for user and any other command should be for subagents away from orchestrator"*

## Acceptance Criteria

- [ ] Assess 25 pre-built Codex roles — identify any worth adopting
- [ ] Document Codex role config approach in `.codex/CODEX.md` (already exists)
- [ ] Determine if workspace-hub needs a Codex-side agent skill that mirrors
      the Claude Code `agent-teams` skill
- [ ] Update WRK-212 if Codex native roles reduce what Claude Code needs to handle

## Plan

Route A — research + doc updates only. User approved 2026-02-19.
No cross-review required unless adopting Codex roles changes shared config.

**Sequence**:
1. Fetch and review the 25 pre-built Codex roles from the GitHub pack
2. Map each role to existing workspace-hub skills — identify overlaps and gaps
3. Update `.codex/CODEX.md` with role config approach and interoperability notes
4. Update WRK-212 `agent-teams` skill if Codex native roles change what Claude side needs

## Execution Brief

### Provider
- **Executor**: Gemini — research task (fetch + summarise external content, assess fit)
- **Alt**: Claude Sonnet — if Gemini unavailable or GitHub fetch fails

### Task for Executor

Research task. Fetch and assess the Codex multi-agent role system introduced
in Codex 0.102.0. Do NOT write any code or modify scripts.

**Step 1 — Fetch Codex role documentation**:
Review the Codex CLI docs on custom agent roles (`.codex/config.toml`,
`agents/role_config.toml` format). Summarise the config schema.

**Step 2 — Review 25 pre-built roles** (if accessible):
GitHub pack: `github.com/am-will/codex-skills/tree/main/agents`
For each role category, note: purpose, model, permissions, MCP servers.
Flag any that overlap with existing workspace-hub skills.

**Step 3 — Map to workspace-hub**:
For each pre-built role, map to the nearest workspace-hub equivalent:
- Exists as skill → note the skill path
- Partially covered → note the gap
- No equivalent → flag as candidate for adoption

**Step 4 — Write findings to WRK-213**:
Add a `## Role Assessment` section with the mapping table.
Add recommendations: adopt / adapt / skip for each role category.

**Step 5 — Update `.codex/CODEX.md`**:
Add a `## Multi-Agent Roles` section documenting the config approach
and noting which workspace-hub skills serve as the content layer.

### Done When
- [ ] `## Role Assessment` section added to WRK-213 with mapping table
- [ ] `.codex/CODEX.md` updated with role config documentation
- [ ] At least 3 concrete adopt/skip decisions documented with rationale

### For User Review
- The mapping table in WRK-213 — does it match your understanding of the roles?
- Any pre-built roles worth adopting immediately vs deferring?

*Source: @LLMJunky Codex Multi-Agent Playbook Part 1, shared 2026-02-19*
