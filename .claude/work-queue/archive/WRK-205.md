---
id: WRK-205
title: Skills knowledge graph — capability metadata and relationship layer beyond flat index
status: archived
priority: medium
complexity: medium
compound: false
created_at: 2026-02-18T00:00:00Z
target_repos:
  - workspace-hub
commit: 234fefa,c66aeea,e7556e3,e31795d
spec_ref: specs/wrk/WRK-205/step1-schema.md
related:
  - WRK-187
  - WRK-215
blocked_by: []
synced_to: []
plan_reviewed: true
plan_approved: true
plan_review_iter: P2-PASS
percent_complete: 100
brochure_status: n/a
tags:
  - skills
  - knowledge-management
  - context-engineering
plan_workstations: [ace-linux-1]
execution_workstations: [ace-linux-1]
---
# Skills knowledge graph — capability metadata and relationship layer beyond flat index

## What

With 468 skills across 16 domains and a 34KB README index, the current flat-index approach
scales linearly with size. Add a lightweight relationship and capability metadata layer to
enable semantic discovery and tiered/dynamic loading without requiring a full graph database.

## Why

Triggered by review of ArsContexta and DeepIQ industrial knowledge graph whitepaper patterns.
Key insight: taxonomy (what we have) + ontology (relationships) + KG instantiation = full
discoverability. The current index must be fully loaded to find anything; relationships and
capability tags would allow just-in-time loading of only the relevant subset.

Known pain points:
- 34KB README index is expensive to include in context for every session
- No way to ask "which skills compose into a drilling-analysis workflow?"
- No dependency or conflict relationships between skills
- 115 diverged skills have no canonical linkage back to hub versions

## Acceptance Criteria

- [ ] Each SKILL.md gains a structured `capabilities:`, `requires:`, and `see_also:` frontmatter block — **all 468 skills** get at minimum an empty skeleton; top 3 domains (engineering, data, development) get hand-reviewed content
- [ ] A `SKILLS_GRAPH.yaml` or `skills-map.json` at `.claude/skills/` root encodes cross-skill relationships (composes, alternatives, requires)
- [ ] Category-level sub-indexes created (e.g., `engineering/INDEX.md`) so only the relevant slice need be loaded
- [ ] Main README becomes a meta-index of sub-indexes (reduces load-time for 80% of sessions)
- [ ] `_diverged/` skills include a `canonical_ref:` field pointing to hub version

## References

- ArsContexta: https://github.com/agenticnotetaking/arscontexta (second-brain knowledge systems from conversation)
- DeepIQ whitepaper: https://deepiq.com/whitepaper/on-the-design-of-robust-industrial-knowledge-graphs-key-recommendations/
- Context engineering pattern: file-system-as-memory, just-in-time skill loading
- muratcankoylan/Agent-Skills-for-Context-Engineering: capability metadata approach

## Cross-Review Log

| Iter | Date | Reviewer | Verdict | Key Findings | Resolution |
|------|------|----------|---------|--------------|------------|
| P1 | 2026-02-19 | Claude Opus | MINOR | Dual-write (block): frontmatter vs graph; sequencing; missing validation; missing rollback | Plan revised — see below |
| P1 | 2026-02-19 | Codex | **MAJOR** | Coverage gap (146 vs 468); sequence inversion (graph before frontmatter); 16-vs-12 domain mapping undefined; schema underspecified | Plan revised — see below |
| P1 | 2026-02-19 | Gemini | APPROVE | Coverage, sequencing, README truncation risk, missing validation | Incorporated into revision |

**P1 overall: FAIL** (Codex MAJOR = hard block). Plan revised below. Requires new user approval + re-review.

| P2 | 2026-02-19 | Claude Opus | MINOR | Agent parallelism unsafe (B must wait on A's Step 1); capabilities: needs controlled vocab list before hand-authoring | Noted in executor brief |
| P2 | 2026-02-19 | Codex-role | MINOR | Step 2 must assert file count before commit; capabilities: free-text-for-now must be documented explicitly; see_also: semantic disambiguation needed | Noted in executor brief |
| P2 | 2026-02-19 | Gemini | APPROVE | Step 4 graph gen should log broken requires:/see_also: references | Noted in executor brief |

**P2 overall: PASS** — no MAJORs. User-approved. Ready for execution.

**Executor brief addenda (from P2 caveats):**
- Agent B is blocked on Agent A Step 1 completion — sequential handoff, not parallel launch
- Step 1 must emit a short `capabilities:` tag vocabulary (free-text-for-now, but document that enforcement is deferred to WRK-215)
- Step 2 must assert SKILL.md count (e.g., `find .claude/skills -name SKILL.md | wc -l`) before committing
- Step 4 graph generation script must log (not fail) broken `requires:`/`see_also:` references
- Step 4 must document that frontmatter `see_also:` maps directly to graph edge type `see_also`

## Plan (v2 — revised after P1 cross-review)

Route B — inline plan. **Approved. P2 passed. Ready for execution.**

### Principles established by cross-review

- **Single source of truth**: SKILL.md frontmatter is canonical for relationships. `SKILLS_GRAPH.yaml` is a **generated artifact** (derived from frontmatter by build script), not hand-curated.
- **Correct sequence**: frontmatter → graph (derived) → indexes → README
- **Full coverage**: all 468 skills get a frontmatter skeleton; no partial coverage
- **Execute on feature branch** with checkpoint commits for rollback

### Domain/category mapping (addresses Codex P1-3)

16 domains in the filesystem → 12 category indexes. Mapping:

| Category INDEX | Domains included |
|---------------|-----------------|
| engineering | marine-offshore, structural, mechanical |
| data | data-science, analytics, databases |
| development | backend, frontend, devops |
| coordination | workspace, project-management |
| ai | llm, agents, ml |
| *(remaining 7 mapped 1:1)* | ... |

Full mapping to be defined in Step 1 before any scripting.

### Revised sequence

**Step 1 — Schema definition** (no files touched yet)
- Define frontmatter schema: `capabilities: []`, `requires: []`, `see_also: []` key types + allowed values
- Define graph edge schema: `{from, to, type: composes|requires|alternatives|see_also}`
- Define 16-domain → 12-category mapping explicitly
- Define `canonical_ref:` matching rules for `_diverged/` (name-based, fallback: flag as unmatched)

**Step 2 — Frontmatter skeleton on ALL 468 skills** (scripted)
- Script: scan all SKILL.md, add empty `capabilities: []`, `requires: []`, `see_also: []` if not present
- Hand-author: workspace-hub cluster (10 skills) — full content
- Script-enrich: engineering (66), data (~40), development (~30) — populate from existing `tags:` and `related_skills:` where mappable
- Commit: `feat(skills): add metadata skeleton to all 468 SKILL.md files`

**Step 3 — `_diverged/` canonical_ref:** (scripted, all 115 files)
- Match each diverged skill by name to hub canonical path
- Flag unmatched (no canonical match) — do not guess
- Commit: `feat(skills): add canonical_ref to 115 _diverged/ skills`

**Step 4 — Generate `SKILLS_GRAPH.yaml`** (script-derived from frontmatter)
- Script reads all `see_also:` and `requires:` frontmatter, emits typed edges
- Adds known workspace-hub cluster edges (hand-verified from session work)
- Output: `.claude/skills/SKILLS_GRAPH.yaml`
- Commit: `feat(skills): generate SKILLS_GRAPH.yaml from frontmatter`

**Step 5 — Per-category `INDEX.md`** (12 files, scripted from frontmatter)
- Now runs AFTER frontmatter is populated — indexes reflect real metadata
- Script: for each category, emit name + description + tags per skill
- Commit: `feat(skills): add 12 category INDEX.md files`

**Step 6 — README → meta-index** (~50 lines)
- Only after all category INDEX.md files are complete and verified
- Points to each category INDEX.md; eliminates 34KB full-load cost
- Preserves any organizational context not in frontmatter as inline notes
- Commit: `feat(skills): README becomes meta-index, eliminating 34KB context cost`

**Step 7 — Validation** (post-implementation gate)
- YAML lint all modified SKILL.md frontmatter
- Verify every graph edge in SKILLS_GRAPH.yaml points to an existing skill path
- Verify all `canonical_ref:` paths exist (flag broken refs, don't fail)
- Verify all README meta-index links resolve to existing INDEX.md files
- Run `generate-index.py` — must exit 0

### Agent team

2 parallel agents (within MAX_TEAMMATES=3):
- **Agent A**: Steps 1 + 6 (schema definition + README — hub-level structural files)
- **Agent B**: Steps 2 + 3 + 5 (bulk scripted operations across skill files)
- Step 4 (graph generation): Agent B runs after Step 2 completes
- Step 7 (validation): sequential after both agents complete

## Execution Brief

### Provider
- **Executor**: Claude Sonnet (orchestrator) + 2-agent team (Bash agents for bulk ops)
- **Alt**: Codex for Steps 2/3/5 scripting if Sonnet quota constrained

### Task for Executor
Execute revised plan v2 on a feature branch. Follow Step 1 → 7 in sequence.
Do not skip validation (Step 7). Commit at each step boundary.

### Done When
- [ ] All 468 SKILL.md have `capabilities:`, `requires:`, `see_also:` keys
- [ ] `SKILLS_GRAPH.yaml` exists and all edges point to valid paths
- [ ] 12 category INDEX.md files exist under their domains
- [ ] README.md is ~50 lines pointing to category indexes
- [ ] 115 `_diverged/` skills have `canonical_ref:` (unmatched flagged, not missing)
- [ ] Validation step exits 0

### For User Review
- Step 1 schema definition — review the 16→12 domain mapping before scripting begins
- Step 7 validation report — any broken canonical_ref paths need manual triage

---
*Source: User asked to assess whether skills need managing beyond flat index, triggered by arscontexta tweet + DeepIQ KG whitepaper*
