---
id: WRK-074
title: Complete marine safety database importers (MAIB, IMO, EMSA, TSB)
status: archived
priority: high
complexity: complex
compound: false
created_at: 2026-02-02T14:00:00Z
target_repos:
  - worldenergydata
commit:
spec_ref:
related: [WRK-073]
blocked_by: []
synced_to: []
plan_workstations: [ace-linux-1]
execution_workstations: [ace-linux-1]
---
# Complete marine safety database importers (MAIB, IMO, EMSA, TSB)

## What
Finish the marine safety importers that are currently stubs. Working scrapers exist for USCG, NTSB, ATSB. The MAIB, IMO, EMSA, TSB, MISLE, Boating, and NOAA importers need to be completed with actual data collection logic to back the website's "10+ authorities" claim.

## Why
The aceengineer website now markets "10+ international safety databases integrated." Currently only 3-5 are functional. This creates a trust risk if prospects ask for a demo or deliverable.

## Acceptance Criteria
- [ ] MAIB importer collects UK marine accident investigation data
- [ ] IMO importer collects GISIS incident data
- [ ] EMSA importer collects European maritime safety data
- [ ] TSB importer collects Canadian transportation safety data
- [ ] Each importer has tests with real sample data
- [ ] All importers write to the unified marine_safety database schema
- [ ] At least 8 of 10+ claimed sources are functional

## Plan

**Target**: `src/worldenergydata/marine_safety/importers/`

### Current State (from research)
- **9/10 importers exist** as files in `marine_safety/importers/`
- **Working scrapers**: USCG (NTSB format), NTSB, ATSB — these collect real data
- **Substantial implementations (mischaracterized as stubs)**: MAIB (575 lines), TSB (533 lines), IMO (660 lines), EMSA (852 lines) — these have full type mappings, CSV parsing, and database integration. Actual gap is data availability and end-to-end validation, not code writing.
- **Remaining stubs**: Boating, NOAA, MISLE
- **Unified schema**: All importers write to `MarineIncident` dataclass (standardized fields)
- **Correlation engine**: `marine_safety/analysis/correlation/matcher.py` and `deduplicator.py` with fuzzy matching across sources
- **Total incidents in DB**: ~290K+ across working sources
- **Database**: SQLite via `marine_safety/database/` module

### Phase 1 — MAIB Validation (UK) — existing importer: 575 lines
- **Re-scoped**: Validate existing importer against real data, not build from scratch
- **Source**: MAIB publishes investigation reports and annual reports at gov.uk
- **Method**: Obtain sample MAIB data files. Run existing importer end-to-end. Fix parsing errors.
- **Fields**: Vessel name, type, flag, date, location, casualties, investigation outcome
- **Target**: ~2,000 reports (1989-present)
- **Tests**: Parse sample MAIB report, validate schema mapping, use recorded HTML/PDF fixtures for non-brittle tests

### Phase 2 — TSB Validation (Canada) — existing importer: 533 lines
- **Re-scoped**: Validate existing importer against real data, not build from scratch
- **Source**: TSB Marine occurrence database (publicly searchable, paginated results)
- **Method**: Obtain sample TSB data. Run existing importer end-to-end. Fix parsing errors.
- **Fields**: Occurrence number, date, location, vessel, event type, fatalities
- **Target**: ~5,000 marine occurrences (1990-present)
- **Tests**: Parse sample TSB occurrence page, validate schema mapping

### Phase 3 — IMO GISIS Validation — existing importer: 660 lines
- **Re-scoped**: Validate existing importer against real data
- **Source**: IMO Global Integrated Shipping Information System
- **Method**: GISIS has public casualty data; may need session-based access
- **Fields**: IMO number, vessel name, flag, incident type, date, location
- **Constraint**: IMO may require registration — document access requirements
- **Fallback**: If institutional access not obtainable within 2 weeks, pivot to parsing published IMO annual reports (PDF) for tabular incident data
- **Tests**: Parse sample GISIS data format, validate schema mapping

### Phase 4 — EMSA EMCIP Validation — existing importer: 852 lines
- **Re-scoped**: Validate existing importer against real data
- **Source**: European Maritime Casualty Information Platform
- **Method**: EMSA publishes annual overview reports + EMCIP database access
- **Fields**: Vessel type, flag, incident category, severity, location (EU waters)
- **Constraint**: EMCIP access may require institutional registration
- **Fallback**: If institutional access not obtainable within 2 weeks, pivot to parsing published EMSA annual overview reports for tabular incident data
- **Tests**: Parse sample EMCIP data, validate schema mapping

### Phase 5 — Complete Remaining Stubs
- **MISLE**: Depends on WRK-069 (manual download of USCG MISLE_DATA.zip)
- **Boating**: USCG Boating Accident Report Database (BARD)
- **NOAA**: Storm/weather-related marine incidents from NOAA Storm Events Database

### Phase 6 — Integration & Validation
- Run correlation engine across all sources (fuzzy match on date + vessel + location)
- Verify unified schema compliance for all new importers
- Update data catalog with record counts and date ranges per source
- Target: 8/10+ claimed sources functional

### Data Access Constraints
- MAIB, TSB: publicly accessible, scripting allowed
- IMO GISIS: may block automated access (HTTP 403) — document manual fallback
- EMSA EMCIP: institutional access may be required — document process
- All importers must handle HTTP errors gracefully, implement retry with backoff

### Tests Per Importer
- Parse test with real sample data (1-2 records)
- Schema validation test (all required MarineIncident fields populated)
- Error handling test (HTTP timeout, malformed response)
- Integration test: insert into SQLite, verify queryable

### Review Notes
- **Verdict**: Claude: MINOR | Codex: MAJOR | Gemini: APPROVE
- **Actions taken**:
  - Critical re-scope: MAIB/TSB/IMO/EMSA importers are NOT stubs — they are 500-850 line implementations. Phases 1-4 changed from "build" to "validate against real data"
  - Fixed correlation engine path from `cross_reference/correlation_engine.py` to `marine_safety/analysis/correlation/matcher.py`
  - Added fallback plans for IMO/EMSA: parse published annual reports if institutional access not obtainable within 2 weeks
  - Codex additionally requested rate-limiting/robots.txt compliance checks and recorded test fixtures — partial overlap with existing retry/backoff requirement
  - All 10 importer files are present on disk (atsb, boating, emsa, imo, maib, misle, noaa, ntsb, tsb + base)
- *Cross-reviewed: 2026-02-09*

*Approved by user: 2026-02-09*

---
*Source: Gap analysis — website markets 10+ safety authorities but only 3-5 scrapers are functional*
