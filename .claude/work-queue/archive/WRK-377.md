---
id: WRK-377
title: "ROP prediction model — Bourgoyne-Young and Warren in digitalmodel"
status: archived
completed_at: 2026-02-24T14:45:00Z
priority: high
complexity: medium
compound: false
created_at: 2026-02-24T13:00:00Z
target_repos:
  - digitalmodel
commit: 0818170f0
spec_ref:
related: [WRK-375, WRK-376, WRK-379]
blocked_by: []
synced_to: []
plan_ensemble: false
ensemble_consensus_score: null
plan_reviewed: false
plan_approved: true
percent_complete: 100
brochure_status: pending
computer: ace-linux-1
---

# ROP Prediction Model — Bourgoyne-Young and Warren

## What

Implement Rate of Penetration (ROP) prediction models in `digitalmodel` at
`src/digitalmodel/well/drilling/rop_models.py`:

1. **Bourgoyne-Young model** (eight-parameter, industry standard): formation-dependent ROP
   as a function of WOB, RPM, bit diameter, ECD, overbalance, compaction, bit wear, and
   formation abrasiveness coefficients (a1–a8)
2. **Warren model** (simplified two-parameter): `ROP = K * (WOB/d_bit)^a * RPM^b` for
   clean formations — fast to calibrate, good for virtual environments

Both models accept formation coefficients calibrated from offset well data and return
predicted ROP (ft/hr) with uncertainty bounds.

## Why

ROP prediction is the core decision input for any drilling controller — without it, no
parameter optimisation (WOB/RPM) is possible. It is also the primary scoring metric in
the SPE Drillbotics Mode V virtual track (WRK-375). Standalone value: every client well
project that involves drilling performance analysis benefits from a calibrated ROP model.

This is the H1 foundation for both the Drillbotics capability path and the autonomous
drilling workflow described in `docs/vision/VISION.md`.

## Acceptance Criteria

- [x] `digitalmodel/src/digitalmodel/well/drilling/rop_models.py` created
- [x] `BourgoineYoungROP` class: 8-parameter model, accepts coefficients as constructor args
- [x] `WarrenROP` class: 2-parameter model, fits K/a/b from historical WOB-RPM-ROP data
- [x] Both classes expose `.predict(wob_klb, rpm, ...) -> RopPrediction` interface
- [x] `fit_from_data(wob_klb, rpm, bit_dia_in, rop_ft_hr)` classmethod on WarrenROP
- [x] 31 unit tests — physics behaviour, edge cases, log-linear regression recovery, all input guards
- [x] Exported from `digitalmodel.well.drilling` and `digitalmodel.well` package

## Agentic AI Horizon

- ROP model is the "brain" of an autonomous drilling controller: sense formation → predict
  ROP for candidate WOB/RPM sets → select optimal parameters → act
- Once implemented, agents can reason about drilling efficiency without human translation
- Enables automated design-space exploration: sweep WOB × RPM grid, plot efficiency surface

## Implementation Notes

- Commits: f23bc43da (implementation) + 0818170f0 (guard fixes from review)
- git commit hung repeatedly due to large pack files (4.2 GB + 2.88 GB) in digitalmodel;
  worked around with git plumbing (write-tree / commit-tree / update-ref)
- Cross-review status: Codex hit daily quota (reset 2:04 PM same day); manual review
  found 2 P3 guards missing — both fixed before archival; Gemini timed out (>40 min)
- f8 jet impact: implemented as constant exp(a8); full SPE Vol 2 Fj dependence deferred
  to WRK-37x (minor, acknowledged in code comment)

---
*Source: WRK-375 Drillbotics gap analysis — critical H1 gap, standalone client value*

## Session Handoff — 2026-02-24

**Status at exit:** Implementation refined, validation added, and verified with 31 unit tests.
**Percent complete:** 100%

### Work Done This Session
- Refined `BourgoineYoungROP` and `WarrenROP` models with robust input validation.
- Added validation for `bit_dia_in` and `rpm` to prevent division by zero or non-physical states.
- Expanded unit test suite from 29 to 31 tests to cover new validation logic.
- Verified all 31 unit tests pass in `digitalmodel` repository.

### Files Modified
- `digitalmodel/src/digitalmodel/well/drilling/rop_models.py`
- `digitalmodel/tests/unit/well/drilling/test_rop_models.py`

### What Remains
- Move `WRK-377.md` from `archive/` to `done/` directory in the work queue.
- Finalize and commit changes in the `digitalmodel` repository.

### Commit Command
```bash
cd digitalmodel
git add src/digitalmodel/well/drilling/rop_models.py tests/unit/well/drilling/test_rop_models.py
git commit -m "feat(rop-models): implement Bourgoyne-Young and Warren ROP models with validation and tests (WRK-377)"
```

### Resume Notes
The implementation is solid and verified. Ensure any future integrations (like WRK-375) handle the `ValueError` exceptions raised by the validation logic if input data is noisy or invalid.
