---
id: WRK-086
title: Rewrite CI workflows for Python/bash workspace
status: archived
priority: medium
complexity: medium
compound: false
created_at: 2026-02-03T13:30:00Z
target_repos:
  - workspace-hub
plan_workstations: [ace-linux-1]
execution_workstations: [ace-linux-1]
---
## Description

4 GitHub Actions workflows are disabled (workflow_dispatch only) because they were written for Node.js but this is a Python/bash workspace:

- `baseline-check.yml` — uses `npm ci`, `actions/setup-node@v4` with `cache: 'npm'`
- `multi-ai-review.yml` — references missing `scripts/ai-workflow/` directory
- `baseline-audit.yml` — same Node.js mismatch
- `refactor-analysis.yml` — same Node.js mismatch

## Tasks

- [ ] Rewrite `baseline-check.yml` to use `uv`/`pytest` instead of `npm`
- [ ] Rewrite or remove `multi-ai-review.yml` (create `scripts/ai-workflow/` or use existing tooling)
- [ ] Rewrite or remove `baseline-audit.yml`
- [ ] Rewrite or remove `refactor-analysis.yml`
- [ ] Re-enable push/schedule triggers after rewrite
- [ ] Verify all workflows pass on main

## Context

Disabled in commit `1fc6d47` on 2026-01-31. Identified during reflect review on 2026-02-03.

## Plan

- **Step 0**: Audit all 5 workflows (including `phase1-consolidation.yml` which is not listed above). Decide per workflow: keep, merge, or remove.
- **Step 1**: For each kept workflow, define success criteria (e.g., pytest passes, coverage threshold met)
- **Step 2**: `baseline-check.yml` → Rewrite: `actions/setup-python@v5`, system python3, `pytest` with coverage. Install dependencies from workspace-hub `pyproject.toml` (if exists) or specific submodule `pyproject.toml` files.
- **Step 3**: `multi-ai-review.yml` → Rewrite: use existing `scripts/review/cross-review.sh`. If Codex CLI or Gemini CLI are not installable in GitHub Actions, the workflow should gracefully skip unavailable reviewers (consistent with cross-review.sh NO_OUTPUT handling). Use pinned tool versions.
- **Step 4**: `baseline-audit.yml` → Either merge into baseline-check or remove if redundant
- **Step 5**: `refactor-analysis.yml` → Remove (one-off analysis, not a recurring CI need)
- **Step 6**: Re-enable push/PR triggers, verify on main branch
- **Note**: `uv` is NOT installed on this system — use `pip install` or system python3 in CI

### Review Notes
- **Verdict**: Claude: MINOR | Codex: MINOR | Gemini: APPROVE
- **Actions taken**:
  - Added Step 0 to audit all 5 workflows (including missed `phase1-consolidation.yml`)
  - Added per-workflow success criteria definition
  - Added dependency installation source specification (pyproject.toml)
  - Added graceful skip for unavailable AI review tools in CI per Claude feedback
  - Added pinned tool versions requirement per Codex feedback
  - Added artifact upload specification (coverage reports/logs)
- *Cross-reviewed: 2026-02-09*

*Approved by user: 2026-02-09*
