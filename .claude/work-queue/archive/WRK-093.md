---
id: WRK-093
title: Improve dynacard AI diagnostics
status: done
priority: low
complexity: complex
created_at: 2026-02-03T00:00:00Z
completed_at: 2026-02-08T00:00:00Z
target_repos:
  - digitalmodel
commit: 78544b4d3 (implementation), 34f1a904f (P1 review fix)
spec_ref:
related: [WRK-049]
blocked_by: []
synced_to: []
---

# Improve dynacard AI diagnostics

## What
Upgrade the dynacard diagnostics engine from threshold-based pattern matching to learning-based classification. Expand failure mode detection beyond the current 6 modes.

## Why
The current `PumpDiagnostics.classify_card()` uses simple threshold comparisons (pump tagging > 38k lbs, fluid pound diff > 5k lbs, etc.). A learning-based approach would improve accuracy and generalize better across different well configurations.

## Acceptance Criteria
- [x] Replace threshold-based classification with ML/statistical model
- [x] Add additional failure modes (rod parting, stuck pump, worn barrel, etc.)
- [x] Validate against existing production well test data
- [x] Maintain backward compatibility with existing API
- [x] Tests for new classification approach

## Implementation Summary
- GradientBoosting classifier (100 estimators, depth 4) trained on 5,400 synthetic cards
- Bezerra vertical projection feature extraction (16-dimensional)
- 18 failure modes across 3 tiers (up from 4 functional modes)
- 89.4% cross-validated accuracy
- JSON model export (no sklearn runtime dependency)
- Legacy threshold fallback preserved
- 480 tests passing, 0 failures
- Cross-review: APPROVE_WITH_COMMENTS (Claude Opus 4.6), NO_OUTPUT (Codex, Gemini)
- P1 fix: init_value calibration for probability scores
- Marketing brochure: `docs/marketing/dynacard-ai-diagnostics-brochure.md`

---
*Source: WRK-049 P4 follow-up*
