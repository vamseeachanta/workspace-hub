---
id: WRK-068
title: Acquire BSEE incident investigations and INCs data
status: archived
priority: high
complexity: medium
created_at: 2026-02-01T00:00:00Z
target_repos:
  - worldenergydata
commit:
spec_ref:
related: [WRK-012, WRK-013]
blocked_by: []
synced_to: []
plan_workstations: [ace-linux-1]
execution_workstations: [ace-linux-1]
---
# Acquire BSEE incident investigations and INCs data

## What
Download actual BSEE incident investigation data and Incidents of Non-Compliance (INCs) from data.bsee.gov. Re-download the 15 stub Excel files from bsee.gov/stats-facts/offshore-incident-statistics. Verify URL importers work with corrected endpoints.

## Why
Current BSEE data coverage is near-zero despite having importers. The importers were pointing to wrong data endpoints (now fixed).

## Acceptance Criteria
- [x] Download incident investigation raw data from data.bsee.gov
- [x] Download INCSRawData.zip from data.bsee.gov
- [ ] Re-download all 17 Excel spreadsheets (replace stubs) — deferred (Phase 3)
- [ ] Verify corrected URL importers work — deferred (Phase 2, requires network access to data.bsee.gov)
- [x] Import data into database
- [x] Document record counts and date ranges

---
*Source: HSE data acquisition - BSEE incident investigations and INCs data*

## Progress
- 2026-02-01: Data acquired — 1,984 incident investigation records + 477K+ INC records downloaded from data.bsee.gov. Acquirer (bsee_acquirer.py) and importers (bsee_incinv_importer.py, bsee_incs_importer.py) built. Refresh script: scripts/refresh_bsee_hse.sh. Pending: run importers to load into DB.
- 2026-02-10: **Phase 1 + Phase 4 + Phase 5 COMPLETE**:
  - Bridge script: `scripts/import_bsee_hse_to_db.py` (connects file-based importers to DB)
  - Imported 1,984 incident investigations (INCINV-*) into hse_incidents table
  - Imported 66,561 INC violation records (INC-*) into hse_incidents + violation_incidents tables
  - Total DB: 97,993 HSE incidents (injury: 4,709, spill: 464, equipment_failure: 1,293, violation: 91,527)
  - Date range: 1948-01-03 to 2026-01-29
  - Incident investigations: 1995-01-04 to 2025-12-07
  - INCs: 1948-01-03 to 2026-01-29
  - 81 unit tests pass (26 DB import + 28 IncInv importer + 27 INCs importer)
  - Idempotent: re-run skips all duplicates
  - DB size: 57MB (data/modules/hse/hse_incidents.db)
  - **Deferred**: Phase 2 (URL importer verification, requires network), Phase 3 (Excel re-download)

## Plan

> Remaining work only. Raw data acquired, acquirers and importers built. On-disk data confirmed. Need to: (1) run importers against database, (2) verify URL-based importers, (3) re-download Excel stubs, (4) validate and document.

### Phase 1 — Run Existing Importers Against Database

1. **Create HSE database** (if not already created by WRK-067):
   - `data/modules/hse/hse_incidents.db` — the SQLite DB shared across all HSE importers
   - Both `bsee_incinv_importer.py` and `bsee_incs_importer.py` produce normalized dicts but do NOT directly persist to DB. They use a `load()` method returning `List[Dict]`, not the `BaseImporter.import_data()` pipeline.
   - **Gap**: Need a DB persistence wrapper that takes the `load()` output and feeds it through `BaseImporter.validate_data()` -> `BaseImporter.import_record()`

2. **Write DB bridge script**: `scripts/import_bsee_hse_to_db.py`
   - Instantiates `BSEEIncInvImporter(data_dir="data/modules/hse/raw/bsee")`
   - Calls `importer.load()` -> gets 1,984 records
   - For each record, validates via `BaseImporter.validate_data()` and persists via `BaseImporter.import_record()`
   - Same for `BSEEINCSImporter(data_dir="data/modules/hse/raw/bsee")`
   - Expected: ~477K+ INC violation records (each INC row can produce up to 3 records: warnings, component shut-ins, facility shut-ins)

3. **Data files confirmed on disk**:
   - `data/modules/hse/raw/bsee/IncInvRawData/mv_acc_investigations.txt` (169KB, 1,984 records)
   - `data/modules/hse/raw/bsee/INCSRawData/mv_incs_by_oper.txt` (3.3MB, primary INC file)
   - `data/modules/hse/raw/bsee/INCSRawData/mv_incs_*.txt` (14 regional files, ~25MB total)

### Phase 2 — Verify and Fix URL-Based Importers

1. **URL importers exist** but need verification:
   - `bsee_incidents_importer_url.py` — imports incidents from data.bsee.gov API
   - `bsee_penalties_importer_url.py` — imports civil penalties from data.bsee.gov API
   - `bsee_statistics_importer_url.py` — imports safety statistics from data.bsee.gov API

2. **Test each URL importer** in dry-run mode:
   - Verify endpoints resolve (data.bsee.gov may have changed since initial build)
   - Compare URL importer output against raw file importer output for overlapping records
   - Document any endpoint changes needed

3. **Run penalties importer**:
   - `bsee_penalties_importer.py` maps to `HSEIncident` + `ViolationIncident` (penalty amounts, regulation citations)
   - Data source: BSEE civil penalties database (may need separate download from data.bsee.gov)

### Phase 3 — Excel Spreadsheet Re-Download

1. **Acceptance criteria item**: "Re-download all 17 Excel spreadsheets (replace stubs)"
   - The work item notes 15 stub Excel files from `bsee.gov/stats-facts/offshore-incident-statistics`
   - These are aggregated statistical reports (not raw data), covering: injuries, fatalities, fires, explosions, blowouts, collisions, spills, crane incidents, etc.
   - `bsee_statistics_importer.py` is designed to read these

2. **Download script**: Extend `bsee_acquirer.py` or write `scripts/download_bsee_statistics_excel.sh`
   - Target URL: `https://www.bsee.gov/stats-facts/offshore-incident-statistics`
   - Save to: `data/modules/hse/raw/bsee/statistics/`
   - Verify file sizes (stubs are typically <1KB, real files are 50KB-2MB)

3. **Import statistics**:
   - Use `BSEEStatisticsImporter` to parse Excel files into `SafetyStatistic` model
   - Aggregated records (operator-level quarterly/annual summaries)

### Phase 4 — Validation and Documentation

1. **Run data quality validator** on all imported BSEE HSE data:
   - `DataQualityValidator(db_session).run_all_validations()`
   - Export: `data/modules/hse/quality_report_bsee.json`

2. **Document record counts**:
   - Incident investigations: expected ~1,984 records
   - INCs: expected ~477K+ (may expand to ~1.4M+ as each row produces 1-3 violation records)
   - Civil penalties: count TBD after import
   - Statistics: count TBD after Excel re-download

3. **Document date ranges**:
   - Incident investigations: earliest/latest dates from `DATE_OCCURRED` column
   - INCs: date range from `INC_DATE` column
   - Update data catalog: `data/catalog/data-catalog.yml`

### Phase 5 — Tests

1. **Unit tests**: `tests/unit/hse/test_bsee_incinv_importer.py`
   - Test `_normalize_row()` with various accident types (fatality, fire, blowout, etc.)
   - Test `_parse_date()` with M/D/YYYY and military time formats
   - Test `_map_accident_type()` and `_map_severity()` mappings

2. **Unit tests**: `tests/unit/hse/test_bsee_incs_importer.py`
   - Test `_normalize_row()` emits 0-3 records per row (one per non-zero INC category)
   - Test `_safe_int()` edge cases
   - Test region code mapping (G, A, P)

3. **Integration test**: `tests/unit/hse/test_bsee_hse_db_import.py`
   - Small fixture data (5-10 rows)
   - Verify HSEIncident records with correct `incident_type` and `severity`
   - Verify composite IDs (`INCINV-{date}-{lease}-{idx}`, `INC-{date}-{operator}-{type}-{idx}`)

4. **Path**: `PYTHONPATH="src:../assetutilities/src" python3 -m pytest tests/unit/hse/ -v --tb=short --noconftest`

### Existing Code to Build On
- Acquirer: `src/worldenergydata/hse/acquirers/bsee_acquirer.py`
- Incident investigation importer: `src/worldenergydata/hse/importers/bsee_incinv_importer.py` (351 lines)
- INCs importer: `src/worldenergydata/hse/importers/bsee_incs_importer.py` (402 lines)
- Penalties importer: `src/worldenergydata/hse/importers/bsee_penalties_importer.py` (BaseImporter subclass)
- Statistics importer: `src/worldenergydata/hse/importers/bsee_statistics_importer.py` (BaseImporter subclass)
- URL importers: `bsee_incidents_importer_url.py`, `bsee_penalties_importer_url.py`, `bsee_statistics_importer_url.py`
- Base importer: `src/worldenergydata/hse/importers/base_importer.py` (validate_data, import_record, is_duplicate)
- DB models: `src/worldenergydata/hse/database/models.py` (HSEIncident, ViolationIncident, SafetyStatistic)
- Refresh script: `scripts/refresh_bsee_hse.sh` (currently runs `--summary` only, not DB import)
- Existing tests: `tests/modules/hse/importers/test_bsee_incidents_importer.py`

### Data State
- **On disk**: `data/modules/hse/raw/bsee/IncInvRawData/mv_acc_investigations.txt` (169KB)
- **On disk**: `data/modules/hse/raw/bsee/INCSRawData/` (14 files, ~28MB total)
- **On disk**: `data/modules/hse/raw/bsee/IncInvRawData.zip`, `INCSRawData.zip` (original ZIPs)
- **Not yet created**: `data/modules/hse/hse_incidents.db` (shared with WRK-067)
- **Not yet created**: `data/modules/hse/raw/bsee/statistics/` (Excel re-downloads)

### Dependencies
- Shared DB with WRK-067 (`hse_incidents.db`) — order does not matter, both create tables if absent
- URL importers depend on data.bsee.gov availability

### Review Notes

**Cross-review date**: 2026-02-10

| Reviewer | Verdict |
|----------|---------|
| Claude Opus 4.6 | MINOR |
| Gemini CLI | APPROVE |
| Codex CLI | NO_OUTPUT |

**Feedback incorporated**:
- Line counts off by 1
- INCSRawData has 15 files not 14; `mv_insp_by_oper.txt` (9.7MB) not mentioned in plan
- Relationship between `bsee_incidents_importer.py` (BaseImporter subclass) and `bsee_incinv_importer.py` (standalone 350 lines) unclear — needs clarification
- Test path convention inconsistency (tests/unit/hse/ vs tests/modules/hse/importers/)
