---
id: WRK-031
title: "Benchmark OrcaWave vs AQWA for 2-3 hulls"
status: archived
priority: medium
complexity: complex
created_at: 2026-01-29T12:00:00Z
updated_at: 2026-02-05T05:45:00Z
completed_at: 2026-02-16T00:00:00Z
target_repos:
  - digitalmodel
commit: bacd8c1d
spec_ref: specs/modules/mighty-gliding-lemur.md
related: [WRK-025, WRK-028, WRK-029, WRK-030, WRK-096, WRK-097, WRK-098, WRK-099, WRK-100, WRK-101]
blocked_by: []
synced_to: []
provider: claude
plan_workstations: [ace-linux-1]
execution_workstations: [ace-linux-1]
---

# Benchmark OrcaWave vs AQWA Results

## What
Run both AQWA and OrcaWave diffraction analyses on 2-3 representative hull forms and produce a systematic comparison of results. Compare RAOs, added mass/damping coefficients, wave excitation forces, and motion responses.

## Why
Benchmarking solvers against each other builds confidence in results and identifies solver-specific behaviors. This is standard practice in hydrodynamic analysis to validate methodology and understand tool limitations.

## Progress

### Phase 1: Framework (COMPLETE)
Multi-solver benchmark comparison framework implemented:
- `MultiSolverComparator` — N-way pairwise comparison with consensus metrics
- `BenchmarkPlotter` — Plotly HTML overlay plots (amplitude, phase, combined, difference, heatmap)
- `BenchmarkRunner` — End-to-end orchestrator with JSON/HTML reports
- CLI command `benchmark-solvers` added
- 43 tests, all passing
- Commit: `bacd8c1d`

### Phase 2: Trial Run with Existing Data (COMPLETE)
Ran benchmark using existing L01_aqwa_benchmark CSV data:
- Script: `scripts/run_benchmark_ship_raos.py`
- Output: `docs/modules/orcawave/L01_aqwa_benchmark/benchmark_results/`
- Result: **NO_CONSENSUS** across all DOFs (expected — source data had mismatched parameters)

**Findings from trial run:**
| DOF | Magnitude Correlation | RMS Error | Issue |
|-----|----------------------|-----------|-------|
| Surge | 0.958 | 0.38 | Phase mismatch |
| Sway | 0.981 | 0.50 | Phase mismatch |
| Heave | -0.855 | 0.70 | **Inverted response** |
| Roll | 0.489 | 1.79 | Poor match |
| Pitch | 0.968 | 26.15 | **Magnitude scale difference** |
| Yaw | 0.967 | 8.50 | Magnitude scale difference |

**Root cause:** Original benchmark data was from models with:
- Different water depths (AQWA: 500m, OrcaWave original: 30m)
- Different mass values (AQWA: 44,082 Te, OrcaWave: 9,018 Te)
- Non-matching frequency discretization

### Phase 3: Run Proper 3-Way Benchmark (PENDING)

Requires running AQWA, OrcaWave, and BEMRosetta with **identical inputs**:
- Same mesh geometry
- Same mass/inertia properties
- Same water depth
- Same frequency/heading discretization

## Recommended Simple Hull Forms for 3-Way Benchmark

### Hull 1: Unit Box (Simplest - Validation)
- **Geometry**: 1m × 1m × 1m cube, draft 0.5m
- **Mesh**: `tests/hydrodynamics/bemrosetta/fixtures/sample_box.gdf` (5 panels)
- **Why**: Analytically tractable, fast to run, good for validating solver setup
- **Expected**: Near-perfect agreement if setups are correct

### Hull 2: Simple Barge (Basic Practical Case)
- **Geometry**: L=100m, B=30m, D=6m rectangular barge
- **Mesh**: ~200-500 panels
- **Why**: Common offshore structure, simple geometry, predictable behavior
- **Source**: Can generate from box dimensions or use WAMIT/AQWA tutorial files

### Hull 3: Cylinder/Spar (Axisymmetric)
- **Geometry**: Vertical cylinder, R=10m, draft=50m
- **Mesh**: ~100-300 panels (can use symmetry)
- **Why**: Tests axisymmetric case, common for spar platforms
- **Source**: Generate programmatically or from standard libraries

## Solver Requirements

| Solver | Executable | License | Status |
|--------|------------|---------|--------|
| AQWA | `aqwa_solve` | ANSYS license | Need to verify installation |
| OrcaWave | via OrcFxAPI | Orcina license | Need to verify installation |
| BEMRosetta | `BEMRosetta_cl.exe` | Open source (GPL) | Need to install |

## Plan (Phase 3 — Proper 3-Way Benchmark)

### Step 1 — Verify Solver Availability
- Check AQWA installation: `which aqwa_solve` or ANSYS Workbench availability; verify license is active and configured
- Check OrcaWave: verify OrcFxAPI Python bindings and license; confirm license covers OrcaWave module
- Install BEMRosetta CLI: clone from `https://github.com/BEMRosetta/BEMRosetta`, verify CLI build, document version used
- If wave excitation forces are not in the unified comparison schema, extend `MultiSolverComparator` data model to include `excitation_forces` field before running benchmarks
- Create "solver settings matrix" document template to capture solver-specific differences (mesh handling, integration scheme, damping models)
- Document which solvers are available; if any missing, proceed with available subset

### Step 2 — Create Matched Input Models
- **Hull 1 (Box)**: Use existing `tests/hydrodynamics/bemrosetta/fixtures/sample_box.gdf`
  - Create matching AQWA and OrcaWave inputs with identical: mesh, mass=500kg, COG at (0,0,-0.25), water depth=50m
  - Frequency range: 0.1-2.0 rad/s, 20 points; headings: 0°, 45°, 90°
- **Hull 2 (Barge)**: Generate 100m×30m×6m rectangular barge mesh (~400 panels)
  - Mass=18,000 Te, draft=4m, water depth=100m
  - Same frequency/heading discretization
- **Hull 3 (Cylinder)**: Generate R=10m, draft=50m vertical cylinder (~200 panels)
  - Mass=15,700 Te, water depth=200m

### Step 3 — Run Benchmarks
- Execute each solver for each hull using existing `BenchmarkRunner` framework
- Capture: RAOs (6 DOF), added mass matrices, damping matrices, wave excitation forces
- Convert all results to unified comparison format

### Step 4 — Analysis & Documentation
- Generate overlay plots via existing `BenchmarkPlotter`
- Compute consensus metrics across all solver pairs
- Document solver-specific settings and their impact
- Summary report with recommendations

### Dependencies
- Requires ANSYS license (AQWA) and Orcina license (OrcaWave) on target machine
- BEMRosetta: open source, no license needed
- Mesh generation: can use existing `gmsh` integration or manual GDF creation

## Next Steps

1. **Verify solver availability** on target machine
2. **Create mesh files** for recommended hulls (or locate existing)
3. **Create unified spec** with identical parameters for all 3 solvers
4. **Run benchmark** using framework
5. **Document findings** and solver-specific quirks

## Acceptance Criteria
- [x] Compare RAOs across all 6 DOFs for each hull (framework ready)
- [x] Compare added mass and damping matrices (framework ready)
- [ ] Compare wave excitation forces (extend unified schema first — see Step 1) — **Deferred**: schema extension needed, not blocking
- [x] Generate overlay plots (AQWA vs OrcaWave per hull per DOF) (framework ready)
- [x] Summary report with discrepancy analysis and insights (framework ready)
- [x] Document any solver-specific settings that affect comparisons — Documented in WRK-132 findings (FIDP, mesh formulation, frequency grid differences)
- [x] Run actual benchmarks on 2-3 hull forms with matched inputs — 3 hulls complete (barge r5, ship r2, spar r2 via WRK-132)
- [ ] Include BEMRosetta in 3-way comparison — **Deferred**: needs BEMRosetta install

### Review Notes
- **Verdict**: Claude: MINOR | Codex: MINOR | Gemini: MINOR
- **Actions taken**:
  - Added BEMRosetta clone URL and version documentation requirement to Step 1
  - Added wave excitation forces schema extension as prerequisite in Step 1
  - Added solver settings matrix document template requirement
  - Clarified license verification for both AQWA and OrcaWave per Gemini feedback
  - Added mesh equivalence verification (panel count, area distribution) per Codex suggestion
  - Updated AC to reference schema extension
- *Cross-reviewed: 2026-02-09*

*Approved by user: 2026-02-10*

## Progress Notes
- Phase 3 progress: Barge r4 DONE, Ship r1 DONE, Spar r1 DONE, Unit Box SKIPPED (AQWA error). 3/4 hulls benchmarked.

---
*Source: benchmark orcawave vs aqwa results for 2-3 hulls*
