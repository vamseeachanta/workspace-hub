---
id: WRK-145
title: Design code versioning — handle changing revisions of standards
status: done
priority: medium
complexity: medium
created_at: 2026-02-15T12:00:00Z
completed_at: 2026-02-16T00:00:00Z
target_repos:
  - digitalmodel
commit: 2a1dc217f
spec_ref:
related:
  - WRK-044
  - WRK-144
blocked_by: []
synced_to: []
---

# Design code versioning — handle changing revisions of standards

## What
Add support for specifying design code editions/revisions so that calculations can target a specific version of a standard (e.g., API RP 1111 3rd Ed. 2009 vs 4th Ed. 2015, or API RP 2RD 1st Ed. 1998 vs API STD 2RD 1st Ed. 2013).

## Why
- Design codes are updated periodically — equations, factors, and conditions change between editions
- Existing installations must comply with the edition under which they were designed
- New designs may reference the latest edition or a specific edition per project design basis
- Re-qualification studies often need to check against both old and new editions
- Regulatory compliance requires traceability to specific code edition

## Context
User feedback: "we should be able to handle changing revisions of codes"

### Examples of edition-sensitive changes
- API RP 1111: 3rd Ed. (2009) vs 4th Ed. (2015) — propagation buckling factor changed
- DNV-OS-F101 (2000) → DNV-ST-F101 (2017/2021) — different safety class factors, new local buckling check
- API RP 2RD (1998 WSD) → API STD 2RD (2013 LRFD) — entirely different methodology

## Acceptance Criteria
- [x] `DesignCode` enum extended with edition/version metadata
- [x] Strategy classes accept optional `edition` parameter
- [x] Factor tables are edition-aware (lookup by edition year)
- [x] Report header shows exact code edition being applied
- [x] Backward compatible — existing calls without edition default to latest
- [x] At least one code (API RP 1111) demonstrates multi-edition support
- [x] Tests verify different editions produce different results where factors changed

## Plan
### Approach: Edition-aware strategy pattern
1. Extend `DesignCode` or add `CodeEdition` dataclass: `code`, `edition_year`, `edition_label`
2. Factor tables keyed by edition year: `{2009: {"f_d": 0.72, ...}, 2015: {"f_d": 0.72, ...}}`
3. Strategy `__init__` takes optional `edition` parameter, defaults to latest
4. Report header includes: "API RP 1111, 4th Edition (2015)"
5. `generate_mt_report()` passes edition through to HTML builder

### Key file
- `src/digitalmodel/structural/analysis/wall_thickness.py` — `DesignCode` enum, data structures
- `src/digitalmodel/structural/analysis/wall_thickness_codes.py` — strategy classes, factor tables

---
*Source: User feedback during WRK-044 implementation session*
