---
id: WRK-170
title: "Integrate MET-OM/metocean-stats as statistical analysis engine for metocean module"
status: archived
priority: medium
complexity: complex
created_at: 2026-02-17T00:00:00Z
target_repos:
  - worldenergydata
  - digitalmodel
target_module: metocean
commit:
spec_ref:
related: [WRK-084, WRK-015, WRK-076]
blocked_by: []
plan_reviewed: false
plan_approved: false
percent_complete: 100
brochure_status: n/a
provider: claude
provider_alt:
---
# Integrate MET-OM/metocean-stats Library

## What
Adopt [MET-OM/metocean-stats](https://github.com/MET-OM/metocean-stats) (MIT license, 98 stars) as the statistical analysis engine for our metocean module. The library provides production-grade implementations of EVA, joint probability, environmental contours, weather windows, and spectral analysis that our skills describe conceptually but don't implement.

## Why
- Our metocean module has **7 data source clients** (COOPS, ERDDAP, NDBC, OpenMeteo, Met Norway, etc.) but **zero statistical analysis**
- metocean-stats provides 48+ statistical methods we'd otherwise need to build from scratch
- MIT license — fully compatible with commercial use
- Active maintenance (Python 3.9+, recent releases)
- Fills the gap between data collection (WRK-084) and engineering application (WRK-015)

## External Library Capabilities
| Category | Methods | Notes |
|----------|---------|-------|
| EVA | Peaks-Over-Threshold, Annual Maxima, Initial Distribution Method | Return periods 1–10,000 yr |
| Joint Probability | Conditional Modeling Approach (CMA via virocon) | 7+ predefined models (Hs-Tp, Hs-Wind, etc.) |
| Environmental Contours | IFORM, ISORM, highest-density, direct sampling | Per-standard contour methods |
| Weather Windows | Threshold-based operability, persistence statistics | Critical for marine ops planning |
| Wave Spectra | JONSWAP, Torsethaugen, spectral moments | Spectral fatigue input |
| Scatter Diagrams | 2D occurrence tables, Hs-Tp matrices | Standard metocean deliverable |
| Tidal Analysis | Harmonic analysis, prediction | Tidal correction for water levels |
| Verification | Taylor diagrams, QQ plots, bias/RMSE metrics | Model validation |
| Reporting | Automated DOCX report generation | Client deliverables |

## Our Complementary Strengths (retain)
- 7 data source clients with parallel fetching
- Interactive Plotly visualization (metocean-stats uses matplotlib)
- Data catalog integration and binary caching
- GIS/coordinate-aware extrapolation (WRK-015)

## Acceptance Criteria
- [ ] Add metocean-stats as dependency (pip/uv) in worldenergydata
- [ ] Create thin wrapper module: `src/worldenergydata/metocean/statistics/` bridging our data loaders to metocean-stats API
- [ ] EVA integration: feed NDBC/COOPS timeseries → POT/AM analysis → return period table
- [ ] Joint probability: Hs-Tp CMA model from our scatter diagram data
- [ ] Environmental contours: IFORM/ISORM from joint model → Plotly interactive plot
- [ ] Weather window analysis: threshold-based operability from timeseries
- [ ] At least 2 worked examples with real NDBC station data
- [ ] HTML report with Plotly charts (upgrade from metocean-stats' matplotlib default)
- [ ] Tests validating wrapper outputs against metocean-stats direct calls
- [ ] Document API mapping: our interfaces → metocean-stats functions

## Plan

### Phase 1 — Dependency & Compatibility Audit
- Install metocean-stats, verify Python 3.12 compatibility
- Catalog its public API surface and required input formats
- Identify any dependency conflicts with our stack (numpy, scipy, pandas versions)
- Map metocean-stats input formats to our existing data loader outputs

### Phase 2 — EVA Wrapper
- Create `statistics/eva.py` wrapping POT, AM, IDM methods
- Input: pandas Series (from our NDBC/COOPS loaders) → Output: return period DataFrame
- Plotly return-period plot (replacing matplotlib)
- Tests: verify against metocean-stats direct call results

### Phase 3 — Joint Probability & Contours
- Create `statistics/joint_probability.py` wrapping CMA
- Create `statistics/environmental_contours.py` wrapping IFORM/ISORM
- Input: Hs-Tp DataFrame → Output: contour coordinates + joint model
- Plotly scatter + contour overlay
- Tests: verify contour encloses expected % of data points

### Phase 4 — Weather Windows & Operability
- Create `statistics/weather_windows.py`
- Input: timeseries + threshold dict → Output: operability %, window duration stats
- Monthly operability heatmap (Plotly)
- Tests: verify against manual threshold counting

### Phase 5 — Worked Examples & Reports
- Example 1: Gulf of Mexico — NDBC 42035 (Hs EVA + Hs-Tp joint + contours)
- Example 2: North Sea — Met Norway hindcast (weather windows + operability)
- HTML report template integrating all analysis types
- Each example: data fetch → statistics → visualization → HTML report

### Phase 6 — digitalmodel Integration
- Bridge fatigue module: metocean spectra → stress range histogram → damage accumulation
- Bridge mooring analysis: environmental contours → load case matrix
- Update digitalmodel data_sources.yaml to reference metocean-stats capabilities

## Dependencies
- metocean-stats (pip install metocean-stats)
- virocon (pulled in by metocean-stats for CMA)
- scipy, numpy, pandas (already in our stack)

## Notes
- metocean-stats uses matplotlib — we wrap with Plotly for consistency with our HTML reports
- The library's DOCX report generation could supplement our HTML reports for client deliverables
- WRK-084 (unified aggregation) provides the data pipeline; this WRK provides the analysis layer
- WRK-015 (extrapolation) uses EVA results from this WRK as input for spatial modeling

## Agentic AI Horizon

- MET-OM/metocean-stats integration provides a validated statistical engine for metocean analysis — direct capability upgrade for worldenergydata and digitalmodel workflows.
- Statistical metocean analysis tools are mature; integrating an existing library is faster than building from scratch and creates a stable, testable foundation.
- **Disposition: invest now** — integrating metocean-stats as the statistical backend strengthens WRK-015 extrapolation and WRK-084 aggregation; execute in parallel with those items.
