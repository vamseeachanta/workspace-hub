---
id: WRK-090
title: Identify and refactor large files exceeding 400-line limit
status: archived
priority: medium
complexity: medium
compound: false
created_at: 2026-02-03T13:30:00Z
target_repos:
  - workspace-hub
plan_workstations: [ace-linux-1]
execution_workstations: [ace-linux-1]
---

## Description

Reflect state flagged 12 large files exceeding the 400-line hard limit defined in `coding-style.md`. These files may need splitting by responsibility.

## Tasks

- [ ] Identify all source files (py, ts, js, sh) exceeding 400 lines in workspace (excluding submodules, node_modules, generated files)
- [ ] Assess each file: is it a candidate for splitting or acceptable as-is (data, config, etc.)
- [ ] Split files that have multiple responsibilities into focused modules
- [ ] Verify no functionality is broken after refactoring

## Context

Identified during reflect review on 2026-02-03. Coding style rule: 400-line hard limit, 200-line soft target.

## Plan

- **Step 1**: Scan `scripts/`, `src/`, `tests/`, `.claude/` at workspace-hub level only (exclude submodule directories). If no files exceed 400 lines at hub level, expand scope to commonly-edited submodule files (digitalmodel, worldenergydata) with coordinator approval.
- **Step 2**: Categorize each: split candidate (multiple responsibilities) vs. acceptable. **Exemptions**: auto-generated files, data schemas with >400 lines of field definitions, test fixtures. Document each exemption.
- **Step 3**: For split candidates: identify responsibility boundaries, plan split into focused modules. Define selection criteria for top 5-10 files (e.g., cyclomatic complexity, edit frequency, not just line count).
- **Step 4**: Refactor top 5-10 worst offenders, maintaining all imports and tests. Require a "no behavior change" check (unit tests or smoke tests before and after).
- **Step 5**: Verify no functionality broken after refactoring
- **Step 6**: Add exclusion list for generated/third-party files to prevent re-flagging
- **Note**: Scope may be trivially empty at workspace-hub level â€” most Python files are in submodules

### Review Notes
- **Verdict**: Claude: MINOR | Codex: MINOR | Gemini: APPROVE
- **Actions taken**:
  - Clarified scan scope: hub-level directories only, with expansion option if trivially empty
  - Added explicit exemption criteria (auto-generated, data schemas, test fixtures)
  - Added "no behavior change" check requirement before/after refactoring
  - Added file exclusion list for generated/third-party files
  - Added selection criteria beyond line count (complexity, edit frequency)
  - Noted scope may be trivially empty at hub level
- *Cross-reviewed: 2026-02-09*

*Approved by user: 2026-02-09*
