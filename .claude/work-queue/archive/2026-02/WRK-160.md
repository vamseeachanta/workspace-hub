---
id: WRK-160
title: "OSHA severe injury + fatality data completion and severity mapping fix"
status: archived
priority: medium
complexity: simple
created_at: 2026-02-16T00:00:00Z
target_repos:
  - worldenergydata
target_module: hse
commit: 306d33d
spec_ref:
related: [WRK-067]
blocked_by: []
plan_reviewed: false
plan_approved: false
percent_complete: 100
brochure_status: n/a
provider: claude
provider_alt:
plan_workstations: [ace-linux-1]
execution_workstations: [ace-linux-1]
---
# OSHA Data Completion and Severity Mapping Fix

## What
Complete the OSHA data import (WRK-067 deferred items): download severe injury reports and fatality data using existing acquirer, and fix the severity mapping that defaults all records to "recordable" instead of mapping numeric degree_of_inj codes correctly.

## Why
- 2 of 7 WRK-067 acceptance criteria were deferred
- Severity mapping bug means all 1,878 accident records show wrong severity
- osha_accident_lookup2.csv exists but is not integrated

## Acceptance Criteria
- [x] Execute osha_fatalities_acquirer.py to download severe injury + fatality data
- [x] Import severe injury and fatality records into existing schema
- [x] Fix degree_of_inj numeric-to-severity mapping
- [x] Integrate osha_accident_lookup2.csv for injury description decoding
- [x] Tests for severity mapping correctness

## Implementation Notes (2026-02-16)

### Bug Fix: Severity Mapping
- **Root cause**: `DEGREE_SEVERITY` dict had text keys ("Fatality", "Hospitalized injury") but CSV data contains numeric codes ("1", "2", "3")
- **Fix**: Added numeric code keys (`"1"` → fatality, `"2"` → lost_time, `"3"` → recordable, `"0"` → near_miss) alongside text variants for robustness
- **Impact**: 2,658 accident injury records now correctly classified:
  - Before: 2,658 "recordable" (100% wrong)
  - After: 1,505 fatality, 766 lost_time, 214 near_miss, 173 recordable

### Lookup Table Integration
- Loaded `osha_accident_lookup2.csv` (861 entries, 11 code types) into importer via `_load_accident_lookups()`
- Added `_decode_field()` to resolve numeric codes to human-readable text
- Description fields now show decoded text instead of raw codes:
  - `Nature: 5` → `Nature: Burn/Scald(Heat)`
  - `Body part: 1` → `Body part: ABDOMEN`
  - `Source: 16` → `Source: FIRE/SMOKE`

### Severe Injury Data Download
- OSHA endpoint changed from CSV to ZIP: `https://www.osha.gov/sites/default/files/January2015toJuly2025.zip`
- Downloaded 103K total severe injury records (Jan 2015 – Jul 2025)
- Filtered to 3,595 oil & gas records (NAICS + keyword match)
- Saved to `data/modules/hse/raw/osha/fatalities/osha_severe_injury_oil_gas.csv`

### Fatality Inspections Extraction
- Extracted 3,679 type-A (fatality/catastrophe) inspections from existing filtered data
- Saved to `data/modules/hse/raw/osha/fatalities/osha_fatality_inspections_oil_gas.csv`

### Files Modified
- `src/worldenergydata/hse/importers/osha_importer.py` — fixed DEGREE_SEVERITY, added lookup loader, decode helper, field label mapping
- `tests/unit/hse/test_osha_severity_mapping.py` — 29 new tests (5 test classes)
- `data/modules/hse/raw/osha/fatalities/` — new directory with severe injury + fatality data

### Test Results
- 29/29 new tests pass (severity mapping, lookup loading, field decoding, integration)
- 110/110 total HSE tests pass (zero regressions)
