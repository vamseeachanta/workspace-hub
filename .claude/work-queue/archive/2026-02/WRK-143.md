---
id: WRK-143
title: Full symmetric M-T envelope — closed polygon lens shapes
status: pending
priority: medium
complexity: simple
created_at: 2026-02-15T12:00:00Z
target_repos:
  - digitalmodel
commit:
spec_ref:
related:
  - WRK-044
  - WRK-142
blocked_by: []
synced_to: []
---

# Full symmetric M-T envelope — closed polygon lens shapes

## What
Modify the allowable bending envelope chart to show full symmetric envelopes (both +M and -M), creating closed polygon "lens" shapes for each operating condition instead of the current half-envelopes showing only positive M.

## Why
Engineers expect to see the full interaction envelope as a closed shape. The current chart only shows the upper half (+M_allow vs T), but the envelope is symmetric about M=0 for bending (flipping M sign just swaps which fibre governs). Showing the full closed polygon is standard practice in structural reports.

## Context
This is a follow-up from WRK-044 session. The `_build_envelope_chart()` function currently plots one trace per condition showing T vs +M_allow. The envelope is already computed — we just need to mirror it.

### Physics
- `_trace_envelope()` returns `(T_values, M_values)` where M_values are all positive (absolute)
- Bending is symmetric about M=0 at any given T
- The closed polygon is: T_vals forward with +M_vals, then T_vals reversed with -M_vals

## Acceptance Criteria
- [ ] Envelope chart shows closed polygon shapes for each operating condition
- [ ] Each condition fills its lens shape with semi-transparent color
- [ ] Boundary line traces the full closed polygon
- [ ] Innermost (Normal Operating) is visually distinct from outermost (Survival)
- [ ] Also update pressure sensitivity chart to use symmetric envelopes
- [ ] Existing tests still pass
- [ ] Report regenerated

## Key File
- `src/digitalmodel/structural/analysis/wall_thickness_mt_report.py` — `_build_envelope_chart()` (~line 659-740)

## Plan
Modify `_build_envelope_chart()`:
1. For each condition, create closed polygon: `T_forward + T_reversed`, `+M_forward + (-M_reversed)`
2. Use `go.Scatter` with `fill="toself"` and semi-transparent `fillcolor`
3. Add `opacity=0.15` (or similar) for fill, full opacity for border line
4. Plot conditions from outermost (Survival) to innermost (Normal Operating) so fills layer correctly
5. Apply same pattern to `_build_pressure_sensitivity_chart()`
6. Run tests, regenerate report

---
*Source: WRK-044 session — user requested "implement the full symmetric envelope"*
