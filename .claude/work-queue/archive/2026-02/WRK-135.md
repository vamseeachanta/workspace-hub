---
id: WRK-135
title: "Ingest XLS historical rig fleet data (163 deepwater rigs)"
status: archived
priority: medium
complexity: medium
compound: false
created_at: 2026-02-12T00:00:00Z
completed_at: 2026-02-13T00:00:00Z
target_repos:
  - worldenergydata
commit: eb4d2de
spec_ref:
related: [WRK-104]
blocked_by: []
synced_to: []
plan_reviewed: false
plan_approved: false
percent_complete: 100
brochure_status: n/a
tags: [rig-fleet, data-ingest, xls, vessel-fleet]
---

# Ingest XLS Historical Rig Fleet Data (163 Deepwater Rigs)

## What
Parse and ingest 163 deepwater drilling rigs from the historical XLS reference files into the vessel_fleet pipeline. This was deferred from WRK-104 Step 2.

## Why
The XLS data contains ~80 fields per rig (vessel, riser, BOP, moonpool, drilling equipment, mud systems) for semisubs and drillships — significantly more detail than WAR or fleet page scrape data. These are the most data-rich rig records available and will improve spec completeness for deepwater vessels. Legal assessment: GREEN (163 public industry rigs, zero denied terms).

## Acceptance Criteria
- [x] XLS parser handles transposed layout (rig-per-column)
- [x] Mixed format parsing: `"8,000 ft."`, `"20 x 40"`, `"DP2"`, `"Y/Yes/1.0"`
- [x] ≥150 rigs output to `data/modules/vessel_fleet/raw/xls_historical/` *(163 rigs)*
- [x] Spot-check 5 rigs against source for field accuracy
- [x] Merged into curated fleet via deduplicator (source priority: `xls_historical=4`) *(145 survived, 18 merged)*
- [x] Unit tests for XLS parsing, format normalization, and output validation *(22 tests)*
- [x] Hull dimensions (LOA, beam, draft, displacement) captured for RAO/diffraction mapping *(HULL_FORM_TYPE + dimensions)*

## Results
- **163 rigs** parsed (98 semi-subs, 62 drillships, 2 malformed types fixed, 1 NaN)
- **24 fields** extracted incl. LOA_M, BEAM_M, DRAFT_M, MOONPOOL_*_M, HULL_FORM_TYPE
- **2,268 curated rigs** after fusion (up from 2,187)
- **145 XLS rigs** in curated output (18 merged with WAR duplicates)
- **290 vessel_fleet tests** passing

## Plan
- Existing script: `scripts/vessel_fleet/ingest_xls_historical.py`
- Existing parser: `src/worldenergydata/vessel_fleet/parsers/xls.py`
- Master file: `DrillRigs.xls` (transposed layout: rig-per-column, needs transpose)
- Assessment: `worldenergydata/docs/data/rig-fleet-xls-assessment.md`
- 11/18 existing schema fields directly mappable, ~30 new fields recommended

---
*Deferred from WRK-104 Step 2*
