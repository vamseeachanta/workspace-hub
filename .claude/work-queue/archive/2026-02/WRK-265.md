---
id: WRK-265
title: "Wire CrossDatabaseAnalyzer to live MAIB/IMO/EMSA/TSB importers"
status: archived
priority: high
complexity: medium
compound: false
created_at: 2026-02-20T00:00:00Z
target_repos:
  - worldenergydata
target_module: marine_safety
commit: c17e4f5
spec_ref:
related: [WRK-074, WRK-250]
blocked_by: []
plan: inline
plan_reviewed: false
plan_approved: false
percent_complete: 100
provider: claude
plan_workstations: [ace-linux-1]
execution_workstations: [ace-linux-1]
---

# Wire CrossDatabaseAnalyzer to Live Importers

## Why

WRK-250 built `CrossDatabaseAnalyzer` with 203 synthetic incidents in `_cross_database_data.py`.
The real importers (MAIB, IMO, EMSA, TSB) already exist from WRK-074 but are not wired into
the cross-database query layer. Agents querying marine safety data get synthetic results.

## What

Replace `SYNTHETIC_INCIDENTS` fallback with live importer calls in `CrossDatabaseAnalyzer.query()`:
- Call each source importer when `sources` filter includes it
- Normalise each importer's output to the unified schema
- Keep synthetic data as fallback when importers fail (offline/rate-limited)
- Add `data_freshness` field to `CrossDatabaseResult` (live | cached | synthetic)

## Acceptance Criteria
- [x] `CrossDatabaseAnalyzer` calls real importers by default (when importer_config provided)
- [x] Graceful fallback to synthetic when importer unavailable
- [x] `data_freshness` field on result
- [x] Integration test with at least 1 real source (MAIB + TSB fixture CSVs)
- [x] 20+ tests (live + fallback paths) — 55 new tests added

## Deliverables

- `src/worldenergydata/marine_safety/cross_database.py` — live importer wiring
- `tests/fixtures/marine_safety/maib_occurrences_sample.csv` — MAIB fixture (7 records)
- `tests/fixtures/marine_safety/tsb_occurrence_sample.csv` — TSB fixture (7 records)
- `tests/unit/marine_safety/test_cross_database_live.py` — 55 new tests
- 109 total tests pass (54 existing + 55 new)
