# WRK-205 Step 1 — Approved Schema Definition

**Status:** Approved by user 2026-02-19. Agent B may proceed.
**Index strategy:** Option 3 — one INDEX.md per second-level subdirectory (natural, follows existing structure).

---

## Domain Survey Results

- **Active hub SKILL.md files:** 298
- **Active top-level domains:** 9 (not 16 as estimated)
- **`_diverged/` files:** 115 — 100 matched, 15 UNMATCHED, 2 AMBIGUOUS names

**Top-level domains:**

| Domain | Skills |
|--------|--------|
| `business` | 69 |
| `engineering` | 66 |
| `data` | 65 |
| `development` | 43 |
| `coordination` | 25 |
| `operations` | 11 |
| `workspace-hub` | 9 |
| `science` | 6 |
| `ai` | 4 |

---

## Index Strategy (Option 3 — approved)

Create one `INDEX.md` per **second-level subdirectory** following the existing
directory structure. No arbitrary grouping. For domains with only top-level
skills (no subdirectories), create `INDEX.md` at the domain root.

**Pattern:** `.claude/skills/<domain>/<subdomain>/INDEX.md`

The main `.claude/skills/README.md` becomes a meta-index listing all these
INDEX.md files (~25-30 entries, grouped by top-level domain).

**Why this is natural and intuitive:**
- Follows the directory structure that already exists
- Users browsing the skills folder see INDEX.md exactly where they'd look
- Just-in-time loading: load only `engineering/marine-offshore/INDEX.md`
  instead of all 66 engineering skills
- No need to learn a separate classification system

---

## Frontmatter Schema

Add these three keys to every hub SKILL.md that doesn't already have them.
Insert as a contiguous block inside the existing `---` frontmatter.

```yaml
capabilities: []
requires: []
see_also: []
```

**Rules:**
- All three keys present even when empty (`[]`)
- `requires:` and `see_also:` values: hub-relative paths from `.claude/skills/`
  (e.g. `engineering/marine-offshore/fatigue-analysis`)
- `capabilities:` values: free-text strings — controlled vocabulary deferred
- Do not modify any existing frontmatter keys

---

## Graph Edge Schema

File: `.claude/skills/SKILLS_GRAPH.yaml` (generated artifact — do not hand-edit)

```yaml
# SKILLS_GRAPH.yaml
# Generated by WRK-205. Source of truth is SKILL.md frontmatter.
# schema_version: "1.0.0"
edges:
  - from: "<hub-relative-skill-path>"
    to: "<hub-relative-skill-path>"
    type: "requires"          # or "see_also"
    source_file: "<path>/SKILL.md"
```

**Extraction rules:**
- `requires:` list in SKILL.md → edge type `requires`
- `see_also:` list in SKILL.md → edge type `see_also`
- `composes` and `alternatives` reserved for future use — do not emit
- Broken references (target path not found): log to stderr, do not fail

---

## canonical_ref Rules (for `_diverged/` only)

Match each `_diverged/` skill by **leaf directory name** (exact, case-sensitive)
to a hub SKILL.md path.

| Result | `canonical_ref` value |
|--------|-----------------------|
| Exactly one match | `"<hub-relative-path>"` |
| Zero matches | `UNMATCHED` |
| Multiple matches | `AMBIGUOUS` + comment listing candidates |

**Known 15 UNMATCHED (set directly, no lookup needed):**
```
_diverged/digitalmodel/ai-prompting/agenta
_diverged/digitalmodel/ai-prompting/dspy
_diverged/digitalmodel/ai-prompting/langchain
_diverged/digitalmodel/ai-prompting/pandasai
_diverged/digitalmodel/automation/activepieces
_diverged/digitalmodel/automation/airflow
_diverged/digitalmodel/automation/n8n
_diverged/digitalmodel/automation/windmill
_diverged/digitalmodel/documentation/docusaurus
_diverged/digitalmodel/documentation/gitbook
_diverged/digitalmodel/documentation/marp
_diverged/digitalmodel/documentation/mkdocs
_diverged/digitalmodel/documentation/pandoc
_diverged/digitalmodel/documentation/sphinx
_diverged/worldenergydata/_internal/meta/python-code-refactor
```

**Known AMBIGUOUS (two hub paths with same leaf name):**
- `pyproject-toml` — exists in both `development/devtools/` and `operations/devtools/`
- `uv-package-manager` — exists in both `development/devtools/` and `operations/devtools/`

For AMBIGUOUS: write `canonical_ref: AMBIGUOUS` and add a YAML comment listing candidates.

**`canonical_ref` is only added to `_diverged/` files — never to hub files.**

---

## Controlled Vocabulary Note

`capabilities:` is free-text during WRK-205. Do not enforce or normalize values.
Future item will define controlled vocabulary building on this populated data.
